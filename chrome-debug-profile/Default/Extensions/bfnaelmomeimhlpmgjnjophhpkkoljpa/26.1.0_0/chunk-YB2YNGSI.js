import{b as Q}from"./chunk-D42QE4ZV.js";import{D as G,S as O,T as H,X as L,qa as P}from"./chunk-Z3O2IHPJ.js";import{j as A,nd as M,wc as F}from"./chunk-FO7QPK6E.js";import{Ab as B,Bb as N,Dd as U,Jd as V,Sa as q,Zc as v,_c as K,uc as D,vc as _}from"./chunk-KUSQMIXV.js";import{$b as g,G as x,Qc as b,Tc as w,Vb as R,bd as h,hd as k,ud as I,xd as S}from"./chunk-JPCZ2XYS.js";import{a as W}from"./chunk-TVPT7M2T.js";import{a as i,g as J,i as c,n as u}from"./chunk-WKJYWAXG.js";c();u();var Z="fungible-transfer-tx",$=h({seconds:30});function de(e){let n=e?.fungibleKey,r=e?.encodedCaip19?g(e?.encodedCaip19):void 0,s=r?[r]:void 0,{fungible:o}=P({key:n,keyTokens:s,splTokenAccount:e?.splTokenAccount}),C=L(e?.sendFormValues?.recipient,o?.data.chain.id)??"",t=e?.sendSessionId??"",{chain:d,walletAddress:l}=o?.data??{},{data:m}=M({address:l,networkID:d?.id}),{data:f}=H(m),{data:p}=G({networkID:d?.id,enableFallback:!0}),a=ee(d?.id,p,f,m),E=a?.sendContextRequired?a.sendContext:void 0,T=e?.sendFormValues;return S({staleTime:$,enabled:!!o&&!!e&&!!a,queryKey:U.transferTransaction({fungibleKey:n,fungibleSendFormValues:T,sendSessionId:t,sendContext:E}),async queryFn(){if(!o||!T||!a)throw new Error("Missing required data to construct fungible transfer transaction");try{return await V(o,{...T,recipient:C},E)}catch(y){if(x(y)){let z=y.response?.status;v(y,z,Z)}}throw new Error("Failed to create transfer transaction")}})}i(de,"useTransferTransaction");function ee(e,n,r,s){if(e)return R.isBitcoinNetworkID(e)?!n||!r||!s?void 0:{sendContextRequired:!0,sendContext:{transactionSpeedsToUnitCost:n,utxoState:r,chainAddress:s}}:{sendContextRequired:!1}}i(ee,"createSendContext");c();u();var j=J(W());c();u();var X=i(()=>{let{setRetryArgs:e}=Q();return n=>{if(n instanceof N){let{successfulTxIds:r}=n,[s,o]=r;e({type:K.BRC20,commitTxId:s,revealTxId:o})}}},"useHandleRetryableTransactionError");function Me(){let e=k(),{data:n}=F({select:(0,j.useCallback)(t=>t.identifier,[])}),r=X(),s=O(),o=A();return I({mutationFn:i(async({multichainTransaction:t,pendingTransactionInput:d,senderAddress:l,gasEstimation:m})=>{if(!n)throw new Error("No account identifier found");let{networkID:f}=t,p=await q.get(f).onBeforeSend({multichainTransaction:t,gasEstimation:m}),a=await _({accountIdentifier:n,accountSigner:o,multichainTransaction:p,networkID:f,pendingTransactionInput:d,senderAddress:l,storage:e,utxoManager:s});return D(f,a)},"mutationFn"),onError(t){t instanceof Error&&(w.captureError(t,b.Fungibles),t instanceof B&&r(t))}})}i(Me,"useTransferFungible");export{de as a,Me as b};
//# sourceMappingURL=chunk-YB2YNGSI.js.map
