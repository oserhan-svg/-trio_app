import{$a as Ii,I as Er,Ib as Li,J as _i,K as ht,L as Si,Lb as Oi,Sa as Bi,Uc as Ui,Vc as Ri,Wb as To,_a as Ci,aa as Ai,fb as Ti,j as Qn,mc as Pi,o as xn,u as Io}from"./chunk-FO7QPK6E.js";import{$d as wi,Ba as Co,C as gn,Cb as wr,Eb as hi,F as bn,Hd as mi,He as tt,Id as gi,Pc as dt,Qc as Ge,Tc as We,Vb as He,_d as bi,bd as xr,be as xi,ga as Tt,ge as Ei,hd as pe,ja as at,jd as Ke,la as wn,na as xo,oa as Eo,pa as vo,qa as _o,ra as So,sa as Ao,sd as le,tc as pi,ua as Yn,uc as yi,ud as ae,w as It,wa as Bo,xd as oe,yd as me,za as br}from"./chunk-JPCZ2XYS.js";import{F as it,d as jl}from"./chunk-ZRKH4SQM.js";import{D as gr,Ja as Lt,K as di,Sb as zl,U as En,Z as vi,a as mn,j as V,s as fi,t as mr,w as wo}from"./chunk-TVPT7M2T.js";import{a as s,d as re,e as Fl,g as st,i as g,j as T,m as Buffer,n as b}from"./chunk-WKJYWAXG.js";var Ro=re((wa,Cr)=>{g();b();(function(e,t){"use strict";typeof define=="function"&&define.amd?define(t):typeof Cr=="object"&&Cr.exports?Cr.exports=t():e.log=t()})(wa,function(){"use strict";var e=s(function(){},"noop"),t="undefined",n=typeof self!==t&&typeof self.navigator!==t&&/Trident\/|MSIE /.test(self.navigator.userAgent),r=["trace","debug","info","warn","error"],o={},i=null;function a(h,w){var m=h[w];if(typeof m.bind=="function")return m.bind(h);try{return Function.prototype.bind.call(m,h)}catch{return function(){return Function.prototype.apply.apply(m,[h,arguments])}}}s(a,"bindMethod");function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}s(c,"traceForIE");function u(h){return h==="debug"&&(h="log"),typeof console===t?!1:h==="trace"&&n?c:console[h]!==void 0?a(console,h):console.log!==void 0?a(console,"log"):e}s(u,"realMethod");function l(){for(var h=this.getLevel(),w=0;w<r.length;w++){var m=r[w];this[m]=w<h?e:this.methodFactory(m,h,this.name)}if(this.log=this.debug,typeof console===t&&h<this.levels.SILENT)return"No console available for logging"}s(l,"replaceLoggingMethods");function f(h){return function(){typeof console!==t&&(l.call(this),this[h].apply(this,arguments))}}s(f,"enableLoggingWhenConsoleArrives");function p(h,w,m){return u(h)||f.apply(this,arguments)}s(p,"defaultMethodFactory");function d(h,w){var m=this,x,E,S,C="loglevel";typeof h=="string"?C+=":"+h:typeof h=="symbol"&&(C=void 0);function H(O){var R=(r[O]||"silent").toUpperCase();if(!(typeof m===t||!C)){try{m.localStorage[C]=R;return}catch{}try{m.document.cookie=encodeURIComponent(C)+"="+R+";"}catch{}}}s(H,"persistLevelIfPossible");function q(){var O;if(!(typeof m===t||!C)){try{O=m.localStorage[C]}catch{}if(typeof O===t)try{var R=m.document.cookie,D=encodeURIComponent(C),v=R.indexOf(D+"=");v!==-1&&(O=/^([^;]+)/.exec(R.slice(v+D.length+1))[1])}catch{}return m.levels[O]===void 0&&(O=void 0),O}}s(q,"getPersistedLevel");function G(){if(!(typeof m===t||!C)){try{m.localStorage.removeItem(C)}catch{}try{m.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}s(G,"clearPersistedLevel");function k(O){var R=O;if(typeof R=="string"&&m.levels[R.toUpperCase()]!==void 0&&(R=m.levels[R.toUpperCase()]),typeof R=="number"&&R>=0&&R<=m.levels.SILENT)return R;throw new TypeError("log.setLevel() called with invalid level: "+O)}s(k,"normalizeLevel"),m.name=h,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=w||p,m.getLevel=function(){return S??E??x},m.setLevel=function(O,R){return S=k(O),R!==!1&&H(S),l.call(m)},m.setDefaultLevel=function(O){E=k(O),q()||m.setLevel(O,!1)},m.resetLevel=function(){S=null,G(),l.call(m)},m.enableAll=function(O){m.setLevel(m.levels.TRACE,O)},m.disableAll=function(O){m.setLevel(m.levels.SILENT,O)},m.rebuild=function(){if(i!==m&&(x=k(i.getLevel())),l.call(m),i===m)for(var O in o)o[O].rebuild()},x=k(i?i.getLevel():"WARN");var B=q();B!=null&&(S=k(B)),l.call(m)}s(d,"Logger"),i=new d,i.getLogger=s(function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var m=o[w];return m||(m=o[w]=new d(w,i.methodFactory)),m},"getLogger");var y=typeof self!==t?self.log:void 0;return i.noConflict=function(){return typeof self!==t&&self.log===i&&(self.log=y),i},i.getLoggers=s(function(){return o},"getLoggers"),i.default=i,i})});var Je=re(te=>{"use strict";g();b();Object.defineProperty(te,"__esModule",{value:!0});te.wrapCipher=te.Hash=te.nextTick=te.isLE=void 0;te.isBytes=Yo;te.abool=ka;te.anumber=Wo;te.abytes=ct;te.ahash=Sd;te.aexists=Ad;te.aoutput=Bd;te.u8=Cd;te.u32=Id;te.clean=Td;te.createView=Va;te.bytesToHex=ja;te.hexToBytes=za;te.hexToNumber=Ga;te.bytesToNumberBE=Od;te.numberToBytesBE=Pd;te.utf8ToBytes=Wa;te.bytesToUtf8=Rd;te.toBytes=Dd;te.overlapBytes=$a;te.complexOverlapBytes=Nd;te.concatBytes=Md;te.checkOpts=Hd;te.equalBytes=Kd;te.getOutput=kd;te.setBigUint64=Zo;te.u64Lengths=Vd;te.isAligned32=Za;te.copyBytes=Ya;function Yo(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(Yo,"isBytes");function ka(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}s(ka,"abool");function Wo(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s(Wo,"anumber");function ct(e,...t){if(!Yo(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(ct,"abytes");function Sd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Wo(e.outputLen),Wo(e.blockLen)}s(Sd,"ahash");function Ad(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(Ad,"aexists");function Bd(e,t){ct(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}s(Bd,"aoutput");function Cd(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(Cd,"u8");function Id(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(Id,"u32");function Td(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(Td,"clean");function Va(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(Va,"createView");te.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Fa=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ld=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ja(e){if(ct(e),Fa)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Ld[e[n]];return t}s(ja,"bytesToHex");var Ut={_0:48,_9:57,A:65,F:70,a:97,f:102};function qa(e){if(e>=Ut._0&&e<=Ut._9)return e-Ut._0;if(e>=Ut.A&&e<=Ut.F)return e-(Ut.A-10);if(e>=Ut.a&&e<=Ut.f)return e-(Ut.a-10)}s(qa,"asciiToBase16");function za(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Fa)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){let a=qa(e.charCodeAt(i)),c=qa(e.charCodeAt(i+1));if(a===void 0||c===void 0){let u=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}r[o]=a*16+c}return r}s(za,"hexToBytes");function Ga(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":"0x"+e)}s(Ga,"hexToNumber");function Od(e){return Ga(ja(e))}s(Od,"bytesToNumberBE");function Pd(e,t){return za(e.toString(16).padStart(t*2,"0"))}s(Pd,"numberToBytesBE");var Ud=s(async()=>{},"nextTick");te.nextTick=Ud;function Wa(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(Wa,"utf8ToBytes");function Rd(e){return new TextDecoder().decode(e)}s(Rd,"bytesToUtf8");function Dd(e){if(typeof e=="string")e=Wa(e);else if(Yo(e))e=Ya(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}s(Dd,"toBytes");function $a(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}s($a,"overlapBytes");function Nd(e,t){if($a(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")}s(Nd,"complexOverlapBytes");function Md(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];ct(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let i=e[r];n.set(i,o),o+=i.length}return n}s(Md,"concatBytes");function Hd(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}s(Hd,"checkOpts");function Kd(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}s(Kd,"equalBytes");var $o=class{static{s(this,"Hash")}};te.Hash=$o;var qd=s((e,t)=>{function n(r,...o){if(ct(r),!te.isLE)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let f=o[0];if(!f)throw new Error("nonce / iv required");e.varSizeNonce?ct(f):ct(f,e.nonceLength)}let i=e.tagLength;i&&o[1]!==void 0&&ct(o[1]);let a=t(r,...o),c=s((f,p)=>{if(p!==void 0){if(f!==2)throw new Error("cipher output not supported");ct(p)}},"checkOutput"),u=!1;return{encrypt(f,p){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,ct(f),c(a.encrypt.length,p),a.encrypt(f,p)},decrypt(f,p){if(ct(f),i&&f.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return c(a.decrypt.length,p),a.decrypt(f,p)}}}return s(n,"wrappedCipher"),Object.assign(n,e),n},"wrapCipher");te.wrapCipher=qd;function kd(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Za(t))throw new Error("invalid output, must be aligned");return t}s(kd,"getOutput");function Zo(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),i=BigInt(4294967295),a=Number(n>>o&i),c=Number(n&i),u=r?4:0,l=r?0:4;e.setUint32(t+u,a,r),e.setUint32(t+l,c,r)}s(Zo,"setBigUint64");function Vd(e,t,n){ka(n);let r=new Uint8Array(16),o=Va(r);return Zo(o,0,BigInt(t),n),Zo(o,8,BigInt(e),n),r}s(Vd,"u64Lengths");function Za(e){return e.byteOffset%4===0}s(Za,"isAligned32");function Ya(e){return Uint8Array.from(e)}s(Ya,"copyBytes")});var Or=re(De=>{"use strict";g();b();Object.defineProperty(De,"__esModule",{value:!0});De.AEAD_TAG_LENGTH=De.XCHACHA20_NONCE_LENGTH=De.CURVE25519_PUBLIC_KEY_SIZE=De.ETH_PUBLIC_KEY_SIZE=De.UNCOMPRESSED_PUBLIC_KEY_SIZE=De.COMPRESSED_PUBLIC_KEY_SIZE=De.SECRET_KEY_LENGTH=void 0;De.SECRET_KEY_LENGTH=32;De.COMPRESSED_PUBLIC_KEY_SIZE=33;De.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;De.ETH_PUBLIC_KEY_SIZE=64;De.CURVE25519_PUBLIC_KEY_SIZE=32;De.XCHACHA20_NONCE_LENGTH=24;De.AEAD_TAG_LENGTH=16});var er=re(we=>{"use strict";g();b();Object.defineProperty(we,"__esModule",{value:!0});we.ephemeralKeySize=we.symmetricNonceLength=we.symmetricAlgorithm=we.isHkdfKeyCompressed=we.isEphemeralKeyCompressed=we.ellipticCurve=we.ECIES_CONFIG=void 0;var Pr=Or(),Fd=function(){function e(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return s(e,"Config"),e}();we.ECIES_CONFIG=new Fd;var jd=s(function(){return we.ECIES_CONFIG.ellipticCurve},"ellipticCurve");we.ellipticCurve=jd;var zd=s(function(){return we.ECIES_CONFIG.isEphemeralKeyCompressed},"isEphemeralKeyCompressed");we.isEphemeralKeyCompressed=zd;var Gd=s(function(){return we.ECIES_CONFIG.isHkdfKeyCompressed},"isHkdfKeyCompressed");we.isHkdfKeyCompressed=Gd;var Wd=s(function(){return we.ECIES_CONFIG.symmetricAlgorithm},"symmetricAlgorithm");we.symmetricAlgorithm=Wd;var $d=s(function(){return we.ECIES_CONFIG.symmetricNonceLength},"symmetricNonceLength");we.symmetricNonceLength=$d;var Zd=s(function(){var e={secp256k1:we.ECIES_CONFIG.isEphemeralKeyCompressed?Pr.COMPRESSED_PUBLIC_KEY_SIZE:Pr.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:Pr.CURVE25519_PUBLIC_KEY_SIZE,ed25519:Pr.CURVE25519_PUBLIC_KEY_SIZE};if(we.ECIES_CONFIG.ellipticCurve in e)return e[we.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")},"ephemeralKeySize");we.ephemeralKeySize=Zd});var Qa=re(Ur=>{"use strict";g();b();Object.defineProperty(Ur,"__esModule",{value:!0});Ur.crypto=void 0;Ur.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Jo=re(qe=>{"use strict";g();b();Object.defineProperty(qe,"__esModule",{value:!0});qe.gcm=qe.ctr=qe.cbc=qe.utils=void 0;qe.randomBytes=Xa;qe.getWebcryptoSubtle=Qo;qe.managedNonce=Yd;var yt=Qa(),In=Je();function Xa(e=32){if(yt.crypto&&typeof yt.crypto.getRandomValues=="function")return yt.crypto.getRandomValues(new Uint8Array(e));if(yt.crypto&&typeof yt.crypto.randomBytes=="function")return Uint8Array.from(yt.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(Xa,"randomBytes");function Qo(){if(yt.crypto&&typeof yt.crypto.subtle=="object"&&yt.crypto.subtle!=null)return yt.crypto.subtle;throw new Error("crypto.subtle must be defined")}s(Qo,"getWebcryptoSubtle");function Yd(e){let{nonceLength:t}=e;return(0,In.anumber)(t),(n,...r)=>({encrypt(o,...i){let a=Xa(t),c=e(n,a,...r).encrypt(o,...i),u=(0,In.concatBytes)(a,c);return c.fill(0),u},decrypt(o,...i){let a=o.subarray(0,t),c=o.subarray(t);return e(n,a,...r).decrypt(c,...i)}})}s(Yd,"managedNonce");qe.utils={async encrypt(e,t,n,r){let o=Qo(),i=await o.importKey("raw",e,t,!0,["encrypt"]),a=await o.encrypt(n,i,r);return new Uint8Array(a)},async decrypt(e,t,n,r){let o=Qo(),i=await o.importKey("raw",e,t,!0,["decrypt"]),a=await o.decrypt(n,i,r);return new Uint8Array(a)}};var pt={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function Qd(e,t,n){if(e===pt.CBC)return{name:pt.CBC,iv:t};if(e===pt.CTR)return{name:pt.CTR,counter:t,length:64};if(e===pt.GCM)return n?{name:pt.GCM,iv:t,additionalData:n}:{name:pt.GCM,iv:t};throw new Error("unknown aes block mode")}s(Qd,"getCryptParams");function Xo(e){return(t,n,r)=>{(0,In.abytes)(t),(0,In.abytes)(n);let o={name:e,length:t.length*8},i=Qd(e,n,r),a=!1;return{encrypt(c){if((0,In.abytes)(c),a)throw new Error("Cannot encrypt() twice with same key / nonce");return a=!0,qe.utils.encrypt(t,o,i,c)},decrypt(c){return(0,In.abytes)(c),qe.utils.decrypt(t,o,i,c)}}}}s(Xo,"generate");qe.cbc=Xo(pt.CBC);qe.ctr=Xo(pt.CTR);qe.gcm=Xo(pt.GCM)});var Ja=re(Rr=>{"use strict";g();b();Object.defineProperty(Rr,"__esModule",{value:!0});Rr.crypto=void 0;Rr.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var mt=re(Z=>{"use strict";g();b();Object.defineProperty(Z,"__esModule",{value:!0});Z.wrapXOFConstructorWithOpts=Z.wrapConstructorWithOpts=Z.wrapConstructor=Z.Hash=Z.nextTick=Z.swap32IfBE=Z.byteSwapIfBE=Z.swap8IfBE=Z.isLE=void 0;Z.isBytes=tc;Z.anumber=es;Z.abytes=Ln;Z.ahash=Xd;Z.aexists=Jd;Z.aoutput=e0;Z.u8=t0;Z.u32=n0;Z.clean=r0;Z.createView=o0;Z.rotr=s0;Z.rotl=i0;Z.byteSwap=ns;Z.byteSwap32=nc;Z.bytesToHex=c0;Z.hexToBytes=u0;Z.asyncLoop=f0;Z.utf8ToBytes=rs;Z.bytesToUtf8=d0;Z.toBytes=Dr;Z.kdfInputToBytes=h0;Z.concatBytes=p0;Z.checkOpts=y0;Z.createHasher=oc;Z.createOptHasher=sc;Z.createXOFer=ic;Z.randomBytes=m0;var Tn=Ja();function tc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(tc,"isBytes");function es(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s(es,"anumber");function Ln(e,...t){if(!tc(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(Ln,"abytes");function Xd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");es(e.outputLen),es(e.blockLen)}s(Xd,"ahash");function Jd(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(Jd,"aexists");function e0(e,t){Ln(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}s(e0,"aoutput");function t0(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(t0,"u8");function n0(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(n0,"u32");function r0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(r0,"clean");function o0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(o0,"createView");function s0(e,t){return e<<32-t|e>>>t}s(s0,"rotr");function i0(e,t){return e<<t|e>>>32-t>>>0}s(i0,"rotl");Z.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ns(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}s(ns,"byteSwap");Z.swap8IfBE=Z.isLE?e=>e:e=>ns(e);Z.byteSwapIfBE=Z.swap8IfBE;function nc(e){for(let t=0;t<e.length;t++)e[t]=ns(e[t]);return e}s(nc,"byteSwap32");Z.swap32IfBE=Z.isLE?e=>e:nc;var rc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",a0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function c0(e){if(Ln(e),rc)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=a0[e[n]];return t}s(c0,"bytesToHex");var Rt={_0:48,_9:57,A:65,F:70,a:97,f:102};function ec(e){if(e>=Rt._0&&e<=Rt._9)return e-Rt._0;if(e>=Rt.A&&e<=Rt.F)return e-(Rt.A-10);if(e>=Rt.a&&e<=Rt.f)return e-(Rt.a-10)}s(ec,"asciiToBase16");function u0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(rc)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){let a=ec(e.charCodeAt(i)),c=ec(e.charCodeAt(i+1));if(a===void 0||c===void 0){let u=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}r[o]=a*16+c}return r}s(u0,"hexToBytes");var l0=s(async()=>{},"nextTick");Z.nextTick=l0;async function f0(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let i=Date.now()-r;i>=0&&i<t||(await(0,Z.nextTick)(),r+=i)}}s(f0,"asyncLoop");function rs(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(rs,"utf8ToBytes");function d0(e){return new TextDecoder().decode(e)}s(d0,"bytesToUtf8");function Dr(e){return typeof e=="string"&&(e=rs(e)),Ln(e),e}s(Dr,"toBytes");function h0(e){return typeof e=="string"&&(e=rs(e)),Ln(e),e}s(h0,"kdfInputToBytes");function p0(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Ln(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let i=e[r];n.set(i,o),o+=i.length}return n}s(p0,"concatBytes");function y0(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}s(y0,"checkOpts");var ts=class{static{s(this,"Hash")}};Z.Hash=ts;function oc(e){let t=s(r=>e().update(Dr(r)).digest(),"hashC"),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}s(oc,"createHasher");function sc(e){let t=s((r,o)=>e(o).update(Dr(r)).digest(),"hashC"),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(sc,"createOptHasher");function ic(e){let t=s((r,o)=>e(o).update(Dr(r)).digest(),"hashC"),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(ic,"createXOFer");Z.wrapConstructor=oc;Z.wrapConstructorWithOpts=sc;Z.wrapXOFConstructorWithOpts=ic;function m0(e=32){if(Tn.crypto&&typeof Tn.crypto.getRandomValues=="function")return Tn.crypto.getRandomValues(new Uint8Array(e));if(Tn.crypto&&typeof Tn.crypto.randomBytes=="function")return Uint8Array.from(Tn.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(m0,"randomBytes")});var cc=re(ke=>{"use strict";g();b();Object.defineProperty(ke,"__esModule",{value:!0});ke.SHA512_IV=ke.SHA384_IV=ke.SHA224_IV=ke.SHA256_IV=ke.HashMD=void 0;ke.setBigUint64=ac;ke.Chi=g0;ke.Maj=b0;var gt=mt();function ac(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),i=BigInt(4294967295),a=Number(n>>o&i),c=Number(n&i),u=r?4:0,l=r?0:4;e.setUint32(t+u,a,r),e.setUint32(t+l,c,r)}s(ac,"setBigUint64");function g0(e,t,n){return e&t^~e&n}s(g0,"Chi");function b0(e,t,n){return e&t^e&n^t&n}s(b0,"Maj");var os=class extends gt.Hash{static{s(this,"HashMD")}constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,gt.createView)(this.buffer)}update(t){(0,gt.aexists)(this),t=(0,gt.toBytes)(t),(0,gt.abytes)(t);let{view:n,buffer:r,blockLen:o}=this,i=t.length;for(let a=0;a<i;){let c=Math.min(o-this.pos,i-a);if(c===o){let u=(0,gt.createView)(t);for(;o<=i-a;a+=o)this.process(u,a);continue}r.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,gt.aexists)(this),(0,gt.aoutput)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:i}=this,{pos:a}=this;n[a++]=128,(0,gt.clean)(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(r,0),a=0);for(let p=a;p<o;p++)n[p]=0;ac(r,o-8,BigInt(this.length*8),i),this.process(r,0);let c=(0,gt.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)c.setUint32(4*p,f[p],i)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:i,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=i,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};ke.HashMD=os;ke.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);ke.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);ke.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);ke.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var Lc=re(X=>{"use strict";g();b();Object.defineProperty(X,"__esModule",{value:!0});X.toBig=X.shrSL=X.shrSH=X.rotrSL=X.rotrSH=X.rotrBL=X.rotrBH=X.rotr32L=X.rotr32H=X.rotlSL=X.rotlSH=X.rotlBL=X.rotlBH=X.add5L=X.add5H=X.add4L=X.add4H=X.add3L=X.add3H=void 0;X.add=_c;X.fromBig=is;X.split=uc;var Nr=BigInt(2**32-1),ss=BigInt(32);function is(e,t=!1){return t?{h:Number(e&Nr),l:Number(e>>ss&Nr)}:{h:Number(e>>ss&Nr)|0,l:Number(e&Nr)|0}}s(is,"fromBig");function uc(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let i=0;i<n;i++){let{h:a,l:c}=is(e[i],t);[r[i],o[i]]=[a,c]}return[r,o]}s(uc,"split");var lc=s((e,t)=>BigInt(e>>>0)<<ss|BigInt(t>>>0),"toBig");X.toBig=lc;var fc=s((e,t,n)=>e>>>n,"shrSH");X.shrSH=fc;var dc=s((e,t,n)=>e<<32-n|t>>>n,"shrSL");X.shrSL=dc;var hc=s((e,t,n)=>e>>>n|t<<32-n,"rotrSH");X.rotrSH=hc;var pc=s((e,t,n)=>e<<32-n|t>>>n,"rotrSL");X.rotrSL=pc;var yc=s((e,t,n)=>e<<64-n|t>>>n-32,"rotrBH");X.rotrBH=yc;var mc=s((e,t,n)=>e>>>n-32|t<<64-n,"rotrBL");X.rotrBL=mc;var gc=s((e,t)=>t,"rotr32H");X.rotr32H=gc;var bc=s((e,t)=>e,"rotr32L");X.rotr32L=bc;var wc=s((e,t,n)=>e<<n|t>>>32-n,"rotlSH");X.rotlSH=wc;var xc=s((e,t,n)=>t<<n|e>>>32-n,"rotlSL");X.rotlSL=xc;var Ec=s((e,t,n)=>t<<n-32|e>>>64-n,"rotlBH");X.rotlBH=Ec;var vc=s((e,t,n)=>e<<n-32|t>>>64-n,"rotlBL");X.rotlBL=vc;function _c(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}s(_c,"add");var Sc=s((e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),"add3L");X.add3L=Sc;var Ac=s((e,t,n,r)=>t+n+r+(e/2**32|0)|0,"add3H");X.add3H=Ac;var Bc=s((e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),"add4L");X.add4L=Bc;var Cc=s((e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,"add4H");X.add4H=Cc;var Ic=s((e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),"add5L");X.add5L=Ic;var Tc=s((e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,"add5H");X.add5H=Tc;var w0={fromBig:is,split:uc,toBig:lc,shrSH:fc,shrSL:dc,rotrSH:hc,rotrSL:pc,rotrBH:yc,rotrBL:mc,rotr32H:gc,rotr32L:bc,rotlSH:wc,rotlSL:xc,rotlBH:Ec,rotlBL:vc,add:_c,add3L:Sc,add3H:Ac,add4L:Bc,add4H:Cc,add5H:Tc,add5L:Ic};X.default=w0});var kr=re(ye=>{"use strict";g();b();Object.defineProperty(ye,"__esModule",{value:!0});ye.sha512_224=ye.sha512_256=ye.sha384=ye.sha512=ye.sha224=ye.sha256=ye.SHA512_256=ye.SHA512_224=ye.SHA384=ye.SHA512=ye.SHA224=ye.SHA256=void 0;var $=cc(),ne=Lc(),Be=mt(),x0=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$t=new Uint32Array(64),tr=class extends $.HashMD{static{s(this,"SHA256")}constructor(t=32){super(64,t,8,!1),this.A=$.SHA256_IV[0]|0,this.B=$.SHA256_IV[1]|0,this.C=$.SHA256_IV[2]|0,this.D=$.SHA256_IV[3]|0,this.E=$.SHA256_IV[4]|0,this.F=$.SHA256_IV[5]|0,this.G=$.SHA256_IV[6]|0,this.H=$.SHA256_IV[7]|0}get(){let{A:t,B:n,C:r,D:o,E:i,F:a,G:c,H:u}=this;return[t,n,r,o,i,a,c,u]}set(t,n,r,o,i,a,c,u){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=c|0,this.H=u|0}process(t,n){for(let p=0;p<16;p++,n+=4)$t[p]=t.getUint32(n,!1);for(let p=16;p<64;p++){let d=$t[p-15],y=$t[p-2],h=(0,Be.rotr)(d,7)^(0,Be.rotr)(d,18)^d>>>3,w=(0,Be.rotr)(y,17)^(0,Be.rotr)(y,19)^y>>>10;$t[p]=w+$t[p-7]+h+$t[p-16]|0}let{A:r,B:o,C:i,D:a,E:c,F:u,G:l,H:f}=this;for(let p=0;p<64;p++){let d=(0,Be.rotr)(c,6)^(0,Be.rotr)(c,11)^(0,Be.rotr)(c,25),y=f+d+(0,$.Chi)(c,u,l)+x0[p]+$t[p]|0,w=((0,Be.rotr)(r,2)^(0,Be.rotr)(r,13)^(0,Be.rotr)(r,22))+(0,$.Maj)(r,o,i)|0;f=l,l=u,u=c,c=a+y|0,a=i,i=o,o=r,r=y+w|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,c=c+this.E|0,u=u+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,o,i,a,c,u,l,f)}roundClean(){(0,Be.clean)($t)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,Be.clean)(this.buffer)}};ye.SHA256=tr;var Mr=class extends tr{static{s(this,"SHA224")}constructor(){super(28),this.A=$.SHA224_IV[0]|0,this.B=$.SHA224_IV[1]|0,this.C=$.SHA224_IV[2]|0,this.D=$.SHA224_IV[3]|0,this.E=$.SHA224_IV[4]|0,this.F=$.SHA224_IV[5]|0,this.G=$.SHA224_IV[6]|0,this.H=$.SHA224_IV[7]|0}};ye.SHA224=Mr;var Oc=ne.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),E0=Oc[0],v0=Oc[1],Zt=new Uint32Array(80),Yt=new Uint32Array(80),nn=class extends $.HashMD{static{s(this,"SHA512")}constructor(t=64){super(128,t,16,!1),this.Ah=$.SHA512_IV[0]|0,this.Al=$.SHA512_IV[1]|0,this.Bh=$.SHA512_IV[2]|0,this.Bl=$.SHA512_IV[3]|0,this.Ch=$.SHA512_IV[4]|0,this.Cl=$.SHA512_IV[5]|0,this.Dh=$.SHA512_IV[6]|0,this.Dl=$.SHA512_IV[7]|0,this.Eh=$.SHA512_IV[8]|0,this.El=$.SHA512_IV[9]|0,this.Fh=$.SHA512_IV[10]|0,this.Fl=$.SHA512_IV[11]|0,this.Gh=$.SHA512_IV[12]|0,this.Gl=$.SHA512_IV[13]|0,this.Hh=$.SHA512_IV[14]|0,this.Hl=$.SHA512_IV[15]|0}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:i,Cl:a,Dh:c,Dl:u,Eh:l,El:f,Fh:p,Fl:d,Gh:y,Gl:h,Hh:w,Hl:m}=this;return[t,n,r,o,i,a,c,u,l,f,p,d,y,h,w,m]}set(t,n,r,o,i,a,c,u,l,f,p,d,y,h,w,m){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=i|0,this.Cl=a|0,this.Dh=c|0,this.Dl=u|0,this.Eh=l|0,this.El=f|0,this.Fh=p|0,this.Fl=d|0,this.Gh=y|0,this.Gl=h|0,this.Hh=w|0,this.Hl=m|0}process(t,n){for(let S=0;S<16;S++,n+=4)Zt[S]=t.getUint32(n),Yt[S]=t.getUint32(n+=4);for(let S=16;S<80;S++){let C=Zt[S-15]|0,H=Yt[S-15]|0,q=ne.rotrSH(C,H,1)^ne.rotrSH(C,H,8)^ne.shrSH(C,H,7),G=ne.rotrSL(C,H,1)^ne.rotrSL(C,H,8)^ne.shrSL(C,H,7),k=Zt[S-2]|0,B=Yt[S-2]|0,O=ne.rotrSH(k,B,19)^ne.rotrBH(k,B,61)^ne.shrSH(k,B,6),R=ne.rotrSL(k,B,19)^ne.rotrBL(k,B,61)^ne.shrSL(k,B,6),D=ne.add4L(G,R,Yt[S-7],Yt[S-16]),v=ne.add4H(D,q,O,Zt[S-7],Zt[S-16]);Zt[S]=v|0,Yt[S]=D|0}let{Ah:r,Al:o,Bh:i,Bl:a,Ch:c,Cl:u,Dh:l,Dl:f,Eh:p,El:d,Fh:y,Fl:h,Gh:w,Gl:m,Hh:x,Hl:E}=this;for(let S=0;S<80;S++){let C=ne.rotrSH(p,d,14)^ne.rotrSH(p,d,18)^ne.rotrBH(p,d,41),H=ne.rotrSL(p,d,14)^ne.rotrSL(p,d,18)^ne.rotrBL(p,d,41),q=p&y^~p&w,G=d&h^~d&m,k=ne.add5L(E,H,G,v0[S],Yt[S]),B=ne.add5H(k,x,C,q,E0[S],Zt[S]),O=k|0,R=ne.rotrSH(r,o,28)^ne.rotrBH(r,o,34)^ne.rotrBH(r,o,39),D=ne.rotrSL(r,o,28)^ne.rotrBL(r,o,34)^ne.rotrBL(r,o,39),v=r&i^r&c^i&c,_=o&a^o&u^a&u;x=w|0,E=m|0,w=y|0,m=h|0,y=p|0,h=d|0,{h:p,l:d}=ne.add(l|0,f|0,B|0,O|0),l=c|0,f=u|0,c=i|0,u=a|0,i=r|0,a=o|0;let A=ne.add3L(O,D,_);r=ne.add3H(A,B,R,v),o=A|0}({h:r,l:o}=ne.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:i,l:a}=ne.add(this.Bh|0,this.Bl|0,i|0,a|0),{h:c,l:u}=ne.add(this.Ch|0,this.Cl|0,c|0,u|0),{h:l,l:f}=ne.add(this.Dh|0,this.Dl|0,l|0,f|0),{h:p,l:d}=ne.add(this.Eh|0,this.El|0,p|0,d|0),{h:y,l:h}=ne.add(this.Fh|0,this.Fl|0,y|0,h|0),{h:w,l:m}=ne.add(this.Gh|0,this.Gl|0,w|0,m|0),{h:x,l:E}=ne.add(this.Hh|0,this.Hl|0,x|0,E|0),this.set(r,o,i,a,c,u,l,f,p,d,y,h,w,m,x,E)}roundClean(){(0,Be.clean)(Zt,Yt)}destroy(){(0,Be.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ye.SHA512=nn;var Hr=class extends nn{static{s(this,"SHA384")}constructor(){super(48),this.Ah=$.SHA384_IV[0]|0,this.Al=$.SHA384_IV[1]|0,this.Bh=$.SHA384_IV[2]|0,this.Bl=$.SHA384_IV[3]|0,this.Ch=$.SHA384_IV[4]|0,this.Cl=$.SHA384_IV[5]|0,this.Dh=$.SHA384_IV[6]|0,this.Dl=$.SHA384_IV[7]|0,this.Eh=$.SHA384_IV[8]|0,this.El=$.SHA384_IV[9]|0,this.Fh=$.SHA384_IV[10]|0,this.Fl=$.SHA384_IV[11]|0,this.Gh=$.SHA384_IV[12]|0,this.Gl=$.SHA384_IV[13]|0,this.Hh=$.SHA384_IV[14]|0,this.Hl=$.SHA384_IV[15]|0}};ye.SHA384=Hr;var Ne=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Me=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Kr=class extends nn{static{s(this,"SHA512_224")}constructor(){super(28),this.Ah=Ne[0]|0,this.Al=Ne[1]|0,this.Bh=Ne[2]|0,this.Bl=Ne[3]|0,this.Ch=Ne[4]|0,this.Cl=Ne[5]|0,this.Dh=Ne[6]|0,this.Dl=Ne[7]|0,this.Eh=Ne[8]|0,this.El=Ne[9]|0,this.Fh=Ne[10]|0,this.Fl=Ne[11]|0,this.Gh=Ne[12]|0,this.Gl=Ne[13]|0,this.Hh=Ne[14]|0,this.Hl=Ne[15]|0}};ye.SHA512_224=Kr;var qr=class extends nn{static{s(this,"SHA512_256")}constructor(){super(32),this.Ah=Me[0]|0,this.Al=Me[1]|0,this.Bh=Me[2]|0,this.Bl=Me[3]|0,this.Ch=Me[4]|0,this.Cl=Me[5]|0,this.Dh=Me[6]|0,this.Dl=Me[7]|0,this.Eh=Me[8]|0,this.El=Me[9]|0,this.Fh=Me[10]|0,this.Fl=Me[11]|0,this.Gh=Me[12]|0,this.Gl=Me[13]|0,this.Hh=Me[14]|0,this.Hl=Me[15]|0}};ye.SHA512_256=qr;ye.sha256=(0,Be.createHasher)(()=>new tr);ye.sha224=(0,Be.createHasher)(()=>new Mr);ye.sha512=(0,Be.createHasher)(()=>new nn);ye.sha384=(0,Be.createHasher)(()=>new Hr);ye.sha512_256=(0,Be.createHasher)(()=>new qr);ye.sha512_224=(0,Be.createHasher)(()=>new Kr)});var Nt=re(Y=>{"use strict";g();b();Object.defineProperty(Y,"__esModule",{value:!0});Y.notImplemented=Y.bitMask=Y.utf8ToBytes=Y.randomBytes=Y.isBytes=Y.hexToBytes=Y.concatBytes=Y.bytesToUtf8=Y.bytesToHex=Y.anumber=Y.abytes=void 0;Y.abool=_0;Y._abool2=S0;Y._abytes2=A0;Y.numberToHexUnpadded=Pc;Y.hexToNumber=cs;Y.bytesToNumberBE=B0;Y.bytesToNumberLE=C0;Y.numberToBytesBE=Uc;Y.numberToBytesLE=I0;Y.numberToVarBytesBE=T0;Y.ensureBytes=L0;Y.equalBytes=O0;Y.copyBytes=P0;Y.asciiToBytes=U0;Y.inRange=Rc;Y.aInRange=R0;Y.bitLen=D0;Y.bitGet=N0;Y.bitSet=M0;Y.createHmacDrbg=K0;Y.validateObject=k0;Y.isHash=V0;Y._validateObject=F0;Y.memoized=z0;var bt=mt(),Dt=mt();Object.defineProperty(Y,"abytes",{enumerable:!0,get:s(function(){return Dt.abytes},"get")});Object.defineProperty(Y,"anumber",{enumerable:!0,get:s(function(){return Dt.anumber},"get")});Object.defineProperty(Y,"bytesToHex",{enumerable:!0,get:s(function(){return Dt.bytesToHex},"get")});Object.defineProperty(Y,"bytesToUtf8",{enumerable:!0,get:s(function(){return Dt.bytesToUtf8},"get")});Object.defineProperty(Y,"concatBytes",{enumerable:!0,get:s(function(){return Dt.concatBytes},"get")});Object.defineProperty(Y,"hexToBytes",{enumerable:!0,get:s(function(){return Dt.hexToBytes},"get")});Object.defineProperty(Y,"isBytes",{enumerable:!0,get:s(function(){return Dt.isBytes},"get")});Object.defineProperty(Y,"randomBytes",{enumerable:!0,get:s(function(){return Dt.randomBytes},"get")});Object.defineProperty(Y,"utf8ToBytes",{enumerable:!0,get:s(function(){return Dt.utf8ToBytes},"get")});var Vr=BigInt(0),nr=BigInt(1);function _0(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}s(_0,"abool");function S0(e,t=""){if(typeof e!="boolean"){let n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}s(S0,"_abool2");function A0(e,t,n=""){let r=(0,bt.isBytes)(e),o=e?.length,i=t!==void 0;if(!r||i&&o!==t){let a=n&&`"${n}" `,c=i?` of length ${t}`:"",u=r?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+c+", got "+u)}return e}s(A0,"_abytes2");function Pc(e){let t=e.toString(16);return t.length&1?"0"+t:t}s(Pc,"numberToHexUnpadded");function cs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Vr:BigInt("0x"+e)}s(cs,"hexToNumber");function B0(e){return cs((0,bt.bytesToHex)(e))}s(B0,"bytesToNumberBE");function C0(e){return(0,bt.abytes)(e),cs((0,bt.bytesToHex)(Uint8Array.from(e).reverse()))}s(C0,"bytesToNumberLE");function Uc(e,t){return(0,bt.hexToBytes)(e.toString(16).padStart(t*2,"0"))}s(Uc,"numberToBytesBE");function I0(e,t){return Uc(e,t).reverse()}s(I0,"numberToBytesLE");function T0(e){return(0,bt.hexToBytes)(Pc(e))}s(T0,"numberToVarBytesBE");function L0(e,t,n){let r;if(typeof t=="string")try{r=(0,bt.hexToBytes)(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if((0,bt.isBytes)(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return r}s(L0,"ensureBytes");function O0(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}s(O0,"equalBytes");function P0(e){return Uint8Array.from(e)}s(P0,"copyBytes");function U0(e){return Uint8Array.from(e,(t,n)=>{let r=t.charCodeAt(0);if(t.length!==1||r>127)throw new Error(`string contains non-ASCII character "${e[n]}" with code ${r} at position ${n}`);return r})}s(U0,"asciiToBytes");var as=s(e=>typeof e=="bigint"&&Vr<=e,"isPosBig");function Rc(e,t,n){return as(e)&&as(t)&&as(n)&&t<=e&&e<n}s(Rc,"inRange");function R0(e,t,n,r){if(!Rc(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}s(R0,"aInRange");function D0(e){let t;for(t=0;e>Vr;e>>=nr,t+=1);return t}s(D0,"bitLen");function N0(e,t){return e>>BigInt(t)&nr}s(N0,"bitGet");function M0(e,t,n){return e|(n?nr:Vr)<<BigInt(t)}s(M0,"bitSet");var H0=s(e=>(nr<<BigInt(e))-nr,"bitMask");Y.bitMask=H0;function K0(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=s(y=>new Uint8Array(y),"u8n"),o=s(y=>Uint8Array.of(y),"u8of"),i=r(e),a=r(e),c=0,u=s(()=>{i.fill(1),a.fill(0),c=0},"reset"),l=s((...y)=>n(a,i,...y),"h"),f=s((y=r(0))=>{a=l(o(0),y),i=l(),y.length!==0&&(a=l(o(1),y),i=l())},"reseed"),p=s(()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let y=0,h=[];for(;y<t;){i=l();let w=i.slice();h.push(w),y+=i.length}return(0,bt.concatBytes)(...h)},"gen");return s((y,h)=>{u(),f(y);let w;for(;!(w=h(p()));)f();return u(),w},"genUntil")}s(K0,"createHmacDrbg");var q0={bigint:s(e=>typeof e=="bigint","bigint"),function:s(e=>typeof e=="function","function"),boolean:s(e=>typeof e=="boolean","boolean"),string:s(e=>typeof e=="string","string"),stringOrUint8Array:s(e=>typeof e=="string"||(0,bt.isBytes)(e),"stringOrUint8Array"),isSafeInteger:s(e=>Number.isSafeInteger(e),"isSafeInteger"),array:s(e=>Array.isArray(e),"array"),field:s((e,t)=>t.Fp.isValid(e),"field"),hash:s(e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen),"hash")};function k0(e,t,n={}){let r=s((o,i,a)=>{let c=q0[i];if(typeof c!="function")throw new Error("invalid validator function");let u=e[o];if(!(a&&u===void 0)&&!c(u,e))throw new Error("param "+String(o)+" is invalid. Expected "+i+", got "+u)},"checkField");for(let[o,i]of Object.entries(t))r(o,i,!1);for(let[o,i]of Object.entries(n))r(o,i,!0);return e}s(k0,"validateObject");function V0(e){return typeof e=="function"&&Number.isSafeInteger(e.outputLen)}s(V0,"isHash");function F0(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(o,i,a){let c=e[o];if(a&&c===void 0)return;let u=typeof c;if(u!==i||c===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${u}`)}s(r,"checkField"),Object.entries(t).forEach(([o,i])=>r(o,i,!1)),Object.entries(n).forEach(([o,i])=>r(o,i,!0))}s(F0,"_validateObject");var j0=s(()=>{throw new Error("not implemented")},"notImplemented");Y.notImplemented=j0;function z0(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let i=e(n,...r);return t.set(n,i),i}}s(z0,"memoized")});var Qt=re(xe=>{"use strict";g();b();Object.defineProperty(xe,"__esModule",{value:!0});xe.isNegativeLE=void 0;xe.mod=Ye;xe.pow=$0;xe.pow2=Z0;xe.invert=Fr;xe.tonelliShanks=ls;xe.FpSqrt=kc;xe.validateField=eh;xe.FpPow=fs;xe.FpInvertBatch=Vc;xe.FpDiv=th;xe.FpLegendre=jr;xe.FpIsSquare=nh;xe.nLength=ds;xe.Field=zr;xe.FpSqrtOdd=rh;xe.FpSqrtEven=oh;xe.hashToPrivateScalar=sh;xe.getFieldBytesLength=hs;xe.getMinHashLength=Fc;xe.mapHashToField=ih;var Qe=Nt(),Ve=BigInt(0),Ce=BigInt(1),rn=BigInt(2),Dc=BigInt(3),Nc=BigInt(4),Mc=BigInt(5),G0=BigInt(7),Hc=BigInt(8),W0=BigInt(9),Kc=BigInt(16);function Ye(e,t){let n=e%t;return n>=Ve?n:t+n}s(Ye,"mod");function $0(e,t,n){return fs(zr(n),e,t)}s($0,"pow");function Z0(e,t,n){let r=e;for(;t-- >Ve;)r*=r,r%=n;return r}s(Z0,"pow2");function Fr(e,t){if(e===Ve)throw new Error("invert: expected non-zero number");if(t<=Ve)throw new Error("invert: expected positive modulus, got "+t);let n=Ye(e,t),r=t,o=Ve,i=Ce,a=Ce,c=Ve;for(;n!==Ve;){let l=r/n,f=r%n,p=o-a*l,d=i-c*l;r=n,n=f,o=a,i=c,a=p,c=d}if(r!==Ce)throw new Error("invert: does not exist");return Ye(o,t)}s(Fr,"invert");function us(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}s(us,"assertIsSquare");function qc(e,t){let n=(e.ORDER+Ce)/Nc,r=e.pow(t,n);return us(e,r,t),r}s(qc,"sqrt3mod4");function Y0(e,t){let n=(e.ORDER-Mc)/Hc,r=e.mul(t,rn),o=e.pow(r,n),i=e.mul(t,o),a=e.mul(e.mul(i,rn),o),c=e.mul(i,e.sub(a,e.ONE));return us(e,c,t),c}s(Y0,"sqrt5mod8");function Q0(e){let t=zr(e),n=ls(e),r=n(t,t.neg(t.ONE)),o=n(t,r),i=n(t,t.neg(r)),a=(e+G0)/Kc;return(c,u)=>{let l=c.pow(u,a),f=c.mul(l,r),p=c.mul(l,o),d=c.mul(l,i),y=c.eql(c.sqr(f),u),h=c.eql(c.sqr(p),u);l=c.cmov(l,f,y),f=c.cmov(d,p,h);let w=c.eql(c.sqr(f),u),m=c.cmov(l,f,w);return us(c,m,u),m}}s(Q0,"sqrt9mod16");function ls(e){if(e<Dc)throw new Error("sqrt is not defined for small field");let t=e-Ce,n=0;for(;t%rn===Ve;)t/=rn,n++;let r=rn,o=zr(e);for(;jr(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return qc;let i=o.pow(r,t),a=(t+Ce)/rn;return s(function(u,l){if(u.is0(l))return l;if(jr(u,l)!==1)throw new Error("Cannot find square root");let f=n,p=u.mul(u.ONE,i),d=u.pow(l,t),y=u.pow(l,a);for(;!u.eql(d,u.ONE);){if(u.is0(d))return u.ZERO;let h=1,w=u.sqr(d);for(;!u.eql(w,u.ONE);)if(h++,w=u.sqr(w),h===f)throw new Error("Cannot find square root");let m=Ce<<BigInt(f-h-1),x=u.pow(p,m);f=h,p=u.sqr(x),d=u.mul(d,p),y=u.mul(y,x)}return y},"tonelliSlow")}s(ls,"tonelliShanks");function kc(e){return e%Nc===Dc?qc:e%Hc===Mc?Y0:e%Kc===W0?Q0(e):ls(e)}s(kc,"FpSqrt");var X0=s((e,t)=>(Ye(e,t)&Ce)===Ce,"isNegativeLE");xe.isNegativeLE=X0;var J0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function eh(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=J0.reduce((r,o)=>(r[o]="function",r),t);return(0,Qe._validateObject)(e,n),e}s(eh,"validateField");function fs(e,t,n){if(n<Ve)throw new Error("invalid exponent, negatives unsupported");if(n===Ve)return e.ONE;if(n===Ce)return t;let r=e.ONE,o=t;for(;n>Ve;)n&Ce&&(r=e.mul(r,o)),o=e.sqr(o),n>>=Ce;return r}s(fs,"FpPow");function Vc(e,t,n=!1){let r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((a,c,u)=>e.is0(c)?a:(r[u]=a,e.mul(a,c)),e.ONE),i=e.inv(o);return t.reduceRight((a,c,u)=>e.is0(c)?a:(r[u]=e.mul(a,r[u]),e.mul(a,c)),i),r}s(Vc,"FpInvertBatch");function th(e,t,n){return e.mul(t,typeof n=="bigint"?Fr(n,e.ORDER):e.inv(n))}s(th,"FpDiv");function jr(e,t){let n=(e.ORDER-Ce)/rn,r=e.pow(t,n),o=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),a=e.eql(r,e.neg(e.ONE));if(!o&&!i&&!a)throw new Error("invalid Legendre symbol result");return o?1:i?0:-1}s(jr,"FpLegendre");function nh(e,t){return jr(e,t)===1}s(nh,"FpIsSquare");function ds(e,t){t!==void 0&&(0,Qe.anumber)(t);let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}s(ds,"nLength");function zr(e,t,n=!1,r={}){if(e<=Ve)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,i,a=!1,c;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");let d=t;d.BITS&&(o=d.BITS),d.sqrt&&(i=d.sqrt),typeof d.isLE=="boolean"&&(n=d.isLE),typeof d.modFromBytes=="boolean"&&(a=d.modFromBytes),c=d.allowedLengths}else typeof t=="number"&&(o=t),r.sqrt&&(i=r.sqrt);let{nBitLength:u,nByteLength:l}=ds(e,o);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f,p=Object.freeze({ORDER:e,isLE:n,BITS:u,BYTES:l,MASK:(0,Qe.bitMask)(u),ZERO:Ve,ONE:Ce,allowedLengths:c,create:s(d=>Ye(d,e),"create"),isValid:s(d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Ve<=d&&d<e},"isValid"),is0:s(d=>d===Ve,"is0"),isValidNot0:s(d=>!p.is0(d)&&p.isValid(d),"isValidNot0"),isOdd:s(d=>(d&Ce)===Ce,"isOdd"),neg:s(d=>Ye(-d,e),"neg"),eql:s((d,y)=>d===y,"eql"),sqr:s(d=>Ye(d*d,e),"sqr"),add:s((d,y)=>Ye(d+y,e),"add"),sub:s((d,y)=>Ye(d-y,e),"sub"),mul:s((d,y)=>Ye(d*y,e),"mul"),pow:s((d,y)=>fs(p,d,y),"pow"),div:s((d,y)=>Ye(d*Fr(y,e),e),"div"),sqrN:s(d=>d*d,"sqrN"),addN:s((d,y)=>d+y,"addN"),subN:s((d,y)=>d-y,"subN"),mulN:s((d,y)=>d*y,"mulN"),inv:s(d=>Fr(d,e),"inv"),sqrt:i||(d=>(f||(f=kc(e)),f(p,d))),toBytes:s(d=>n?(0,Qe.numberToBytesLE)(d,l):(0,Qe.numberToBytesBE)(d,l),"toBytes"),fromBytes:s((d,y=!0)=>{if(c){if(!c.includes(d.length)||d.length>l)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+d.length);let w=new Uint8Array(l);w.set(d,n?0:w.length-d.length),d=w}if(d.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+d.length);let h=n?(0,Qe.bytesToNumberLE)(d):(0,Qe.bytesToNumberBE)(d);if(a&&(h=Ye(h,e)),!y&&!p.isValid(h))throw new Error("invalid field element: outside of range 0..ORDER");return h},"fromBytes"),invertBatch:s(d=>Vc(p,d),"invertBatch"),cmov:s((d,y,h)=>h?y:d,"cmov")});return Object.freeze(p)}s(zr,"Field");function rh(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)}s(rh,"FpSqrtOdd");function oh(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}s(oh,"FpSqrtEven");function sh(e,t,n=!1){e=(0,Qe.ensureBytes)("privateHash",e);let r=e.length,o=ds(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+r);let i=n?(0,Qe.bytesToNumberLE)(e):(0,Qe.bytesToNumberBE)(e);return Ye(i,t-Ce)+Ce}s(sh,"hashToPrivateScalar");function hs(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}s(hs,"getFieldBytesLength");function Fc(e){let t=hs(e);return t+Math.ceil(t/2)}s(Fc,"getMinHashLength");function ih(e,t,n=!1){let r=e.length,o=hs(t),i=Fc(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);let a=n?(0,Qe.bytesToNumberLE)(e):(0,Qe.bytesToNumberBE)(e),c=Ye(a,t-Ce)+Ce;return n?(0,Qe.numberToBytesLE)(c,o):(0,Qe.numberToBytesBE)(c,o)}s(ih,"mapHashToField")});var Gr=re(ut=>{"use strict";g();b();Object.defineProperty(ut,"__esModule",{value:!0});ut.wNAF=void 0;ut.negateCt=gs;ut.normalizeZ=ah;ut.mulEndoUnsafe=ch;ut.pippenger=uh;ut.precomputeMSMUnsafe=lh;ut.validateBasic=fh;ut._createCurveFields=dh;var rr=Nt(),or=Qt(),On=BigInt(0),on=BigInt(1);function gs(e,t){let n=t.negate();return e?n:t}s(gs,"negateCt");function ah(e,t){let n=(0,or.FpInvertBatch)(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}s(ah,"normalizeZ");function ws(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}s(ws,"validateW");function ps(e,t){ws(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,i=(0,rr.bitMask)(e),a=BigInt(e);return{windows:n,windowSize:r,mask:i,maxNumber:o,shiftBy:a}}s(ps,"calcWOpts");function jc(e,t,n){let{windowSize:r,mask:o,maxNumber:i,shiftBy:a}=n,c=Number(e&o),u=e>>a;c>r&&(c-=i,u+=on);let l=t*r,f=l+Math.abs(c)-1,p=c===0,d=c<0,y=t%2!==0;return{nextN:u,offset:f,isZero:p,isNeg:d,isNegF:y,offsetF:l}}s(jc,"calcOffsets");function Wc(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}s(Wc,"validateMSMPoints");function $c(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}s($c,"validateMSMScalars");var ys=new WeakMap,Zc=new WeakMap;function ms(e){return Zc.get(e)||1}s(ms,"getW");function zc(e){if(e!==On)throw new Error("invalid wNAF")}s(zc,"assert0");var bs=class{static{s(this,"wNAF")}constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>On;)n&on&&(r=r.add(o)),o=o.double(),n>>=on;return r}precomputeWindow(t,n){let{windows:r,windowSize:o}=ps(n,this.bits),i=[],a=t,c=a;for(let u=0;u<r;u++){c=a,i.push(c);for(let l=1;l<o;l++)c=c.add(a),i.push(c);a=c.double()}return i}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,i=this.BASE,a=ps(t,this.bits);for(let c=0;c<a.windows;c++){let{nextN:u,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:y}=jc(r,c,a);r=u,f?i=i.add(gs(d,n[y])):o=o.add(gs(p,n[l]))}return zc(r),{p:o,f:i}}wNAFUnsafe(t,n,r,o=this.ZERO){let i=ps(t,this.bits);for(let a=0;a<i.windows&&r!==On;a++){let{nextN:c,offset:u,isZero:l,isNeg:f}=jc(r,a,i);if(r=c,!l){let p=n[u];o=o.add(f?p.negate():p)}}return zc(r),o}getPrecomputes(t,n,r){let o=ys.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),ys.set(n,o))),o}cached(t,n,r){let o=ms(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){let i=ms(t);return i===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),n,o)}createCache(t,n){ws(n,this.bits),Zc.set(t,n),ys.delete(t)}hasCache(t){return ms(t)!==1}};ut.wNAF=bs;function ch(e,t,n,r){let o=t,i=e.ZERO,a=e.ZERO;for(;n>On||r>On;)n&on&&(i=i.add(o)),r&on&&(a=a.add(o)),o=o.double(),n>>=on,r>>=on;return{p1:i,p2:a}}s(ch,"mulEndoUnsafe");function uh(e,t,n,r){Wc(n,e),$c(r,t);let o=n.length,i=r.length;if(o!==i)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,c=(0,rr.bitLen)(BigInt(o)),u=1;c>12?u=c-3:c>4?u=c-2:c>0&&(u=2);let l=(0,rr.bitMask)(u),f=new Array(Number(l)+1).fill(a),p=Math.floor((t.BITS-1)/u)*u,d=a;for(let y=p;y>=0;y-=u){f.fill(a);for(let w=0;w<i;w++){let m=r[w],x=Number(m>>BigInt(y)&l);f[x]=f[x].add(n[w])}let h=a;for(let w=f.length-1,m=a;w>0;w--)m=m.add(f[w]),h=h.add(m);if(d=d.add(h),y!==0)for(let w=0;w<u;w++)d=d.double()}return d}s(uh,"pippenger");function lh(e,t,n,r){ws(r,t.BITS),Wc(n,e);let o=e.ZERO,i=2**r-1,a=Math.ceil(t.BITS/r),c=(0,rr.bitMask)(r),u=n.map(l=>{let f=[];for(let p=0,d=l;p<i;p++)f.push(d),d=d.add(l);return f});return l=>{if($c(l,t),l.length>n.length)throw new Error("array of scalars must be smaller than array of points");let f=o;for(let p=0;p<a;p++){if(f!==o)for(let y=0;y<r;y++)f=f.double();let d=BigInt(a*r-(p+1)*r);for(let y=0;y<l.length;y++){let h=l[y],w=Number(h>>d&c);w&&(f=f.add(u[y][w-1]))}}return f}}s(lh,"precomputeMSMUnsafe");function fh(e){return(0,or.validateField)(e.Fp),(0,rr.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,or.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}s(fh,"validateBasic");function Gc(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,or.validateField)(t),t}else return(0,or.Field)(e,{isLE:n})}s(Gc,"createField");function dh(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let u of["p","n","h"]){let l=t[u];if(!(typeof l=="bigint"&&l>On))throw new Error(`CURVE.${u} must be positive bigint`)}let o=Gc(t.p,n.Fp,r),i=Gc(t.n,n.Fn,r),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let u of c)if(!o.isValid(t[u]))throw new Error(`CURVE.${u} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:i}}s(dh,"_createCurveFields")});var Xc=re(an=>{"use strict";g();b();Object.defineProperty(an,"__esModule",{value:!0});an.PrimeEdwardsPoint=void 0;an.edwards=Yc;an.eddsa=Qc;an.twistedEdwards=bh;var ce=Nt(),sn=Gr(),hh=Qt(),Xt=BigInt(0),Te=BigInt(1),xs=BigInt(2),ph=BigInt(8);function yh(e,t,n,r){let o=e.sqr(n),i=e.sqr(r),a=e.add(e.mul(t.a,o),i),c=e.add(e.ONE,e.mul(t.d,e.mul(o,i)));return e.eql(a,c)}s(yh,"isEdValidXY");function Yc(e,t={}){let n=(0,sn._createCurveFields)("edwards",e,t,t.FpFnLE),{Fp:r,Fn:o}=n,i=n.CURVE,{h:a}=i;(0,ce._validateObject)(t,{},{uvRatio:"function"});let c=xs<<BigInt(o.BYTES*8)-Te,u=s(m=>r.create(m),"modP"),l=t.uvRatio||((m,x)=>{try{return{isValid:!0,value:r.sqrt(r.div(m,x))}}catch{return{isValid:!1,value:Xt}}});if(!yh(r,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function f(m,x,E=!1){let S=E?Te:Xt;return(0,ce.aInRange)("coordinate "+m,x,S,c),x}s(f,"acoord");function p(m){if(!(m instanceof h))throw new Error("ExtendedPoint expected")}s(p,"aextpoint");let d=(0,ce.memoized)((m,x)=>{let{X:E,Y:S,Z:C}=m,H=m.is0();x==null&&(x=H?ph:r.inv(C));let q=u(E*x),G=u(S*x),k=r.mul(C,x);if(H)return{x:Xt,y:Te};if(k!==Te)throw new Error("invZ was invalid");return{x:q,y:G}}),y=(0,ce.memoized)(m=>{let{a:x,d:E}=i;if(m.is0())throw new Error("bad point: ZERO");let{X:S,Y:C,Z:H,T:q}=m,G=u(S*S),k=u(C*C),B=u(H*H),O=u(B*B),R=u(G*x),D=u(B*u(R+k)),v=u(O+u(E*u(G*k)));if(D!==v)throw new Error("bad point: equation left != right (1)");let _=u(S*C),A=u(H*q);if(_!==A)throw new Error("bad point: equation left != right (2)");return!0});class h{static{s(this,"Point")}constructor(x,E,S,C){this.X=f("x",x),this.Y=f("y",E),this.Z=f("z",S,!0),this.T=f("t",C),Object.freeze(this)}static CURVE(){return i}static fromAffine(x){if(x instanceof h)throw new Error("extended point not allowed");let{x:E,y:S}=x||{};return f("x",E),f("y",S),new h(E,S,Te,u(E*S))}static fromBytes(x,E=!1){let S=r.BYTES,{a:C,d:H}=i;x=(0,ce.copyBytes)((0,ce._abytes2)(x,S,"point")),(0,ce._abool2)(E,"zip215");let q=(0,ce.copyBytes)(x),G=x[S-1];q[S-1]=G&-129;let k=(0,ce.bytesToNumberLE)(q),B=E?c:r.ORDER;(0,ce.aInRange)("point.y",k,Xt,B);let O=u(k*k),R=u(O-Te),D=u(H*O-C),{isValid:v,value:_}=l(R,D);if(!v)throw new Error("bad point: invalid y coordinate");let A=(_&Te)===Te,P=(G&128)!==0;if(!E&&_===Xt&&P)throw new Error("bad point: x=0 and x_0=1");return P!==A&&(_=u(-_)),h.fromAffine({x:_,y:k})}static fromHex(x,E=!1){return h.fromBytes((0,ce.ensureBytes)("point",x),E)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,E=!0){return w.createCache(this,x),E||this.multiply(xs),this}assertValidity(){y(this)}equals(x){p(x);let{X:E,Y:S,Z:C}=this,{X:H,Y:q,Z:G}=x,k=u(E*G),B=u(H*C),O=u(S*G),R=u(q*C);return k===B&&O===R}is0(){return this.equals(h.ZERO)}negate(){return new h(u(-this.X),this.Y,this.Z,u(-this.T))}double(){let{a:x}=i,{X:E,Y:S,Z:C}=this,H=u(E*E),q=u(S*S),G=u(xs*u(C*C)),k=u(x*H),B=E+S,O=u(u(B*B)-H-q),R=k+q,D=R-G,v=k-q,_=u(O*D),A=u(R*v),P=u(O*v),U=u(D*R);return new h(_,A,U,P)}add(x){p(x);let{a:E,d:S}=i,{X:C,Y:H,Z:q,T:G}=this,{X:k,Y:B,Z:O,T:R}=x,D=u(C*k),v=u(H*B),_=u(G*S*R),A=u(q*O),P=u((C+H)*(k+B)-D-v),U=A-_,M=A+_,L=u(v-E*D),N=u(P*U),K=u(M*L),z=u(P*L),se=u(U*M);return new h(N,K,se,z)}subtract(x){return this.add(x.negate())}multiply(x){if(!o.isValidNot0(x))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:E,f:S}=w.cached(this,x,C=>(0,sn.normalizeZ)(h,C));return(0,sn.normalizeZ)(h,[E,S])[0]}multiplyUnsafe(x,E=h.ZERO){if(!o.isValid(x))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return x===Xt?h.ZERO:this.is0()||x===Te?this:w.unsafe(this,x,S=>(0,sn.normalizeZ)(h,S),E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,i.n).is0()}toAffine(x){return d(this,x)}clearCofactor(){return a===Te?this:this.multiplyUnsafe(a)}toBytes(){let{x,y:E}=this.toAffine(),S=r.toBytes(E);return S[S.length-1]|=x&Te?128:0,S}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(x){return(0,sn.normalizeZ)(h,x)}static msm(x,E){return(0,sn.pippenger)(h,o,x,E)}_setWindowSize(x){this.precompute(x)}toRawBytes(){return this.toBytes()}}h.BASE=new h(i.Gx,i.Gy,Te,u(i.Gx*i.Gy)),h.ZERO=new h(Xt,Te,Te,Xt),h.Fp=r,h.Fn=o;let w=new sn.wNAF(h,o.BITS);return h.BASE.precompute(8),h}s(Yc,"edwards");var Es=class{static{s(this,"PrimeEdwardsPoint")}constructor(t){this.ep=t}static fromBytes(t){(0,ce.notImplemented)()}static fromHex(t){(0,ce.notImplemented)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,n){return this.init(this.ep.precompute(t,n))}toRawBytes(){return this.toBytes()}};an.PrimeEdwardsPoint=Es;function Qc(e,t,n={}){if(typeof t!="function")throw new Error('"hash" function param is required');(0,ce._validateObject)(n,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r}=n,{BASE:o,Fp:i,Fn:a}=e,c=n.randomBytes||ce.randomBytes,u=n.adjustScalarBytes||(B=>B),l=n.domain||((B,O,R)=>{if((0,ce._abool2)(R,"phflag"),O.length||R)throw new Error("Contexts/pre-hash are not supported");return B});function f(B){return a.create((0,ce.bytesToNumberLE)(B))}s(f,"modN_LE");function p(B){let O=S.secretKey;B=(0,ce.ensureBytes)("private key",B,O);let R=(0,ce.ensureBytes)("hashed private key",t(B),2*O),D=u(R.slice(0,O)),v=R.slice(O,2*O),_=f(D);return{head:D,prefix:v,scalar:_}}s(p,"getPrivateScalar");function d(B){let{head:O,prefix:R,scalar:D}=p(B),v=o.multiply(D),_=v.toBytes();return{head:O,prefix:R,scalar:D,point:v,pointBytes:_}}s(d,"getExtendedPublicKey");function y(B){return d(B).pointBytes}s(y,"getPublicKey");function h(B=Uint8Array.of(),...O){let R=(0,ce.concatBytes)(...O);return f(t(l(R,(0,ce.ensureBytes)("context",B),!!r)))}s(h,"hashDomainToScalar");function w(B,O,R={}){B=(0,ce.ensureBytes)("message",B),r&&(B=r(B));let{prefix:D,scalar:v,pointBytes:_}=d(O),A=h(R.context,D,B),P=o.multiply(A).toBytes(),U=h(R.context,P,_,B),M=a.create(A+U*v);if(!a.isValid(M))throw new Error("sign failed: invalid s");let L=(0,ce.concatBytes)(P,a.toBytes(M));return(0,ce._abytes2)(L,S.signature,"result")}s(w,"sign");let m={zip215:!0};function x(B,O,R,D=m){let{context:v,zip215:_}=D,A=S.signature;B=(0,ce.ensureBytes)("signature",B,A),O=(0,ce.ensureBytes)("message",O),R=(0,ce.ensureBytes)("publicKey",R,S.publicKey),_!==void 0&&(0,ce._abool2)(_,"zip215"),r&&(O=r(O));let P=A/2,U=B.subarray(0,P),M=(0,ce.bytesToNumberLE)(B.subarray(P,A)),L,N,K;try{L=e.fromBytes(R,_),N=e.fromBytes(U,_),K=o.multiplyUnsafe(M)}catch{return!1}if(!_&&L.isSmallOrder())return!1;let z=h(v,N.toBytes(),L.toBytes(),O);return N.add(L.multiplyUnsafe(z)).subtract(K).clearCofactor().is0()}s(x,"verify");let E=i.BYTES,S={secretKey:E,publicKey:E,signature:2*E,seed:E};function C(B=c(S.seed)){return(0,ce._abytes2)(B,S.seed,"seed")}s(C,"randomSecretKey");function H(B){let O=k.randomSecretKey(B);return{secretKey:O,publicKey:y(O)}}s(H,"keygen");function q(B){return(0,ce.isBytes)(B)&&B.length===a.BYTES}s(q,"isValidSecretKey");function G(B,O){try{return!!e.fromBytes(B,O)}catch{return!1}}s(G,"isValidPublicKey");let k={getExtendedPublicKey:d,randomSecretKey:C,isValidSecretKey:q,isValidPublicKey:G,toMontgomery(B){let{y:O}=e.fromBytes(B),R=S.publicKey,D=R===32;if(!D&&R!==57)throw new Error("only defined for 25519 and 448");let v=D?i.div(Te+O,Te-O):i.div(O-Te,O+Te);return i.toBytes(v)},toMontgomerySecret(B){let O=S.secretKey;(0,ce._abytes2)(B,O);let R=t(B.subarray(0,O));return u(R).subarray(0,O)},randomPrivateKey:C,precompute(B=8,O=e.BASE){return O.precompute(B,!1)}};return Object.freeze({keygen:H,getPublicKey:y,sign:w,verify:x,utils:k,Point:e,lengths:S})}s(Qc,"eddsa");function mh(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=(0,hh.Field)(t.n,e.nBitLength,!0),o={Fp:n,Fn:r,uvRatio:e.uvRatio},i={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,hash:e.hash,eddsaOpts:i}}s(mh,"_eddsa_legacy_opts_to_new");function gh(e,t){let n=t.Point;return Object.assign({},t,{ExtendedPoint:n,CURVE:e,nBitLength:n.Fn.BITS,nByteLength:n.Fn.BYTES})}s(gh,"_eddsa_new_output_to_legacy");function bh(e){let{CURVE:t,curveOpts:n,hash:r,eddsaOpts:o}=mh(e),i=Yc(t,n),a=Qc(i,r,o);return gh(e,a)}s(bh,"twistedEdwards")});var vs=re(wt=>{"use strict";g();b();Object.defineProperty(wt,"__esModule",{value:!0});wt._DST_scalar=void 0;wt.expand_message_xmd=tu;wt.expand_message_xof=nu;wt.hash_to_field=Wr;wt.isogenyMap=Eh;wt.createHasher=vh;var Le=Nt(),Jc=Qt(),wh=Le.bytesToNumberBE;function Jt(e,t){if(sr(e),sr(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);let n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}s(Jt,"i2osp");function xh(e,t){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}s(xh,"strxor");function sr(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}s(sr,"anum");function eu(e){if(!(0,Le.isBytes)(e)&&typeof e!="string")throw new Error("DST must be Uint8Array or string");return typeof e=="string"?(0,Le.utf8ToBytes)(e):e}s(eu,"normDST");function tu(e,t,n,r){(0,Le.abytes)(e),sr(n),t=eu(t),t.length>255&&(t=r((0,Le.concatBytes)((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:i}=r,a=Math.ceil(n/o);if(n>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");let c=(0,Le.concatBytes)(t,Jt(t.length,1)),u=Jt(0,i),l=Jt(n,2),f=new Array(a),p=r((0,Le.concatBytes)(u,e,l,Jt(0,1),c));f[0]=r((0,Le.concatBytes)(p,Jt(1,1),c));for(let y=1;y<=a;y++){let h=[xh(p,f[y-1]),Jt(y+1,1),c];f[y]=r((0,Le.concatBytes)(...h))}return(0,Le.concatBytes)(...f).slice(0,n)}s(tu,"expand_message_xmd");function nu(e,t,n,r,o){if((0,Le.abytes)(e),sr(n),t=eu(t),t.length>255){let i=Math.ceil(2*r/8);t=o.create({dkLen:i}).update((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:n}).update(e).update(Jt(n,2)).update(t).update(Jt(t.length,1)).digest()}s(nu,"expand_message_xof");function Wr(e,t,n){(0,Le._validateObject)(n,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:r,k:o,m:i,hash:a,expand:c,DST:u}=n;if(!(0,Le.isHash)(n.hash))throw new Error("expected valid hash");(0,Le.abytes)(e),sr(t);let l=r.toString(2).length,f=Math.ceil((l+o)/8),p=t*i*f,d;if(c==="xmd")d=tu(e,u,p,a);else if(c==="xof")d=nu(e,u,p,o,a);else if(c==="_internal_pass")d=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let h=0;h<t;h++){let w=new Array(i);for(let m=0;m<i;m++){let x=f*(m+h*i),E=d.subarray(x,x+f);w[m]=(0,Jc.mod)(wh(E),r)}y[h]=w}return y}s(Wr,"hash_to_field");function Eh(e,t){let n=t.map(r=>Array.from(r).reverse());return(r,o)=>{let[i,a,c,u]=n.map(p=>p.reduce((d,y)=>e.add(e.mul(d,r),y))),[l,f]=(0,Jc.FpInvertBatch)(e,[a,u],!0);return r=e.mul(i,l),o=e.mul(o,e.mul(c,f)),{x:r,y:o}}}s(Eh,"isogenyMap");wt._DST_scalar=(0,Le.utf8ToBytes)("HashToScalar-");function vh(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function r(i){return e.fromAffine(t(i))}s(r,"map");function o(i){let a=i.clearCofactor();return a.equals(e.ZERO)?e.ZERO:(a.assertValidity(),a)}return s(o,"clear"),{defaults:n,hashToCurve(i,a){let c=Object.assign({},n,a),u=Wr(i,2,c),l=r(u[0]),f=r(u[1]);return o(l.add(f))},encodeToCurve(i,a){let c=n.encodeDST?{DST:n.encodeDST}:{},u=Object.assign({},n,c,a),l=Wr(i,1,u),f=r(l[0]);return o(f)},mapToCurve(i){if(!Array.isArray(i))throw new Error("expected array of bigints");for(let a of i)if(typeof a!="bigint")throw new Error("expected array of bigints");return o(r(i))},hashToScalar(i,a){let c=e.Fn.ORDER,u=Object.assign({},n,{p:c,m:1,DST:wt._DST_scalar},a);return Wr(i,1,u)[0][0]}}}s(vh,"createHasher")});var ru=re(_s=>{"use strict";g();b();Object.defineProperty(_s,"__esModule",{value:!0});_s.montgomery=Ah;var xt=Nt(),_h=Qt(),ir=BigInt(0),Pn=BigInt(1),$r=BigInt(2);function Sh(e){return(0,xt._validateObject)(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}s(Sh,"validateOpts");function Ah(e){let t=Sh(e),{P:n,type:r,adjustScalarBytes:o,powPminus2:i,randomBytes:a}=t,c=r==="x25519";if(!c&&r!=="x448")throw new Error("invalid type");let u=a||xt.randomBytes,l=c?255:448,f=c?32:56,p=BigInt(c?9:5),d=BigInt(c?121665:39081),y=c?$r**BigInt(254):$r**BigInt(447),h=c?BigInt(8)*$r**BigInt(251)-Pn:BigInt(4)*$r**BigInt(445)-Pn,w=y+h+Pn,m=s(v=>(0,_h.mod)(v,n),"modP"),x=E(p);function E(v){return(0,xt.numberToBytesLE)(m(v),f)}s(E,"encodeU");function S(v){let _=(0,xt.ensureBytes)("u coordinate",v,f);return c&&(_[31]&=127),m((0,xt.bytesToNumberLE)(_))}s(S,"decodeU");function C(v){return(0,xt.bytesToNumberLE)(o((0,xt.ensureBytes)("scalar",v,f)))}s(C,"decodeScalar");function H(v,_){let A=k(S(_),C(v));if(A===ir)throw new Error("invalid private or public key received");return E(A)}s(H,"scalarMult");function q(v){return H(v,x)}s(q,"scalarMultBase");function G(v,_,A){let P=m(v*(_-A));return _=m(_-P),A=m(A+P),{x_2:_,x_3:A}}s(G,"cswap");function k(v,_){(0,xt.aInRange)("u",v,ir,n),(0,xt.aInRange)("scalar",_,y,w);let A=_,P=v,U=Pn,M=ir,L=v,N=Pn,K=ir;for(let se=BigInt(l-1);se>=ir;se--){let ie=A>>se&Pn;K^=ie,{x_2:U,x_3:L}=G(K,U,L),{x_2:M,x_3:N}=G(K,M,N),K=ie;let J=U+M,ue=m(J*J),he=U-M,be=m(he*he),fe=ue-be,Ie=L+N,yn=L-N,$n=m(yn*J),Zn=m(Ie*he),ui=$n+Zn,li=$n-Zn;L=m(ui*ui),N=m(P*m(li*li)),U=m(ue*be),M=m(fe*(ue+m(d*fe)))}({x_2:U,x_3:L}=G(K,U,L)),{x_2:M,x_3:N}=G(K,M,N);let z=i(M);return m(U*z)}s(k,"montgomeryLadder");let B={secretKey:f,publicKey:f,seed:f},O=s((v=u(f))=>((0,xt.abytes)(v,B.seed),v),"randomSecretKey");function R(v){let _=O(v);return{secretKey:_,publicKey:q(_)}}return s(R,"keygen"),{keygen:R,getSharedSecret:s((v,_)=>H(v,_),"getSharedSecret"),getPublicKey:s(v=>q(v),"getPublicKey"),scalarMult:H,scalarMultBase:q,utils:{randomSecretKey:O,randomPrivateKey:O},GuBytes:x.slice(),lengths:B}}s(Ah,"montgomery")});var yu=re(Q=>{"use strict";g();b();Object.defineProperty(Q,"__esModule",{value:!0});Q.hash_to_ristretto255=Q.hashToRistretto255=Q.encodeToCurve=Q.hashToCurve=Q.RistrettoPoint=Q.edwardsToMontgomery=Q.ED25519_TORSION_SUBGROUP=Q.ristretto255_hasher=Q.ristretto255=Q.ed25519_hasher=Q.x25519=Q.ed25519ph=Q.ed25519ctx=Q.ed25519=void 0;Q.edwardsToMontgomeryPub=pu;Q.edwardsToMontgomeryPriv=Kh;var ar=kr(),Yr=mt(),Bh=Gr(),Xr=Xc(),Zr=vs(),de=Qt(),Ch=ru(),cn=Nt(),Ih=BigInt(0),Et=BigInt(1),Qr=BigInt(2),au=BigInt(3),cu=BigInt(5),Cs=BigInt(8),Mt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),cr={p:Mt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Cs,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function uu(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),i=Mt,c=e*e%i*e%i,u=(0,de.pow2)(c,Qr,i)*c%i,l=(0,de.pow2)(u,Et,i)*e%i,f=(0,de.pow2)(l,cu,i)*l%i,p=(0,de.pow2)(f,t,i)*f%i,d=(0,de.pow2)(p,n,i)*p%i,y=(0,de.pow2)(d,r,i)*d%i,h=(0,de.pow2)(y,o,i)*y%i,w=(0,de.pow2)(h,o,i)*y%i,m=(0,de.pow2)(w,t,i)*f%i;return{pow_p_5_8:(0,de.pow2)(m,Qr,i)*e%i,b2:c}}s(uu,"ed25519_pow_2_252_3");function lu(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}s(lu,"adjustScalarBytes");var Ss=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Is(e,t){let n=Mt,r=(0,de.mod)(t*t*t,n),o=(0,de.mod)(r*r*t,n),i=uu(e*o).pow_p_5_8,a=(0,de.mod)(e*r*i,n),c=(0,de.mod)(t*a*a,n),u=a,l=(0,de.mod)(a*Ss,n),f=c===e,p=c===(0,de.mod)(-e,n),d=c===(0,de.mod)(-e*Ss,n);return f&&(a=u),(p||d)&&(a=l),(0,de.isNegativeLE)(a,n)&&(a=(0,de.mod)(-a,n)),{isValid:f||p,value:a}}s(Is,"uvRatio");var F=(0,de.Field)(cr.p,{isLE:!0}),fu=(0,de.Field)(cr.n,{isLE:!0}),Ts={...cr,Fp:F,hash:ar.sha512,adjustScalarBytes:lu,uvRatio:Is};Q.ed25519=(0,Xr.twistedEdwards)(Ts);function du(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,Yr.concatBytes)((0,Yr.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}s(du,"ed25519_domain");Q.ed25519ctx=(0,Xr.twistedEdwards)({...Ts,domain:du});Q.ed25519ph=(0,Xr.twistedEdwards)(Object.assign({},Ts,{domain:du,prehash:ar.sha512}));Q.x25519=(()=>{let e=F.ORDER;return(0,Ch.montgomery)({P:e,type:"x25519",powPminus2:s(t=>{let{pow_p_5_8:n,b2:r}=uu(t);return(0,de.mod)((0,de.pow2)(n,au,e)*r,e)},"powPminus2"),adjustScalarBytes:lu})})();var Th=(Mt+au)/Cs,Lh=F.pow(Qr,Th),ou=F.sqrt(F.neg(F.ONE));function Oh(e){let t=(Mt-cu)/Cs,n=BigInt(486662),r=F.sqr(e);r=F.mul(r,Qr);let o=F.add(r,F.ONE),i=F.neg(n),a=F.sqr(o),c=F.mul(a,o),u=F.mul(r,n);u=F.mul(u,i),u=F.add(u,a),u=F.mul(u,i);let l=F.sqr(c);a=F.sqr(l),l=F.mul(l,c),l=F.mul(l,u),a=F.mul(a,l);let f=F.pow(a,t);f=F.mul(f,l);let p=F.mul(f,ou);a=F.sqr(f),a=F.mul(a,c);let d=F.eql(a,u),y=F.cmov(p,f,d),h=F.mul(i,r),w=F.mul(f,e);w=F.mul(w,Lh);let m=F.mul(w,ou),x=F.mul(u,r);a=F.sqr(w),a=F.mul(a,c);let E=F.eql(a,x),S=F.cmov(m,w,E);a=F.sqr(y),a=F.mul(a,c);let C=F.eql(a,u),H=F.cmov(h,i,C),q=F.cmov(S,y,C),G=F.isOdd(q);return q=F.cmov(q,F.neg(q),C!==G),{xMn:H,xMd:o,yMn:q,yMd:Et}}s(Oh,"map_to_curve_elligator2_curve25519");var Ph=(0,de.FpSqrtEven)(F,F.neg(BigInt(486664)));function Uh(e){let{xMn:t,xMd:n,yMn:r,yMd:o}=Oh(e),i=F.mul(t,o);i=F.mul(i,Ph);let a=F.mul(n,r),c=F.sub(t,n),u=F.add(t,n),l=F.mul(a,u),f=F.eql(l,F.ZERO);i=F.cmov(i,F.ZERO,f),a=F.cmov(a,F.ONE,f),c=F.cmov(c,F.ONE,f),u=F.cmov(u,F.ONE,f);let[p,d]=(0,de.FpInvertBatch)(F,[a,u],!0);return{x:F.mul(i,p),y:F.mul(c,d)}}s(Uh,"map_to_curve_elligator2_edwards25519");Q.ed25519_hasher=(0,Zr.createHasher)(Q.ed25519.Point,e=>Uh(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:Mt,m:1,k:128,expand:"xmd",hash:ar.sha512});var As=Ss,Rh=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Dh=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Nh=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Mh=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),su=s(e=>Is(Et,e),"invertSqrt"),Hh=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Bs=s(e=>Q.ed25519.Point.Fp.create((0,cn.bytesToNumberLE)(e)&Hh),"bytes255ToNumberLE");function iu(e){let{d:t}=cr,n=Mt,r=s(x=>F.create(x),"mod"),o=r(As*e*e),i=r((o+Et)*Nh),a=BigInt(-1),c=r((a-t*o)*r(o+t)),{isValid:u,value:l}=Is(i,c),f=r(l*e);(0,de.isNegativeLE)(f,n)||(f=r(-f)),u||(l=f),u||(a=o);let p=r(a*(o-Et)*Mh-c),d=l*l,y=r((l+l)*c),h=r(p*Rh),w=r(Et-d),m=r(Et+d);return new Q.ed25519.Point(r(y*m),r(w*h),r(h*m),r(y*w))}s(iu,"calcElligatorRistrettoMap");function hu(e){(0,Yr.abytes)(e,64);let t=Bs(e.subarray(0,32)),n=iu(t),r=Bs(e.subarray(32,64)),o=iu(r);return new lt(n.add(o))}s(hu,"ristretto255_map");var lt=class e extends Xr.PrimeEdwardsPoint{static{s(this,"_RistrettoPoint")}constructor(t){super(t)}static fromAffine(t){return new e(Q.ed25519.Point.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static hashToCurve(t){return hu((0,cn.ensureBytes)("ristrettoHash",t,64))}static fromBytes(t){(0,Yr.abytes)(t,32);let{a:n,d:r}=cr,o=Mt,i=s(C=>F.create(C),"mod"),a=Bs(t);if(!(0,cn.equalBytes)(F.toBytes(a),t)||(0,de.isNegativeLE)(a,o))throw new Error("invalid ristretto255 encoding 1");let c=i(a*a),u=i(Et+n*c),l=i(Et-n*c),f=i(u*u),p=i(l*l),d=i(n*r*f-p),{isValid:y,value:h}=su(i(d*p)),w=i(h*l),m=i(h*w*d),x=i((a+a)*w);(0,de.isNegativeLE)(x,o)&&(x=i(-x));let E=i(u*m),S=i(x*E);if(!y||(0,de.isNegativeLE)(S,o)||E===Ih)throw new Error("invalid ristretto255 encoding 2");return new e(new Q.ed25519.Point(x,E,Et,S))}static fromHex(t){return e.fromBytes((0,cn.ensureBytes)("ristrettoHex",t,32))}static msm(t,n){return(0,Bh.pippenger)(e,Q.ed25519.Point.Fn,t,n)}toBytes(){let{X:t,Y:n,Z:r,T:o}=this.ep,i=Mt,a=s(m=>F.create(m),"mod"),c=a(a(r+n)*a(r-n)),u=a(t*n),l=a(u*u),{value:f}=su(a(c*l)),p=a(f*c),d=a(f*u),y=a(p*d*o),h;if((0,de.isNegativeLE)(o*y,i)){let m=a(n*As),x=a(t*As);t=m,n=x,h=a(p*Dh)}else h=d;(0,de.isNegativeLE)(t*y,i)&&(n=a(-n));let w=a((r-n)*h);return(0,de.isNegativeLE)(w,i)&&(w=a(-w)),F.toBytes(w)}equals(t){this.assertSame(t);let{X:n,Y:r}=this.ep,{X:o,Y:i}=t.ep,a=s(l=>F.create(l),"mod"),c=a(n*i)===a(r*o),u=a(r*i)===a(n*o);return c||u}is0(){return this.equals(e.ZERO)}};lt.BASE=new lt(Q.ed25519.Point.BASE);lt.ZERO=new lt(Q.ed25519.Point.ZERO);lt.Fp=F;lt.Fn=fu;Q.ristretto255={Point:lt};Q.ristretto255_hasher={hashToCurve(e,t){let n=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",r=(0,Zr.expand_message_xmd)(e,n,64,ar.sha512);return hu(r)},hashToScalar(e,t={DST:Zr._DST_scalar}){let n=(0,Zr.expand_message_xmd)(e,t.DST,64,ar.sha512);return fu.create((0,cn.bytesToNumberLE)(n))}};Q.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];function pu(e){return Q.ed25519.utils.toMontgomery((0,cn.ensureBytes)("pub",e))}s(pu,"edwardsToMontgomeryPub");Q.edwardsToMontgomery=pu;function Kh(e){return Q.ed25519.utils.toMontgomerySecret((0,cn.ensureBytes)("pub",e))}s(Kh,"edwardsToMontgomeryPriv");Q.RistrettoPoint=lt;Q.hashToCurve=Q.ed25519_hasher.hashToCurve;Q.encodeToCurve=Q.ed25519_hasher.encodeToCurve;Q.hashToRistretto255=Q.ristretto255_hasher.hashToCurve;Q.hash_to_ristretto255=Q.ristretto255_hasher.hashToCurve});var Ls=re(ln=>{"use strict";g();b();Object.defineProperty(ln,"__esModule",{value:!0});ln.hmac=ln.HMAC=void 0;var un=mt(),ur=class extends un.Hash{static{s(this,"HMAC")}constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,un.ahash)(t);let r=(0,un.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(r.length>o?t.create().update(r).digest():r);for(let a=0;a<i.length;a++)i[a]^=54;this.iHash.update(i),this.oHash=t.create();for(let a=0;a<i.length;a++)i[a]^=106;this.oHash.update(i),(0,un.clean)(i)}update(t){return(0,un.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,un.aexists)(this),(0,un.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:i,blockLen:a,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=a,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};ln.HMAC=ur;var qh=s((e,t,n)=>new ur(e,t).update(n).digest(),"hmac");ln.hmac=qh;ln.hmac.create=(e,t)=>new ur(e,t)});var Ds=re(ge=>{"use strict";g();b();Object.defineProperty(ge,"__esModule",{value:!0});ge.DER=ge.DERErr=void 0;ge._splitEndoScalar=gu;ge._normFnElement=en;ge.weierstrassN=Rs;ge.SWUFpSqrtRatio=wu;ge.mapToCurveSimpleSWU=Fh;ge.ecdh=Eu;ge.ecdsa=vu;ge.weierstrassPoints=jh;ge._legacyHelperEquat=Su;ge.weierstrass=$h;var kh=Ls(),Vh=mt(),W=Nt(),Ht=Gr(),Rn=Qt(),mu=s((e,t)=>(e+(e>=0?t:-t)/vt)/t,"divNearest");function gu(e,t,n){let[[r,o],[i,a]]=t,c=mu(a*e,n),u=mu(-o*e,n),l=e-c*r-u*i,f=-c*o-u*a,p=l<ft,d=f<ft;p&&(l=-l),d&&(f=-f);let y=(0,W.bitMask)(Math.ceil((0,W.bitLen)(n)/2))+Oe;if(l<ft||l>=y||f<ft||f>=y)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:p,k1:l,k2neg:d,k2:f}}s(gu,"_splitEndoScalar");function Ps(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}s(Ps,"validateSigFormat");function Os(e,t){let n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return(0,W._abool2)(n.lowS,"lowS"),(0,W._abool2)(n.prehash,"prehash"),n.format!==void 0&&Ps(n.format),n}s(Os,"validateSigOpts");var Jr=class extends Error{static{s(this,"DERErr")}constructor(t=""){super(t)}};ge.DERErr=Jr;ge.DER={Err:Jr,_tlv:{encode:s((e,t)=>{let{Err:n}=ge.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,o=(0,W.numberToHexUnpadded)(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");let i=r>127?(0,W.numberToHexUnpadded)(o.length/2|128):"";return(0,W.numberToHexUnpadded)(e)+i+o+t},"encode"),decode(e,t){let{Err:n}=ge.DER,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let o=t[r++],i=!!(o&128),a=0;if(!i)a=o;else{let u=o&127;if(!u)throw new n("tlv.decode(long): indefinite length not supported");if(u>4)throw new n("tlv.decode(long): byte length is too big");let l=t.subarray(r,r+u);if(l.length!==u)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let f of l)a=a<<8|f;if(r+=u,a<128)throw new n("tlv.decode(long): not minimal encoding")}let c=t.subarray(r,r+a);if(c.length!==a)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+a)}}},_int:{encode(e){let{Err:t}=ge.DER;if(e<ft)throw new t("integer: negative integers are not allowed");let n=(0,W.numberToHexUnpadded)(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){let{Err:t}=ge.DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return(0,W.bytesToNumberBE)(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=ge.DER,o=(0,W.ensureBytes)("signature",e),{v:i,l:a}=r.decode(48,o);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:c,l:u}=r.decode(2,i),{v:l,l:f}=r.decode(2,u);if(f.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(l)}},hexFromSig(e){let{_tlv:t,_int:n}=ge.DER,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),i=r+o;return t.encode(48,i)}};var ft=BigInt(0),Oe=BigInt(1),vt=BigInt(2),Un=BigInt(3),Us=BigInt(4);function en(e,t){let{BYTES:n}=e,r;if(typeof t=="bigint")r=t;else{let o=(0,W.ensureBytes)("private key",t);try{r=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}s(en,"_normFnElement");function Rs(e,t={}){let n=(0,Ht._createCurveFields)("weierstrass",e,t),{Fp:r,Fn:o}=n,i=n.CURVE,{h:a,n:c}=i;(0,W._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:u}=t;if(u&&(!r.is0(i.a)||typeof u.beta!="bigint"||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=xu(r,o);function f(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}s(f,"assertCompressionIsSupported");function p(D,v,_){let{x:A,y:P}=v.toAffine(),U=r.toBytes(A);if((0,W._abool2)(_,"isCompressed"),_){f();let M=!r.isOdd(P);return(0,W.concatBytes)(bu(M),U)}else return(0,W.concatBytes)(Uint8Array.of(4),U,r.toBytes(P))}s(p,"pointToBytes");function d(D){(0,W._abytes2)(D,void 0,"Point");let{publicKey:v,publicKeyUncompressed:_}=l,A=D.length,P=D[0],U=D.subarray(1);if(A===v&&(P===2||P===3)){let M=r.fromBytes(U);if(!r.isValid(M))throw new Error("bad point: is not on curve, wrong x");let L=w(M),N;try{N=r.sqrt(L)}catch(se){let ie=se instanceof Error?": "+se.message:"";throw new Error("bad point: is not on curve, sqrt error"+ie)}f();let K=r.isOdd(N);return(P&1)===1!==K&&(N=r.neg(N)),{x:M,y:N}}else if(A===_&&P===4){let M=r.BYTES,L=r.fromBytes(U.subarray(0,M)),N=r.fromBytes(U.subarray(M,M*2));if(!m(L,N))throw new Error("bad point: is not on curve");return{x:L,y:N}}else throw new Error(`bad point: got length ${A}, expected compressed=${v} or uncompressed=${_}`)}s(d,"pointFromBytes");let y=t.toBytes||p,h=t.fromBytes||d;function w(D){let v=r.sqr(D),_=r.mul(v,D);return r.add(r.add(_,r.mul(D,i.a)),i.b)}s(w,"weierstrassEquation");function m(D,v){let _=r.sqr(v),A=w(D);return r.eql(_,A)}if(s(m,"isValidXY"),!m(i.Gx,i.Gy))throw new Error("bad curve params: generator point");let x=r.mul(r.pow(i.a,Un),Us),E=r.mul(r.sqr(i.b),BigInt(27));if(r.is0(r.add(x,E)))throw new Error("bad curve params: a or b");function S(D,v,_=!1){if(!r.isValid(v)||_&&r.is0(v))throw new Error(`bad point coordinate ${D}`);return v}s(S,"acoord");function C(D){if(!(D instanceof B))throw new Error("ProjectivePoint expected")}s(C,"aprjpoint");function H(D){if(!u||!u.basises)throw new Error("no endo");return gu(D,u.basises,o.ORDER)}s(H,"splitEndoScalarN");let q=(0,W.memoized)((D,v)=>{let{X:_,Y:A,Z:P}=D;if(r.eql(P,r.ONE))return{x:_,y:A};let U=D.is0();v==null&&(v=U?r.ONE:r.inv(P));let M=r.mul(_,v),L=r.mul(A,v),N=r.mul(P,v);if(U)return{x:r.ZERO,y:r.ZERO};if(!r.eql(N,r.ONE))throw new Error("invZ was invalid");return{x:M,y:L}}),G=(0,W.memoized)(D=>{if(D.is0()){if(t.allowInfinityPoint&&!r.is0(D.Y))return;throw new Error("bad point: ZERO")}let{x:v,y:_}=D.toAffine();if(!r.isValid(v)||!r.isValid(_))throw new Error("bad point: x or y not field elements");if(!m(v,_))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function k(D,v,_,A,P){return _=new B(r.mul(_.X,D),_.Y,_.Z),v=(0,Ht.negateCt)(A,v),_=(0,Ht.negateCt)(P,_),v.add(_)}s(k,"finishEndo");class B{static{s(this,"Point")}constructor(v,_,A){this.X=S("x",v),this.Y=S("y",_,!0),this.Z=S("z",A),Object.freeze(this)}static CURVE(){return i}static fromAffine(v){let{x:_,y:A}=v||{};if(!v||!r.isValid(_)||!r.isValid(A))throw new Error("invalid affine point");if(v instanceof B)throw new Error("projective point not allowed");return r.is0(_)&&r.is0(A)?B.ZERO:new B(_,A,r.ONE)}static fromBytes(v){let _=B.fromAffine(h((0,W._abytes2)(v,void 0,"point")));return _.assertValidity(),_}static fromHex(v){return B.fromBytes((0,W.ensureBytes)("pointHex",v))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,_=!0){return R.createCache(this,v),_||this.multiply(Un),this}assertValidity(){G(this)}hasEvenY(){let{y:v}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(v)}equals(v){C(v);let{X:_,Y:A,Z:P}=this,{X:U,Y:M,Z:L}=v,N=r.eql(r.mul(_,L),r.mul(U,P)),K=r.eql(r.mul(A,L),r.mul(M,P));return N&&K}negate(){return new B(this.X,r.neg(this.Y),this.Z)}double(){let{a:v,b:_}=i,A=r.mul(_,Un),{X:P,Y:U,Z:M}=this,L=r.ZERO,N=r.ZERO,K=r.ZERO,z=r.mul(P,P),se=r.mul(U,U),ie=r.mul(M,M),J=r.mul(P,U);return J=r.add(J,J),K=r.mul(P,M),K=r.add(K,K),L=r.mul(v,K),N=r.mul(A,ie),N=r.add(L,N),L=r.sub(se,N),N=r.add(se,N),N=r.mul(L,N),L=r.mul(J,L),K=r.mul(A,K),ie=r.mul(v,ie),J=r.sub(z,ie),J=r.mul(v,J),J=r.add(J,K),K=r.add(z,z),z=r.add(K,z),z=r.add(z,ie),z=r.mul(z,J),N=r.add(N,z),ie=r.mul(U,M),ie=r.add(ie,ie),z=r.mul(ie,J),L=r.sub(L,z),K=r.mul(ie,se),K=r.add(K,K),K=r.add(K,K),new B(L,N,K)}add(v){C(v);let{X:_,Y:A,Z:P}=this,{X:U,Y:M,Z:L}=v,N=r.ZERO,K=r.ZERO,z=r.ZERO,se=i.a,ie=r.mul(i.b,Un),J=r.mul(_,U),ue=r.mul(A,M),he=r.mul(P,L),be=r.add(_,A),fe=r.add(U,M);be=r.mul(be,fe),fe=r.add(J,ue),be=r.sub(be,fe),fe=r.add(_,P);let Ie=r.add(U,L);return fe=r.mul(fe,Ie),Ie=r.add(J,he),fe=r.sub(fe,Ie),Ie=r.add(A,P),N=r.add(M,L),Ie=r.mul(Ie,N),N=r.add(ue,he),Ie=r.sub(Ie,N),z=r.mul(se,fe),N=r.mul(ie,he),z=r.add(N,z),N=r.sub(ue,z),z=r.add(ue,z),K=r.mul(N,z),ue=r.add(J,J),ue=r.add(ue,J),he=r.mul(se,he),fe=r.mul(ie,fe),ue=r.add(ue,he),he=r.sub(J,he),he=r.mul(se,he),fe=r.add(fe,he),J=r.mul(ue,fe),K=r.add(K,J),J=r.mul(Ie,fe),N=r.mul(be,N),N=r.sub(N,J),J=r.mul(be,ue),z=r.mul(Ie,z),z=r.add(z,J),new B(N,K,z)}subtract(v){return this.add(v.negate())}is0(){return this.equals(B.ZERO)}multiply(v){let{endo:_}=t;if(!o.isValidNot0(v))throw new Error("invalid scalar: out of range");let A,P,U=s(M=>R.cached(this,M,L=>(0,Ht.normalizeZ)(B,L)),"mul");if(_){let{k1neg:M,k1:L,k2neg:N,k2:K}=H(v),{p:z,f:se}=U(L),{p:ie,f:J}=U(K);P=se.add(J),A=k(_.beta,z,ie,M,N)}else{let{p:M,f:L}=U(v);A=M,P=L}return(0,Ht.normalizeZ)(B,[A,P])[0]}multiplyUnsafe(v){let{endo:_}=t,A=this;if(!o.isValid(v))throw new Error("invalid scalar: out of range");if(v===ft||A.is0())return B.ZERO;if(v===Oe)return A;if(R.hasCache(this))return this.multiply(v);if(_){let{k1neg:P,k1:U,k2neg:M,k2:L}=H(v),{p1:N,p2:K}=(0,Ht.mulEndoUnsafe)(B,A,U,L);return k(_.beta,N,K,P,M)}else return R.unsafe(A,v)}multiplyAndAddUnsafe(v,_,A){let P=this.multiplyUnsafe(_).add(v.multiplyUnsafe(A));return P.is0()?void 0:P}toAffine(v){return q(this,v)}isTorsionFree(){let{isTorsionFree:v}=t;return a===Oe?!0:v?v(B,this):R.unsafe(this,c).is0()}clearCofactor(){let{clearCofactor:v}=t;return a===Oe?this:v?v(B,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(v=!0){return(0,W._abool2)(v,"isCompressed"),this.assertValidity(),y(B,this,v)}toHex(v=!0){return(0,W.bytesToHex)(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(v=!0){return this.toBytes(v)}_setWindowSize(v){this.precompute(v)}static normalizeZ(v){return(0,Ht.normalizeZ)(B,v)}static msm(v,_){return(0,Ht.pippenger)(B,o,v,_)}static fromPrivateKey(v){return B.BASE.multiply(en(o,v))}}B.BASE=new B(i.Gx,i.Gy,r.ONE),B.ZERO=new B(r.ZERO,r.ONE,r.ZERO),B.Fp=r,B.Fn=o;let O=o.BITS,R=new Ht.wNAF(B,t.endo?Math.ceil(O/2):O);return B.BASE.precompute(8),B}s(Rs,"weierstrassN");function bu(e){return Uint8Array.of(e?2:3)}s(bu,"pprefix");function wu(e,t){let n=e.ORDER,r=ft;for(let h=n-Oe;h%vt===ft;h/=vt)r+=Oe;let o=r,i=vt<<o-Oe-Oe,a=i*vt,c=(n-Oe)/a,u=(c-Oe)/vt,l=a-Oe,f=i,p=e.pow(t,c),d=e.pow(t,(c+Oe)/vt),y=s((h,w)=>{let m=p,x=e.pow(w,l),E=e.sqr(x);E=e.mul(E,w);let S=e.mul(h,E);S=e.pow(S,u),S=e.mul(S,x),x=e.mul(S,w),E=e.mul(S,h);let C=e.mul(E,x);S=e.pow(C,f);let H=e.eql(S,e.ONE);x=e.mul(E,d),S=e.mul(C,m),E=e.cmov(x,E,H),C=e.cmov(S,C,H);for(let q=o;q>Oe;q--){let G=q-vt;G=vt<<G-Oe;let k=e.pow(C,G),B=e.eql(k,e.ONE);x=e.mul(E,m),m=e.mul(m,m),k=e.mul(C,m),E=e.cmov(x,E,B),C=e.cmov(k,C,B)}return{isValid:H,value:E}},"sqrtRatio");if(e.ORDER%Us===Un){let h=(e.ORDER-Un)/Us,w=e.sqrt(e.neg(t));y=s((m,x)=>{let E=e.sqr(x),S=e.mul(m,x);E=e.mul(E,S);let C=e.pow(E,h);C=e.mul(C,S);let H=e.mul(C,w),q=e.mul(e.sqr(C),x),G=e.eql(q,m),k=e.cmov(H,C,G);return{isValid:G,value:k}},"sqrtRatio")}return y}s(wu,"SWUFpSqrtRatio");function Fh(e,t){(0,Rn.validateField)(e);let{A:n,B:r,Z:o}=t;if(!e.isValid(n)||!e.isValid(r)||!e.isValid(o))throw new Error("mapToCurveSimpleSWU: invalid opts");let i=wu(e,o);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let c,u,l,f,p,d,y,h;c=e.sqr(a),c=e.mul(c,o),u=e.sqr(c),u=e.add(u,c),l=e.add(u,e.ONE),l=e.mul(l,r),f=e.cmov(o,e.neg(u),!e.eql(u,e.ZERO)),f=e.mul(f,n),u=e.sqr(l),d=e.sqr(f),p=e.mul(d,n),u=e.add(u,p),u=e.mul(u,l),d=e.mul(d,f),p=e.mul(d,r),u=e.add(u,p),y=e.mul(c,l);let{isValid:w,value:m}=i(u,d);h=e.mul(c,a),h=e.mul(h,m),y=e.cmov(y,l,w),h=e.cmov(h,m,w);let x=e.isOdd(a)===e.isOdd(h);h=e.cmov(e.neg(h),h,x);let E=(0,Rn.FpInvertBatch)(e,[f],!0)[0];return y=e.mul(y,E),{x:y,y:h}}}s(Fh,"mapToCurveSimpleSWU");function xu(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}s(xu,"getWLengths");function Eu(e,t={}){let{Fn:n}=e,r=t.randomBytes||W.randomBytes,o=Object.assign(xu(e.Fp,n),{seed:(0,Rn.getMinHashLength)(n.ORDER)});function i(y){try{return!!en(n,y)}catch{return!1}}s(i,"isValidSecretKey");function a(y,h){let{publicKey:w,publicKeyUncompressed:m}=o;try{let x=y.length;return h===!0&&x!==w||h===!1&&x!==m?!1:!!e.fromBytes(y)}catch{return!1}}s(a,"isValidPublicKey");function c(y=r(o.seed)){return(0,Rn.mapHashToField)((0,W._abytes2)(y,o.seed,"seed"),n.ORDER)}s(c,"randomSecretKey");function u(y,h=!0){return e.BASE.multiply(en(n,y)).toBytes(h)}s(u,"getPublicKey");function l(y){let h=c(y);return{secretKey:h,publicKey:u(h)}}s(l,"keygen");function f(y){if(typeof y=="bigint")return!1;if(y instanceof e)return!0;let{secretKey:h,publicKey:w,publicKeyUncompressed:m}=o;if(n.allowedLengths||h===w)return;let x=(0,W.ensureBytes)("key",y).length;return x===w||x===m}s(f,"isProbPub");function p(y,h,w=!0){if(f(y)===!0)throw new Error("first arg must be private key");if(f(h)===!1)throw new Error("second arg must be public key");let m=en(n,y);return e.fromHex(h).multiply(m).toBytes(w)}return s(p,"getSharedSecret"),Object.freeze({getPublicKey:u,getSharedSecret:p,keygen:l,Point:e,utils:{isValidSecretKey:i,isValidPublicKey:a,randomSecretKey:c,isValidPrivateKey:i,randomPrivateKey:c,normPrivateKeyToScalar:s(y=>en(n,y),"normPrivateKeyToScalar"),precompute(y=8,h=e.BASE){return h.precompute(y,!1)}},lengths:o})}s(Eu,"ecdh");function vu(e,t,n={}){(0,Vh.ahash)(t),(0,W._validateObject)(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=n.randomBytes||W.randomBytes,o=n.hmac||((_,...A)=>(0,kh.hmac)(t,_,(0,W.concatBytes)(...A))),{Fp:i,Fn:a}=e,{ORDER:c,BITS:u}=a,{keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y}=Eu(e,n),h={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function m(_){let A=c>>Oe;return _>A}s(m,"isBiggerThanHalfOrder");function x(_,A){if(!a.isValidNot0(A))throw new Error(`invalid signature ${_}: out of range 1..Point.Fn.ORDER`);return A}s(x,"validateRS");function E(_,A){Ps(A);let P=y.signature,U=A==="compact"?P:A==="recovered"?P+1:void 0;return(0,W._abytes2)(_,U,`${A} signature`)}s(E,"validateSigLength");class S{static{s(this,"Signature")}constructor(A,P,U){this.r=x("r",A),this.s=x("s",P),U!=null&&(this.recovery=U),Object.freeze(this)}static fromBytes(A,P=w){E(A,P);let U;if(P==="der"){let{r:K,s:z}=ge.DER.toSig((0,W._abytes2)(A));return new S(K,z)}P==="recovered"&&(U=A[0],P="compact",A=A.subarray(1));let M=a.BYTES,L=A.subarray(0,M),N=A.subarray(M,M*2);return new S(a.fromBytes(L),a.fromBytes(N),U)}static fromHex(A,P){return this.fromBytes((0,W.hexToBytes)(A),P)}addRecoveryBit(A){return new S(this.r,this.s,A)}recoverPublicKey(A){let P=i.ORDER,{r:U,s:M,recovery:L}=this;if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");if(c*vt<P&&L>1)throw new Error("recovery id is ambiguous for h>1 curve");let K=L===2||L===3?U+c:U;if(!i.isValid(K))throw new Error("recovery id 2 or 3 invalid");let z=i.toBytes(K),se=e.fromBytes((0,W.concatBytes)(bu((L&1)===0),z)),ie=a.inv(K),J=H((0,W.ensureBytes)("msgHash",A)),ue=a.create(-J*ie),he=a.create(M*ie),be=e.BASE.multiplyUnsafe(ue).add(se.multiplyUnsafe(he));if(be.is0())throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return m(this.s)}toBytes(A=w){if(Ps(A),A==="der")return(0,W.hexToBytes)(ge.DER.hexFromSig(this));let P=a.toBytes(this.r),U=a.toBytes(this.s);if(A==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,W.concatBytes)(Uint8Array.of(this.recovery),P,U)}return(0,W.concatBytes)(P,U)}toHex(A){return(0,W.bytesToHex)(this.toBytes(A))}assertValidity(){}static fromCompact(A){return S.fromBytes((0,W.ensureBytes)("sig",A),"compact")}static fromDER(A){return S.fromBytes((0,W.ensureBytes)("sig",A),"der")}normalizeS(){return this.hasHighS()?new S(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,W.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,W.bytesToHex)(this.toBytes("compact"))}}let C=n.bits2int||s(function(A){if(A.length>8192)throw new Error("input is too large");let P=(0,W.bytesToNumberBE)(A),U=A.length*8-u;return U>0?P>>BigInt(U):P},"bits2int_def"),H=n.bits2int_modN||s(function(A){return a.create(C(A))},"bits2int_modN_def"),q=(0,W.bitMask)(u);function G(_){return(0,W.aInRange)("num < 2^"+u,_,ft,q),a.toBytes(_)}s(G,"int2octets");function k(_,A){return(0,W._abytes2)(_,void 0,"message"),A?(0,W._abytes2)(t(_),void 0,"prehashed message"):_}s(k,"validateMsgAndHash");function B(_,A,P){if(["recovered","canonical"].some(ue=>ue in P))throw new Error("sign() legacy options not supported");let{lowS:U,prehash:M,extraEntropy:L}=Os(P,h);_=k(_,M);let N=H(_),K=en(a,A),z=[G(K),G(N)];if(L!=null&&L!==!1){let ue=L===!0?r(y.secretKey):L;z.push((0,W.ensureBytes)("extraEntropy",ue))}let se=(0,W.concatBytes)(...z),ie=N;function J(ue){let he=C(ue);if(!a.isValidNot0(he))return;let be=a.inv(he),fe=e.BASE.multiply(he).toAffine(),Ie=a.create(fe.x);if(Ie===ft)return;let yn=a.create(be*a.create(ie+Ie*K));if(yn===ft)return;let $n=(fe.x===Ie?0:2)|Number(fe.y&Oe),Zn=yn;return U&&m(yn)&&(Zn=a.neg(yn),$n^=1),new S(Ie,Zn,$n)}return s(J,"k2sig"),{seed:se,k2sig:J}}s(B,"prepSig");function O(_,A,P={}){_=(0,W.ensureBytes)("message",_);let{seed:U,k2sig:M}=B(_,A,P);return(0,W.createHmacDrbg)(t.outputLen,a.BYTES,o)(U,M)}s(O,"sign");function R(_){let A,P=typeof _=="string"||(0,W.isBytes)(_),U=!P&&_!==null&&typeof _=="object"&&typeof _.r=="bigint"&&typeof _.s=="bigint";if(!P&&!U)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(U)A=new S(_.r,_.s);else if(P){try{A=S.fromBytes((0,W.ensureBytes)("sig",_),"der")}catch(M){if(!(M instanceof ge.DER.Err))throw M}if(!A)try{A=S.fromBytes((0,W.ensureBytes)("sig",_),"compact")}catch{return!1}}return A||!1}s(R,"tryParsingSig");function D(_,A,P,U={}){let{lowS:M,prehash:L,format:N}=Os(U,h);if(P=(0,W.ensureBytes)("publicKey",P),A=k((0,W.ensureBytes)("message",A),L),"strict"in U)throw new Error("options.strict was renamed to lowS");let K=N===void 0?R(_):S.fromBytes((0,W.ensureBytes)("sig",_),N);if(K===!1)return!1;try{let z=e.fromBytes(P);if(M&&K.hasHighS())return!1;let{r:se,s:ie}=K,J=H(A),ue=a.inv(ie),he=a.create(J*ue),be=a.create(se*ue),fe=e.BASE.multiplyUnsafe(he).add(z.multiplyUnsafe(be));return fe.is0()?!1:a.create(fe.x)===se}catch{return!1}}s(D,"verify");function v(_,A,P={}){let{prehash:U}=Os(P,h);return A=k(A,U),S.fromBytes(_,"recovered").recoverPublicKey(A).toBytes()}return s(v,"recoverPublicKey"),Object.freeze({keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y,Point:e,sign:O,verify:D,recoverPublicKey:v,Signature:S,hash:t})}s(vu,"ecdsa");function jh(e){let{CURVE:t,curveOpts:n}=_u(e),r=Rs(t,n);return Gh(e,r)}s(jh,"weierstrassPoints");function _u(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,o=(0,Rn.Field)(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),i={Fp:n,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}s(_u,"_weierstrass_legacy_opts_to_new");function zh(e){let{CURVE:t,curveOpts:n}=_u(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}s(zh,"_ecdsa_legacy_opts_to_new");function Su(e,t,n){function r(o){let i=e.sqr(o),a=e.mul(i,o);return e.add(e.add(a,e.mul(o,t)),n)}return s(r,"weierstrassEquation"),r}s(Su,"_legacyHelperEquat");function Gh(e,t){let{Fp:n,Fn:r}=t;function o(a){return(0,W.inRange)(a,Oe,r.ORDER)}s(o,"isWithinCurveOrder");let i=Su(n,e.a,e.b);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:s(a=>en(r,a),"normPrivateKeyToScalar"),weierstrassEquation:i,isWithinCurveOrder:o})}s(Gh,"_weierstrass_new_output_to_legacy");function Wh(e,t){let n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,(0,Rn.nLength)(n.Fn.ORDER,n.Fn.BITS))})}s(Wh,"_ecdsa_new_output_to_legacy");function $h(e){let{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:o}=zh(e),i=Rs(t,n),a=vu(i,r,o);return Wh(e,a)}s($h,"weierstrass")});var Au=re(eo=>{"use strict";g();b();Object.defineProperty(eo,"__esModule",{value:!0});eo.getHash=Yh;eo.createCurve=Qh;var Zh=Ds();function Yh(e){return{hash:e}}s(Yh,"getHash");function Qh(e,t){let n=s(r=>(0,Zh.weierstrass)({...e,hash:r}),"create");return{...n(t),create:n}}s(Qh,"createCurve")});var Du=re(Pe=>{"use strict";g();b();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.encodeToCurve=Pe.hashToCurve=Pe.secp256k1_hasher=Pe.schnorr=Pe.secp256k1=void 0;var to=kr(),Tu=mt(),Xh=Au(),Lu=vs(),Fe=Qt(),Ou=Ds(),et=Nt(),Dn={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Jh={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},ep=BigInt(0),Bu=BigInt(1),Ns=BigInt(2);function tp(e){let t=Dn.p,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),a=BigInt(23),c=BigInt(44),u=BigInt(88),l=e*e*e%t,f=l*l*e%t,p=(0,Fe.pow2)(f,n,t)*f%t,d=(0,Fe.pow2)(p,n,t)*f%t,y=(0,Fe.pow2)(d,Ns,t)*l%t,h=(0,Fe.pow2)(y,o,t)*y%t,w=(0,Fe.pow2)(h,i,t)*h%t,m=(0,Fe.pow2)(w,c,t)*w%t,x=(0,Fe.pow2)(m,u,t)*m%t,E=(0,Fe.pow2)(x,c,t)*w%t,S=(0,Fe.pow2)(E,n,t)*f%t,C=(0,Fe.pow2)(S,a,t)*h%t,H=(0,Fe.pow2)(C,r,t)*l%t,q=(0,Fe.pow2)(H,Ns,t);if(!Kt.eql(Kt.sqr(q),e))throw new Error("Cannot find square root");return q}s(tp,"sqrtMod");var Kt=(0,Fe.Field)(Dn.p,{sqrt:tp});Pe.secp256k1=(0,Xh.createCurve)({...Dn,Fp:Kt,lowS:!0,endo:Jh},to.sha256);var Cu={};function no(e,...t){let n=Cu[e];if(n===void 0){let r=(0,to.sha256)((0,et.utf8ToBytes)(e));n=(0,et.concatBytes)(r,r),Cu[e]=n}return(0,to.sha256)((0,et.concatBytes)(n,...t))}s(no,"taggedHash");var Hs=s(e=>e.toBytes(!0).slice(1),"pointToBytes"),Nn=Pe.secp256k1.Point,Ks=s(e=>e%Ns===ep,"hasEven");function Ms(e){let{Fn:t,BASE:n}=Nn,r=(0,Ou._normFnElement)(t,e),o=n.multiply(r);return{scalar:Ks(o.y)?r:t.neg(r),bytes:Hs(o)}}s(Ms,"schnorrGetExtPubKey");function Pu(e){let t=Kt;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x \u2265 p");let n=t.create(e*e),r=t.create(n*e+BigInt(7)),o=t.sqrt(r);Ks(o)||(o=t.neg(o));let i=Nn.fromAffine({x:e,y:o});return i.assertValidity(),i}s(Pu,"lift_x");var lr=et.bytesToNumberBE;function Uu(...e){return Nn.Fn.create(lr(no("BIP0340/challenge",...e)))}s(Uu,"challenge");function Iu(e){return Ms(e).bytes}s(Iu,"schnorrGetPublicKey");function np(e,t,n=(0,Tu.randomBytes)(32)){let{Fn:r}=Nn,o=(0,et.ensureBytes)("message",e),{bytes:i,scalar:a}=Ms(t),c=(0,et.ensureBytes)("auxRand",n,32),u=r.toBytes(a^lr(no("BIP0340/aux",c))),l=no("BIP0340/nonce",u,i,o),{bytes:f,scalar:p}=Ms(l),d=Uu(f,i,o),y=new Uint8Array(64);if(y.set(f,0),y.set(r.toBytes(r.create(p+d*a)),32),!Ru(y,o,i))throw new Error("sign: Invalid signature produced");return y}s(np,"schnorrSign");function Ru(e,t,n){let{Fn:r,BASE:o}=Nn,i=(0,et.ensureBytes)("signature",e,64),a=(0,et.ensureBytes)("message",t),c=(0,et.ensureBytes)("publicKey",n,32);try{let u=Pu(lr(c)),l=lr(i.subarray(0,32));if(!(0,et.inRange)(l,Bu,Dn.p))return!1;let f=lr(i.subarray(32,64));if(!(0,et.inRange)(f,Bu,Dn.n))return!1;let p=Uu(r.toBytes(l),Hs(u),a),d=o.multiplyUnsafe(f).add(u.multiplyUnsafe(r.neg(p))),{x:y,y:h}=d.toAffine();return!(d.is0()||!Ks(h)||y!==l)}catch{return!1}}s(Ru,"schnorrVerify");Pe.schnorr=(()=>{let n=s((o=(0,Tu.randomBytes)(48))=>(0,Fe.mapHashToField)(o,Dn.n),"randomSecretKey");Pe.secp256k1.utils.randomSecretKey;function r(o){let i=n(o);return{secretKey:i,publicKey:Iu(i)}}return s(r,"keygen"),{keygen:r,getPublicKey:Iu,sign:np,verify:Ru,Point:Nn,utils:{randomSecretKey:n,randomPrivateKey:n,taggedHash:no,lift_x:Pu,pointToBytes:Hs,numberToBytesBE:et.numberToBytesBE,bytesToNumberBE:et.bytesToNumberBE,mod:Fe.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:32*2,seed:48}}})();var rp=(0,Lu.isogenyMap)(Kt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),op=(0,Ou.mapToCurveSimpleSWU)(Kt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Kt.create(BigInt("-11"))});Pe.secp256k1_hasher=(0,Lu.createHasher)(Pe.secp256k1.Point,e=>{let{x:t,y:n}=op(Kt.create(e[0]));return rp(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Kt.ORDER,m:1,k:128,expand:"xmd",hash:to.sha256});Pe.hashToCurve=Pe.secp256k1_hasher.hashToCurve;Pe.encodeToCurve=Pe.secp256k1_hasher.encodeToCurve});var qs=re(fn=>{"use strict";g();b();Object.defineProperty(fn,"__esModule",{value:!0});fn.decodeHex=fn.remove0x=void 0;var sp=Je(),ip=s(function(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e},"remove0x");fn.remove0x=ip;var ap=s(function(e){return(0,sp.hexToBytes)((0,fn.remove0x)(e))},"decodeHex");fn.decodeHex=ap});var Hu=re(je=>{"use strict";g();b();Object.defineProperty(je,"__esModule",{value:!0});je.hexToPublicKey=je.convertPublicKeyFormat=je.getSharedPoint=je.getPublicKey=je.isValidPrivateKey=je.getValidSecret=void 0;var cp=Jo(),Nu=yu(),up=Du(),fr=er(),Mu=Or(),lp=qs(),fp=s(function(e){var t;do t=(0,cp.randomBytes)(Mu.SECRET_KEY_LENGTH);while(!(0,je.isValidPrivateKey)(t,e));return t},"getValidSecret");je.getValidSecret=fp;var dp=s(function(e,t){return dr(t||(0,fr.ellipticCurve)(),function(n){return n.utils.isValidPrivateKey(e)},function(){return!0},function(){return!0})},"isValidPrivateKey");je.isValidPrivateKey=dp;var hp=s(function(e,t){return dr(t||(0,fr.ellipticCurve)(),function(n){return n.getPublicKey(e)},function(n){return n.getPublicKey(e)},function(n){return n.getPublicKey(e)})},"getPublicKey");je.getPublicKey=hp;var pp=s(function(e,t,n,r){return dr(r||(0,fr.ellipticCurve)(),function(o){return o.getSharedSecret(e,t,n)},function(o){return o.getSharedSecret(e,t)},function(o){return bp(o,e,t)})},"getSharedPoint");je.getSharedPoint=pp;var yp=s(function(e,t,n){return dr(n||(0,fr.ellipticCurve)(),function(r){return r.getSharedSecret(BigInt(1),e,t)},function(){return e},function(){return e})},"convertPublicKeyFormat");je.convertPublicKeyFormat=yp;var mp=s(function(e,t){var n=(0,lp.decodeHex)(e);return dr(t||(0,fr.ellipticCurve)(),function(){return gp(n)},function(){return n},function(){return n})},"hexToPublicKey");je.hexToPublicKey=mp;function dr(e,t,n,r){if(e==="secp256k1")return t(up.secp256k1);if(e==="x25519")return n(Nu.x25519);if(e==="ed25519")return r(Nu.ed25519);throw new Error("Not implemented")}s(dr,"_exec");var gp=s(function(e){if(e.length===Mu.ETH_PUBLIC_KEY_SIZE){var t=new Uint8Array(1+e.length);return t.set([4]),t.set(e,1),t}return e},"compatEthPublicKey"),bp=s(function(e,t,n){var r=e.utils.getExtendedPublicKey(t).scalar,o=e.ExtendedPoint.fromHex(n).multiply(r);return o.toRawBytes()},"getSharedPointOnEd25519")});var Fu=re(Hn=>{"use strict";g();b();Object.defineProperty(Hn,"__esModule",{value:!0});Hn.hkdf=void 0;Hn.extract=ku;Hn.expand=Vu;var qu=Ls(),Mn=mt();function ku(e,t,n){return(0,Mn.ahash)(e),n===void 0&&(n=new Uint8Array(e.outputLen)),(0,qu.hmac)(e,(0,Mn.toBytes)(n),(0,Mn.toBytes)(t))}s(ku,"extract");var ks=Uint8Array.from([0]),Ku=Uint8Array.of();function Vu(e,t,n,r=32){(0,Mn.ahash)(e),(0,Mn.anumber)(r);let o=e.outputLen;if(r>255*o)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(r/o);n===void 0&&(n=Ku);let a=new Uint8Array(i*o),c=qu.hmac.create(e,t),u=c._cloneInto(),l=new Uint8Array(c.outputLen);for(let f=0;f<i;f++)ks[0]=f+1,u.update(f===0?Ku:l).update(n).update(ks).digestInto(l),a.set(l,o*f),c._cloneInto(u);return c.destroy(),u.destroy(),(0,Mn.clean)(l,ks),a.slice(0,r)}s(Vu,"expand");var wp=s((e,t,n,r,o)=>Vu(e,ku(e,t,n),r,o),"hkdf");Hn.hkdf=wp});var ju=re(dn=>{"use strict";g();b();Object.defineProperty(dn,"__esModule",{value:!0});dn.getSharedKey=dn.deriveKey=void 0;var xp=Je(),Ep=Fu(),vp=kr(),_p=s(function(e,t,n){return(0,Ep.hkdf)(vp.sha256,e,t,n,32)},"deriveKey");dn.deriveKey=_p;var Sp=s(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,dn.deriveKey)(xp.concatBytes.apply(void 0,e))},"getSharedKey");dn.getSharedKey=Sp});var Wu=re(hn=>{"use strict";g();b();Object.defineProperty(hn,"__esModule",{value:!0});hn.polyval=hn.ghash=void 0;hn._toGHASHKey=zu;var Ee=Je(),qt=16,Fs=new Uint8Array(16),_t=(0,Ee.u32)(Fs),Ap=225,Bp=s((e,t,n,r)=>{let o=r&1;return{s3:n<<31|r>>>1,s2:t<<31|n>>>1,s1:e<<31|t>>>1,s0:e>>>1^Ap<<24&-(o&1)}},"mul2"),nt=s(e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0,"swapLE");function zu(e){e.reverse();let t=e[15]&1,n=0;for(let r=0;r<e.length;r++){let o=e[r];e[r]=o>>>1|n,n=(o&1)<<7}return e[0]^=-t&225,e}s(zu,"_toGHASHKey");var Cp=s(e=>e>64*1024?8:e>1024?4:2,"estimateWindow"),ro=class{static{s(this,"GHASH")}constructor(t,n){this.blockLen=qt,this.outputLen=qt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t,16);let r=(0,Ee.createView)(t),o=r.getUint32(0,!1),i=r.getUint32(4,!1),a=r.getUint32(8,!1),c=r.getUint32(12,!1),u=[];for(let h=0;h<128;h++)u.push({s0:nt(o),s1:nt(i),s2:nt(a),s3:nt(c)}),{s0:o,s1:i,s2:a,s3:c}=Bp(o,i,a,c);let l=Cp(n||1024);if(![1,2,4,8].includes(l))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;let p=128/l,d=this.windowSize=2**l,y=[];for(let h=0;h<p;h++)for(let w=0;w<d;w++){let m=0,x=0,E=0,S=0;for(let C=0;C<l;C++){if(!(w>>>l-C-1&1))continue;let{s0:q,s1:G,s2:k,s3:B}=u[l*h+C];m^=q,x^=G,E^=k,S^=B}y.push({s0:m,s1:x,s2:E,s3:S})}this.t=y}_updateBlock(t,n,r,o){t^=this.s0,n^=this.s1,r^=this.s2,o^=this.s3;let{W:i,t:a,windowSize:c}=this,u=0,l=0,f=0,p=0,d=(1<<i)-1,y=0;for(let h of[t,n,r,o])for(let w=0;w<4;w++){let m=h>>>8*w&255;for(let x=8/i-1;x>=0;x--){let E=m>>>i*x&d,{s0:S,s1:C,s2:H,s3:q}=a[y*c+E];u^=S,l^=C,f^=H,p^=q,y+=1}}this.s0=u,this.s1=l,this.s2=f,this.s3=p}update(t){(0,Ee.aexists)(this),t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let n=(0,Ee.u32)(t),r=Math.floor(t.length/qt),o=t.length%qt;for(let i=0;i<r;i++)this._updateBlock(n[i*4+0],n[i*4+1],n[i*4+2],n[i*4+3]);return o&&(Fs.set(t.subarray(r*qt)),this._updateBlock(_t[0],_t[1],_t[2],_t[3]),(0,Ee.clean)(_t)),this}destroy(){let{t}=this;for(let n of t)n.s0=0,n.s1=0,n.s2=0,n.s3=0}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=n,a[1]=r,a[2]=o,a[3]=i,t}digest(){let t=new Uint8Array(qt);return this.digestInto(t),this.destroy(),t}},Vs=class extends ro{static{s(this,"Polyval")}constructor(t,n){t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let r=zu((0,Ee.copyBytes)(t));super(r,n),(0,Ee.clean)(r)}update(t){t=(0,Ee.toBytes)(t),(0,Ee.aexists)(this);let n=(0,Ee.u32)(t),r=t.length%qt,o=Math.floor(t.length/qt);for(let i=0;i<o;i++)this._updateBlock(nt(n[i*4+3]),nt(n[i*4+2]),nt(n[i*4+1]),nt(n[i*4+0]));return r&&(Fs.set(t.subarray(o*qt)),this._updateBlock(nt(_t[3]),nt(_t[2]),nt(_t[1]),nt(_t[0])),(0,Ee.clean)(_t)),this}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:n,s1:r,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=n,a[1]=r,a[2]=o,a[3]=i,t.reverse()}};function Gu(e){let t=s((r,o)=>e(o,r.length).update((0,Ee.toBytes)(r)).digest(),"hashC"),n=e(new Uint8Array(16),0);return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=(r,o)=>e(r,o),t}s(Gu,"wrapConstructorWithKey");hn.ghash=Gu((e,t)=>new ro(e,t));hn.polyval=Gu((e,t)=>new Vs(e,t))});var al=re(ve=>{"use strict";g();b();Object.defineProperty(ve,"__esModule",{value:!0});ve.unsafe=ve.aeskwp=ve.aeskw=ve.siv=ve.gcmsiv=ve.gcm=ve.cfb=ve.cbc=ve.ecb=ve.ctr=void 0;var zs=Wu(),I=Je(),Xe=16,Ws=4,oo=new Uint8Array(Xe),Ip=283;function $s(e){return e<<1^Ip&-(e>>7)}s($s,"mul2");function Kn(e,t){let n=0;for(;t>0;t>>=1)n^=e&-(t&1),e=$s(e);return n}s(Kn,"mul");var Gs=(()=>{let e=new Uint8Array(256);for(let n=0,r=1;n<256;n++,r^=$s(r))e[n]=r;let t=new Uint8Array(256);t[0]=99;for(let n=0;n<255;n++){let r=e[255-n];r|=r<<8,t[e[n]]=(r^r>>4^r>>5^r>>6^r>>7^99)&255}return(0,I.clean)(e),t})(),Tp=Gs.map((e,t)=>Gs.indexOf(t)),Lp=s(e=>e<<24|e>>>8,"rotr32_8"),js=s(e=>e<<8|e>>>24,"rotl32_8"),io=s(e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255,"byteSwap");function Yu(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let n=new Uint32Array(256).map((l,f)=>t(e[f])),r=n.map(js),o=r.map(js),i=o.map(js),a=new Uint32Array(256*256),c=new Uint32Array(256*256),u=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let f=0;f<256;f++){let p=l*256+f;a[p]=n[l]^r[f],c[p]=o[l]^i[f],u[p]=e[l]<<8|e[f]}return{sbox:e,sbox2:u,T0:n,T1:r,T2:o,T3:i,T01:a,T23:c}}s(Yu,"genTtable");var Zs=Yu(Gs,e=>Kn(e,3)<<24|e<<16|e<<8|Kn(e,2)),Qu=Yu(Tp,e=>Kn(e,11)<<24|Kn(e,13)<<16|Kn(e,9)<<8|Kn(e,14)),Op=(()=>{let e=new Uint8Array(16);for(let t=0,n=1;t<16;t++,n=$s(n))e[t]=n;return e})();function At(e){(0,I.abytes)(e);let t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:n}=Zs,r=[];(0,I.isAligned32)(e)||r.push(e=(0,I.copyBytes)(e));let o=(0,I.u32)(e),i=o.length,a=s(u=>St(n,u,u,u,u),"subByte"),c=new Uint32Array(t+28);c.set(o);for(let u=i;u<c.length;u++){let l=c[u-1];u%i===0?l=a(Lp(l))^Op[u/i-1]:i>6&&u%i===4&&(l=a(l)),c[u]=c[u-i]^l}return(0,I.clean)(...r),c}s(At,"expandKeyLE");function co(e){let t=At(e),n=t.slice(),r=t.length,{sbox2:o}=Zs,{T0:i,T1:a,T2:c,T3:u}=Qu;for(let l=0;l<r;l+=4)for(let f=0;f<4;f++)n[l+f]=t[r-l-4+f];(0,I.clean)(t);for(let l=4;l<r-4;l++){let f=n[l],p=St(o,f,f,f,f);n[l]=i[p&255]^a[p>>>8&255]^c[p>>>16&255]^u[p>>>24]}return n}s(co,"expandKeyDecLE");function tn(e,t,n,r,o,i){return e[n<<8&65280|r>>>8&255]^t[o>>>8&65280|i>>>24&255]}s(tn,"apply0123");function St(e,t,n,r,o){return e[t&255|n&65280]|e[r>>>16&255|o>>>16&65280]<<16}s(St,"applySbox");function ze(e,t,n,r,o){let{sbox2:i,T01:a,T23:c}=Zs,u=0;t^=e[u++],n^=e[u++],r^=e[u++],o^=e[u++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[u++]^tn(a,c,t,n,r,o),m=e[u++]^tn(a,c,n,r,o,t),x=e[u++]^tn(a,c,r,o,t,n),E=e[u++]^tn(a,c,o,t,n,r);t=w,n=m,r=x,o=E}let f=e[u++]^St(i,t,n,r,o),p=e[u++]^St(i,n,r,o,t),d=e[u++]^St(i,r,o,t,n),y=e[u++]^St(i,o,t,n,r);return{s0:f,s1:p,s2:d,s3:y}}s(ze,"encrypt");function hr(e,t,n,r,o){let{sbox2:i,T01:a,T23:c}=Qu,u=0;t^=e[u++],n^=e[u++],r^=e[u++],o^=e[u++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[u++]^tn(a,c,t,o,r,n),m=e[u++]^tn(a,c,n,t,o,r),x=e[u++]^tn(a,c,r,n,t,o),E=e[u++]^tn(a,c,o,r,n,t);t=w,n=m,r=x,o=E}let f=e[u++]^St(i,t,o,r,n),p=e[u++]^St(i,n,t,o,r),d=e[u++]^St(i,r,n,t,o),y=e[u++]^St(i,o,r,n,t);return{s0:f,s1:p,s2:d,s3:y}}s(hr,"decrypt");function Xu(e,t,n,r){(0,I.abytes)(t,Xe),(0,I.abytes)(n);let o=n.length;r=(0,I.getOutput)(o,r),(0,I.complexOverlapBytes)(n,r);let i=t,a=(0,I.u32)(i),{s0:c,s1:u,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]),p=(0,I.u32)(n),d=(0,I.u32)(r);for(let h=0;h+4<=p.length;h+=4){d[h+0]=p[h+0]^c,d[h+1]=p[h+1]^u,d[h+2]=p[h+2]^l,d[h+3]=p[h+3]^f;let w=1;for(let m=i.length-1;m>=0;m--)w=w+(i[m]&255)|0,i[m]=w&255,w>>>=8;({s0:c,s1:u,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]))}let y=Xe*Math.floor(p.length/Ws);if(y<o){let h=new Uint32Array([c,u,l,f]),w=(0,I.u8)(h);for(let m=y,x=0;m<o;m++,x++)r[m]=n[m]^w[x];(0,I.clean)(h)}return r}s(Xu,"ctrCounter");function qn(e,t,n,r,o){(0,I.abytes)(n,Xe),(0,I.abytes)(r),o=(0,I.getOutput)(r.length,o);let i=n,a=(0,I.u32)(i),c=(0,I.createView)(i),u=(0,I.u32)(r),l=(0,I.u32)(o),f=t?0:12,p=r.length,d=c.getUint32(f,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);for(let E=0;E+4<=u.length;E+=4)l[E+0]=u[E+0]^y,l[E+1]=u[E+1]^h,l[E+2]=u[E+2]^w,l[E+3]=u[E+3]^m,d=d+1>>>0,c.setUint32(f,d,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);let x=Xe*Math.floor(u.length/Ws);if(x<p){let E=new Uint32Array([y,h,w,m]),S=(0,I.u8)(E);for(let C=x,H=0;C<p;C++,H++)o[C]=r[C]^S[H];(0,I.clean)(E)}return o}s(qn,"ctr32");ve.ctr=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n){function r(o,i){if((0,I.abytes)(o),i!==void 0&&((0,I.abytes)(i),!(0,I.isAligned32)(i)))throw new Error("unaligned destination");let a=At(t),c=(0,I.copyBytes)(n),u=[a,c];(0,I.isAligned32)(o)||u.push(o=(0,I.copyBytes)(o));let l=Xu(a,c,o,i);return(0,I.clean)(...u),l}return s(r,"processCtr"),{encrypt:s((o,i)=>r(o,i),"encrypt"),decrypt:s((o,i)=>r(o,i),"decrypt")}},"aesctr"));function Ju(e){if((0,I.abytes)(e),e.length%Xe!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+Xe)}s(Ju,"validateBlockDecrypt");function el(e,t,n){(0,I.abytes)(e);let r=e.length,o=r%Xe;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,I.isAligned32)(e)||(e=(0,I.copyBytes)(e));let i=(0,I.u32)(e);if(t){let c=Xe-o;c||(c=Xe),r=r+c}n=(0,I.getOutput)(r,n),(0,I.complexOverlapBytes)(e,n);let a=(0,I.u32)(n);return{b:i,o:a,out:n}}s(el,"validateBlockEncrypt");function tl(e,t){if(!t)return e;let n=e.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");let r=e[n-1];if(r<=0||r>16)throw new Error("aes/pcks5: wrong padding");let o=e.subarray(0,-r);for(let i=0;i<r;i++)if(e[n-i-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}s(tl,"validatePCKS");function nl(e){let t=new Uint8Array(16),n=(0,I.u32)(t);t.set(e);let r=Xe-e.length;for(let o=Xe-r;o<Xe;o++)t[o]=r;return n}s(nl,"padPCKS");ve.ecb=(0,I.wrapCipher)({blockSize:16},s(function(t,n={}){let r=!n.disablePadding;return{encrypt(o,i){let{b:a,o:c,out:u}=el(o,r,i),l=At(t),f=0;for(;f+4<=a.length;){let{s0:p,s1:d,s2:y,s3:h}=ze(l,a[f+0],a[f+1],a[f+2],a[f+3]);c[f++]=p,c[f++]=d,c[f++]=y,c[f++]=h}if(r){let p=nl(o.subarray(f*4)),{s0:d,s1:y,s2:h,s3:w}=ze(l,p[0],p[1],p[2],p[3]);c[f++]=d,c[f++]=y,c[f++]=h,c[f++]=w}return(0,I.clean)(l),u},decrypt(o,i){Ju(o);let a=co(t);i=(0,I.getOutput)(o.length,i);let c=[a];(0,I.isAligned32)(o)||c.push(o=(0,I.copyBytes)(o)),(0,I.complexOverlapBytes)(o,i);let u=(0,I.u32)(o),l=(0,I.u32)(i);for(let f=0;f+4<=u.length;){let{s0:p,s1:d,s2:y,s3:h}=hr(a,u[f+0],u[f+1],u[f+2],u[f+3]);l[f++]=p,l[f++]=d,l[f++]=y,l[f++]=h}return(0,I.clean)(...c),tl(i,r)}}},"aesecb"));ve.cbc=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n,r={}){let o=!r.disablePadding;return{encrypt(i,a){let c=At(t),{b:u,o:l,out:f}=el(i,o,a),p=n,d=[c];(0,I.isAligned32)(p)||d.push(p=(0,I.copyBytes)(p));let y=(0,I.u32)(p),h=y[0],w=y[1],m=y[2],x=y[3],E=0;for(;E+4<=u.length;)h^=u[E+0],w^=u[E+1],m^=u[E+2],x^=u[E+3],{s0:h,s1:w,s2:m,s3:x}=ze(c,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x;if(o){let S=nl(i.subarray(E*4));h^=S[0],w^=S[1],m^=S[2],x^=S[3],{s0:h,s1:w,s2:m,s3:x}=ze(c,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x}return(0,I.clean)(...d),f},decrypt(i,a){Ju(i);let c=co(t),u=n,l=[c];(0,I.isAligned32)(u)||l.push(u=(0,I.copyBytes)(u));let f=(0,I.u32)(u);a=(0,I.getOutput)(i.length,a),(0,I.isAligned32)(i)||l.push(i=(0,I.copyBytes)(i)),(0,I.complexOverlapBytes)(i,a);let p=(0,I.u32)(i),d=(0,I.u32)(a),y=f[0],h=f[1],w=f[2],m=f[3];for(let x=0;x+4<=p.length;){let E=y,S=h,C=w,H=m;y=p[x+0],h=p[x+1],w=p[x+2],m=p[x+3];let{s0:q,s1:G,s2:k,s3:B}=hr(c,y,h,w,m);d[x++]=q^E,d[x++]=G^S,d[x++]=k^C,d[x++]=B^H}return(0,I.clean)(...l),tl(a,o)}}},"aescbc"));ve.cfb=(0,I.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,n){function r(o,i,a){(0,I.abytes)(o);let c=o.length;if(a=(0,I.getOutput)(c,a),(0,I.overlapBytes)(o,a))throw new Error("overlapping src and dst not supported.");let u=At(t),l=n,f=[u];(0,I.isAligned32)(l)||f.push(l=(0,I.copyBytes)(l)),(0,I.isAligned32)(o)||f.push(o=(0,I.copyBytes)(o));let p=(0,I.u32)(o),d=(0,I.u32)(a),y=i?d:p,h=(0,I.u32)(l),w=h[0],m=h[1],x=h[2],E=h[3];for(let C=0;C+4<=p.length;){let{s0:H,s1:q,s2:G,s3:k}=ze(u,w,m,x,E);d[C+0]=p[C+0]^H,d[C+1]=p[C+1]^q,d[C+2]=p[C+2]^G,d[C+3]=p[C+3]^k,w=y[C++],m=y[C++],x=y[C++],E=y[C++]}let S=Xe*Math.floor(p.length/Ws);if(S<c){({s0:w,s1:m,s2:x,s3:E}=ze(u,w,m,x,E));let C=(0,I.u8)(new Uint32Array([w,m,x,E]));for(let H=S,q=0;H<c;H++,q++)a[H]=o[H]^C[q];(0,I.clean)(C)}return(0,I.clean)(...f),a}return s(r,"processCfb"),{encrypt:s((o,i)=>r(o,!0,i),"encrypt"),decrypt:s((o,i)=>r(o,!1,i),"decrypt")}},"aescfb"));function rl(e,t,n,r,o){let i=o?o.length:0,a=e.create(n,r.length+i);o&&a.update(o);let c=(0,I.u64Lengths)(8*r.length,8*i,t);a.update(r),a.update(c);let u=a.digest();return(0,I.clean)(c),u}s(rl,"computeTag");ve.gcm=(0,I.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,n,r){if(n.length<8)throw new Error("aes/gcm: invalid nonce length");let o=16;function i(c,u,l){let f=rl(zs.ghash,!1,c,l,r);for(let p=0;p<u.length;p++)f[p]^=u[p];return f}s(i,"_computeTag");function a(){let c=At(t),u=oo.slice(),l=oo.slice();if(qn(c,!1,l,l,u),n.length===12)l.set(n);else{let p=oo.slice(),d=(0,I.createView)(p);(0,I.setBigUint64)(d,8,BigInt(n.length*8),!1);let y=zs.ghash.create(u).update(n).update(p);y.digestInto(l),y.destroy()}let f=qn(c,!1,l,oo);return{xk:c,authKey:u,counter:l,tagMask:f}}return s(a,"deriveKeys"),{encrypt(c){let{xk:u,authKey:l,counter:f,tagMask:p}=a(),d=new Uint8Array(c.length+o),y=[u,l,f,p];(0,I.isAligned32)(c)||y.push(c=(0,I.copyBytes)(c)),qn(u,!1,f,c,d.subarray(0,c.length));let h=i(l,p,d.subarray(0,d.length-o));return y.push(h),d.set(h,c.length),(0,I.clean)(...y),d},decrypt(c){let{xk:u,authKey:l,counter:f,tagMask:p}=a(),d=[u,l,p,f];(0,I.isAligned32)(c)||d.push(c=(0,I.copyBytes)(c));let y=c.subarray(0,-o),h=c.subarray(-o),w=i(l,p,y);if(d.push(w),!(0,I.equalBytes)(w,h))throw new Error("aes/gcm: invalid ghash tag");let m=qn(u,!1,f,y);return(0,I.clean)(...d),m}}},"aesgcm"));var so=s((e,t,n)=>r=>{if(!Number.isSafeInteger(r)||t>r||r>n){let o="["+t+".."+n+"]";throw new Error(""+e+": expected value in range "+o+", got "+r)}},"limit");ve.gcmsiv=(0,I.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,n,r){let i=so("AAD",0,68719476736),a=so("plaintext",0,2**36),c=so("nonce",12,12),u=so("ciphertext",16,2**36+16);(0,I.abytes)(t,16,24,32),c(n.length),r!==void 0&&i(r.length);function l(){let d=At(t),y=new Uint8Array(t.length),h=new Uint8Array(16),w=[d,y],m=n;(0,I.isAligned32)(m)||w.push(m=(0,I.copyBytes)(m));let x=(0,I.u32)(m),E=0,S=x[0],C=x[1],H=x[2],q=0;for(let k of[h,y].map(I.u32)){let B=(0,I.u32)(k);for(let O=0;O<B.length;O+=2){let{s0:R,s1:D}=ze(d,E,S,C,H);B[O+0]=R,B[O+1]=D,E=++q}}let G={authKey:h,encKey:At(y)};return(0,I.clean)(...w),G}s(l,"deriveKeys");function f(d,y,h){let w=rl(zs.polyval,!0,y,h,r);for(let H=0;H<12;H++)w[H]^=n[H];w[15]&=127;let m=(0,I.u32)(w),x=m[0],E=m[1],S=m[2],C=m[3];return{s0:x,s1:E,s2:S,s3:C}=ze(d,x,E,S,C),m[0]=x,m[1]=E,m[2]=S,m[3]=C,w}s(f,"_computeTag");function p(d,y,h){let w=(0,I.copyBytes)(y);w[15]|=128;let m=qn(d,!0,w,h);return(0,I.clean)(w),m}return s(p,"processSiv"),{encrypt(d){a(d.length);let{encKey:y,authKey:h}=l(),w=f(y,h,d),m=[y,h,w];(0,I.isAligned32)(d)||m.push(d=(0,I.copyBytes)(d));let x=new Uint8Array(d.length+16);return x.set(w,d.length),x.set(p(y,w,d)),(0,I.clean)(...m),x},decrypt(d){u(d.length);let y=d.subarray(-16),{encKey:h,authKey:w}=l(),m=[h,w];(0,I.isAligned32)(d)||m.push(d=(0,I.copyBytes)(d));let x=p(h,y,d.subarray(0,-16)),E=f(h,w,x);if(m.push(E),!(0,I.equalBytes)(y,E))throw(0,I.clean)(...m),new Error("invalid polyval tag");return(0,I.clean)(...m),x}}},"aessiv"));ve.siv=ve.gcmsiv;function ol(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint32Array"}s(ol,"isBytes32");function sl(e,t){if((0,I.abytes)(t,16),!ol(e))throw new Error("_encryptBlock accepts result of expandKeyLE");let n=(0,I.u32)(t),{s0:r,s1:o,s2:i,s3:a}=ze(e,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=o,n[2]=i,n[3]=a,t}s(sl,"encryptBlock");function il(e,t){if((0,I.abytes)(t,16),!ol(e))throw new Error("_decryptBlock accepts result of expandKeyLE");let n=(0,I.u32)(t),{s0:r,s1:o,s2:i,s3:a}=hr(e,n[0],n[1],n[2],n[3]);return n[0]=r,n[1]=o,n[2]=i,n[3]=a,t}s(il,"decryptBlock");var ao={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");let n=At(e);if(t.length===16)sl(n,t);else{let r=(0,I.u32)(t),o=r[0],i=r[1];for(let a=0,c=1;a<6;a++)for(let u=2;u<r.length;u+=2,c++){let{s0:l,s1:f,s2:p,s3:d}=ze(n,o,i,r[u],r[u+1]);o=l,i=f^io(c),r[u]=p,r[u+1]=d}r[0]=o,r[1]=i}n.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");let n=co(e),r=t.length/8-1;if(r===1)il(n,t);else{let o=(0,I.u32)(t),i=o[0],a=o[1];for(let c=0,u=r*6;c<6;c++)for(let l=r*2;l>=1;l-=2,u--){a^=io(u);let{s0:f,s1:p,s2:d,s3:y}=hr(n,i,a,o[l],o[l+1]);i=f,a=p,o[l]=d,o[l+1]=y}o[0]=i,o[1]=a}n.fill(0)}},$u=new Uint8Array(8).fill(166);ve.aeskw=(0,I.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!==0)throw new Error("invalid plaintext length");if(t.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");let n=(0,I.concatBytes)($u,t);return ao.encrypt(e,n),n},decrypt(t){if(t.length%8!==0||t.length<3*8)throw new Error("invalid ciphertext length");let n=(0,I.copyBytes)(t);if(ao.decrypt(e,n),!(0,I.equalBytes)(n.subarray(0,8),$u))throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8)}}));var Zu=2790873510;ve.aeskwp=(0,I.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");let n=Math.ceil(t.length/8)*8,r=new Uint8Array(8+n);r.set(t,8);let o=(0,I.u32)(r);return o[0]=Zu,o[1]=io(t.length),ao.encrypt(e,r),r},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");let n=(0,I.copyBytes)(t),r=(0,I.u32)(n);ao.decrypt(e,n);let o=io(r[1])>>>0,i=Math.ceil(o/8)*8;if(r[0]!==Zu||n.length-8!==i)throw new Error("integrity check failed");for(let a=o;a<i;a++)if(n[8+a]!==0)throw new Error("integrity check failed");return n.subarray(0,8).fill(0),n.subarray(8,8+o)}}));ve.unsafe={expandKeyLE:At,expandKeyDecLE:co,encrypt:ze,decrypt:hr,encryptBlock:sl,decryptBlock:il,ctrCounter:Xu,ctr32:qn}});var ul=re(kn=>{"use strict";g();b();Object.defineProperty(kn,"__esModule",{value:!0});kn.aes256cbc=kn.aes256gcm=void 0;var cl=al(),Pp=s(function(e,t,n){return(0,cl.gcm)(e,t,n)},"aes256gcm");kn.aes256gcm=Pp;var Up=s(function(e,t,n){return(0,cl.cbc)(e,t)},"aes256cbc");kn.aes256cbc=Up});var hl=re(lo=>{"use strict";g();b();Object.defineProperty(lo,"__esModule",{value:!0});lo.rotl=Hp;lo.createCipher=kp;var Ae=Je(),fl=s(e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),"_utf8ToBytes"),Rp=fl("expand 16-byte k"),Dp=fl("expand 32-byte k"),Np=(0,Ae.u32)(Rp),Mp=(0,Ae.u32)(Dp);function Hp(e,t){return e<<t|e>>>32-t}s(Hp,"rotl");function Ys(e){return e.byteOffset%4===0}s(Ys,"isAligned32");var uo=64,Kp=16,dl=2**32-1,ll=new Uint32Array;function qp(e,t,n,r,o,i,a,c){let u=o.length,l=new Uint8Array(uo),f=(0,Ae.u32)(l),p=Ys(o)&&Ys(i),d=p?(0,Ae.u32)(o):ll,y=p?(0,Ae.u32)(i):ll;for(let h=0;h<u;a++){if(e(t,n,r,f,a,c),a>=dl)throw new Error("arx: counter overflow");let w=Math.min(uo,u-h);if(p&&w===uo){let m=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let x=0,E;x<Kp;x++)E=m+x,y[E]=d[E]^f[x];h+=uo;continue}for(let m=0,x;m<w;m++)x=h+m,i[x]=o[x]^l[m];h+=w}}s(qp,"runCipher");function kp(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:a}=(0,Ae.checkOpts)({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return(0,Ae.anumber)(o),(0,Ae.anumber)(a),(0,Ae.abool)(i),(0,Ae.abool)(n),(c,u,l,f,p=0)=>{(0,Ae.abytes)(c),(0,Ae.abytes)(u),(0,Ae.abytes)(l);let d=l.length;if(f===void 0&&(f=new Uint8Array(d)),(0,Ae.abytes)(f),(0,Ae.anumber)(p),p<0||p>=dl)throw new Error("arx: counter overflow");if(f.length<d)throw new Error(`arx: output (${f.length}) is shorter than data (${d})`);let y=[],h=c.length,w,m;if(h===32)y.push(w=(0,Ae.copyBytes)(c)),m=Mp;else if(h===16&&n)w=new Uint8Array(32),w.set(c),w.set(c,16),m=Np,y.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);Ys(u)||y.push(u=(0,Ae.copyBytes)(u));let x=(0,Ae.u32)(w);if(r){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,x,(0,Ae.u32)(u.subarray(0,16)),x),u=u.subarray(16)}let E=16-o;if(E!==u.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let C=new Uint8Array(12);C.set(u,i?0:12-u.length),u=C,y.push(u)}let S=(0,Ae.u32)(u);return qp(e,m,x,S,l,f,p,a),(0,Ae.clean)(...y),f}}s(kp,"createCipher")});var yl=re(pr=>{"use strict";g();b();Object.defineProperty(pr,"__esModule",{value:!0});pr.poly1305=void 0;pr.wrapConstructorWithKey=pl;var Bt=Je(),Ue=s((e,t)=>e[t++]&255|(e[t++]&255)<<8,"u8to16"),Qs=class{static{s(this,"Poly1305")}constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=(0,Bt.toBytes)(t),(0,Bt.abytes)(t,32);let n=Ue(t,0),r=Ue(t,2),o=Ue(t,4),i=Ue(t,6),a=Ue(t,8),c=Ue(t,10),u=Ue(t,12),l=Ue(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|c<<2)&8191,this.r[7]=(c>>>11|u<<5)&8065,this.r[8]=(u>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let f=0;f<8;f++)this.pad[f]=Ue(t,16+2*f)}process(t,n,r=!1){let o=r?0:2048,{h:i,r:a}=this,c=a[0],u=a[1],l=a[2],f=a[3],p=a[4],d=a[5],y=a[6],h=a[7],w=a[8],m=a[9],x=Ue(t,n+0),E=Ue(t,n+2),S=Ue(t,n+4),C=Ue(t,n+6),H=Ue(t,n+8),q=Ue(t,n+10),G=Ue(t,n+12),k=Ue(t,n+14),B=i[0]+(x&8191),O=i[1]+((x>>>13|E<<3)&8191),R=i[2]+((E>>>10|S<<6)&8191),D=i[3]+((S>>>7|C<<9)&8191),v=i[4]+((C>>>4|H<<12)&8191),_=i[5]+(H>>>1&8191),A=i[6]+((H>>>14|q<<2)&8191),P=i[7]+((q>>>11|G<<5)&8191),U=i[8]+((G>>>8|k<<8)&8191),M=i[9]+(k>>>5|o),L=0,N=L+B*c+O*(5*m)+R*(5*w)+D*(5*h)+v*(5*y);L=N>>>13,N&=8191,N+=_*(5*d)+A*(5*p)+P*(5*f)+U*(5*l)+M*(5*u),L+=N>>>13,N&=8191;let K=L+B*u+O*c+R*(5*m)+D*(5*w)+v*(5*h);L=K>>>13,K&=8191,K+=_*(5*y)+A*(5*d)+P*(5*p)+U*(5*f)+M*(5*l),L+=K>>>13,K&=8191;let z=L+B*l+O*u+R*c+D*(5*m)+v*(5*w);L=z>>>13,z&=8191,z+=_*(5*h)+A*(5*y)+P*(5*d)+U*(5*p)+M*(5*f),L+=z>>>13,z&=8191;let se=L+B*f+O*l+R*u+D*c+v*(5*m);L=se>>>13,se&=8191,se+=_*(5*w)+A*(5*h)+P*(5*y)+U*(5*d)+M*(5*p),L+=se>>>13,se&=8191;let ie=L+B*p+O*f+R*l+D*u+v*c;L=ie>>>13,ie&=8191,ie+=_*(5*m)+A*(5*w)+P*(5*h)+U*(5*y)+M*(5*d),L+=ie>>>13,ie&=8191;let J=L+B*d+O*p+R*f+D*l+v*u;L=J>>>13,J&=8191,J+=_*c+A*(5*m)+P*(5*w)+U*(5*h)+M*(5*y),L+=J>>>13,J&=8191;let ue=L+B*y+O*d+R*p+D*f+v*l;L=ue>>>13,ue&=8191,ue+=_*u+A*c+P*(5*m)+U*(5*w)+M*(5*h),L+=ue>>>13,ue&=8191;let he=L+B*h+O*y+R*d+D*p+v*f;L=he>>>13,he&=8191,he+=_*l+A*u+P*c+U*(5*m)+M*(5*w),L+=he>>>13,he&=8191;let be=L+B*w+O*h+R*y+D*d+v*p;L=be>>>13,be&=8191,be+=_*f+A*l+P*u+U*c+M*(5*m),L+=be>>>13,be&=8191;let fe=L+B*m+O*w+R*h+D*y+v*d;L=fe>>>13,fe&=8191,fe+=_*p+A*f+P*l+U*u+M*c,L+=fe>>>13,fe&=8191,L=(L<<2)+L|0,L=L+N|0,N=L&8191,L=L>>>13,K+=L,i[0]=N,i[1]=K,i[2]=z,i[3]=se,i[4]=ie,i[5]=J,i[6]=ue,i[7]=he,i[8]=be,i[9]=fe}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let i=(o^1)-1;for(let c=0;c<10;c++)r[c]&=i;i=~i;for(let c=0;c<10;c++)t[c]=t[c]&i|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+n[0];t[0]=a&65535;for(let c=1;c<8;c++)a=(t[c]+n[c]|0)+(a>>>16)|0,t[c]=a&65535;(0,Bt.clean)(r)}update(t){(0,Bt.aexists)(this),t=(0,Bt.toBytes)(t),(0,Bt.abytes)(t);let{buffer:n,blockLen:r}=this,o=t.length;for(let i=0;i<o;){let a=Math.min(r-this.pos,o-i);if(a===r){for(;r<=o-i;i+=r)this.process(t,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){(0,Bt.clean)(this.h,this.r,this.buffer,this.pad)}digestInto(t){(0,Bt.aexists)(this),(0,Bt.aoutput)(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)t[i++]=r[a]>>>0,t[i++]=r[a]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function pl(e){let t=s((r,o)=>e(o).update((0,Bt.toBytes)(r)).digest(),"hashC"),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}s(pl,"wrapConstructorWithKey");pr.poly1305=pl(e=>new Qs(e))});var wl=re(_e=>{"use strict";g();b();Object.defineProperty(_e,"__esModule",{value:!0});_e.xchacha20poly1305=_e.chacha20poly1305=_e._poly1305_aead=_e.chacha12=_e.chacha8=_e.xchacha20=_e.chacha20=_e.chacha20orig=void 0;_e.hchacha=bl;var j=hl(),Vp=yl(),kt=Je();function yr(e,t,n,r,o,i=20){let a=e[0],c=e[1],u=e[2],l=e[3],f=t[0],p=t[1],d=t[2],y=t[3],h=t[4],w=t[5],m=t[6],x=t[7],E=o,S=n[0],C=n[1],H=n[2],q=a,G=c,k=u,B=l,O=f,R=p,D=d,v=y,_=h,A=w,P=m,U=x,M=E,L=S,N=C,K=H;for(let se=0;se<i;se+=2)q=q+O|0,M=(0,j.rotl)(M^q,16),_=_+M|0,O=(0,j.rotl)(O^_,12),q=q+O|0,M=(0,j.rotl)(M^q,8),_=_+M|0,O=(0,j.rotl)(O^_,7),G=G+R|0,L=(0,j.rotl)(L^G,16),A=A+L|0,R=(0,j.rotl)(R^A,12),G=G+R|0,L=(0,j.rotl)(L^G,8),A=A+L|0,R=(0,j.rotl)(R^A,7),k=k+D|0,N=(0,j.rotl)(N^k,16),P=P+N|0,D=(0,j.rotl)(D^P,12),k=k+D|0,N=(0,j.rotl)(N^k,8),P=P+N|0,D=(0,j.rotl)(D^P,7),B=B+v|0,K=(0,j.rotl)(K^B,16),U=U+K|0,v=(0,j.rotl)(v^U,12),B=B+v|0,K=(0,j.rotl)(K^B,8),U=U+K|0,v=(0,j.rotl)(v^U,7),q=q+R|0,K=(0,j.rotl)(K^q,16),P=P+K|0,R=(0,j.rotl)(R^P,12),q=q+R|0,K=(0,j.rotl)(K^q,8),P=P+K|0,R=(0,j.rotl)(R^P,7),G=G+D|0,M=(0,j.rotl)(M^G,16),U=U+M|0,D=(0,j.rotl)(D^U,12),G=G+D|0,M=(0,j.rotl)(M^G,8),U=U+M|0,D=(0,j.rotl)(D^U,7),k=k+v|0,L=(0,j.rotl)(L^k,16),_=_+L|0,v=(0,j.rotl)(v^_,12),k=k+v|0,L=(0,j.rotl)(L^k,8),_=_+L|0,v=(0,j.rotl)(v^_,7),B=B+O|0,N=(0,j.rotl)(N^B,16),A=A+N|0,O=(0,j.rotl)(O^A,12),B=B+O|0,N=(0,j.rotl)(N^B,8),A=A+N|0,O=(0,j.rotl)(O^A,7);let z=0;r[z++]=a+q|0,r[z++]=c+G|0,r[z++]=u+k|0,r[z++]=l+B|0,r[z++]=f+O|0,r[z++]=p+R|0,r[z++]=d+D|0,r[z++]=y+v|0,r[z++]=h+_|0,r[z++]=w+A|0,r[z++]=m+P|0,r[z++]=x+U|0,r[z++]=E+M|0,r[z++]=S+L|0,r[z++]=C+N|0,r[z++]=H+K|0}s(yr,"chachaCore");function bl(e,t,n,r){let o=e[0],i=e[1],a=e[2],c=e[3],u=t[0],l=t[1],f=t[2],p=t[3],d=t[4],y=t[5],h=t[6],w=t[7],m=n[0],x=n[1],E=n[2],S=n[3];for(let H=0;H<20;H+=2)o=o+u|0,m=(0,j.rotl)(m^o,16),d=d+m|0,u=(0,j.rotl)(u^d,12),o=o+u|0,m=(0,j.rotl)(m^o,8),d=d+m|0,u=(0,j.rotl)(u^d,7),i=i+l|0,x=(0,j.rotl)(x^i,16),y=y+x|0,l=(0,j.rotl)(l^y,12),i=i+l|0,x=(0,j.rotl)(x^i,8),y=y+x|0,l=(0,j.rotl)(l^y,7),a=a+f|0,E=(0,j.rotl)(E^a,16),h=h+E|0,f=(0,j.rotl)(f^h,12),a=a+f|0,E=(0,j.rotl)(E^a,8),h=h+E|0,f=(0,j.rotl)(f^h,7),c=c+p|0,S=(0,j.rotl)(S^c,16),w=w+S|0,p=(0,j.rotl)(p^w,12),c=c+p|0,S=(0,j.rotl)(S^c,8),w=w+S|0,p=(0,j.rotl)(p^w,7),o=o+l|0,S=(0,j.rotl)(S^o,16),h=h+S|0,l=(0,j.rotl)(l^h,12),o=o+l|0,S=(0,j.rotl)(S^o,8),h=h+S|0,l=(0,j.rotl)(l^h,7),i=i+f|0,m=(0,j.rotl)(m^i,16),w=w+m|0,f=(0,j.rotl)(f^w,12),i=i+f|0,m=(0,j.rotl)(m^i,8),w=w+m|0,f=(0,j.rotl)(f^w,7),a=a+p|0,x=(0,j.rotl)(x^a,16),d=d+x|0,p=(0,j.rotl)(p^d,12),a=a+p|0,x=(0,j.rotl)(x^a,8),d=d+x|0,p=(0,j.rotl)(p^d,7),c=c+u|0,E=(0,j.rotl)(E^c,16),y=y+E|0,u=(0,j.rotl)(u^y,12),c=c+u|0,E=(0,j.rotl)(E^c,8),y=y+E|0,u=(0,j.rotl)(u^y,7);let C=0;r[C++]=o,r[C++]=i,r[C++]=a,r[C++]=c,r[C++]=m,r[C++]=x,r[C++]=E,r[C++]=S}s(bl,"hchacha");_e.chacha20orig=(0,j.createCipher)(yr,{counterRight:!1,counterLength:8,allowShortKeys:!0});_e.chacha20=(0,j.createCipher)(yr,{counterRight:!1,counterLength:4,allowShortKeys:!1});_e.xchacha20=(0,j.createCipher)(yr,{counterRight:!1,counterLength:8,extendNonceFn:bl,allowShortKeys:!1});_e.chacha8=(0,j.createCipher)(yr,{counterRight:!1,counterLength:4,rounds:8});_e.chacha12=(0,j.createCipher)(yr,{counterRight:!1,counterLength:4,rounds:12});var Fp=new Uint8Array(16),ml=s((e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Fp.subarray(n))},"updatePadded"),jp=new Uint8Array(32);function gl(e,t,n,r,o){let i=e(t,n,jp),a=Vp.poly1305.create(i);o&&ml(a,o),ml(a,r);let c=(0,kt.u64Lengths)(r.length,o?o.length:0,!0);a.update(c);let u=a.digest();return(0,kt.clean)(i,c),u}s(gl,"computeTag");var zp=s(e=>(t,n,r)=>({encrypt(i,a){let c=i.length;a=(0,kt.getOutput)(c+16,a,!1),a.set(i);let u=a.subarray(0,-16);e(t,n,u,u,1);let l=gl(e,t,n,u,r);return a.set(l,c),(0,kt.clean)(l),a},decrypt(i,a){a=(0,kt.getOutput)(i.length-16,a,!1);let c=i.subarray(0,-16),u=i.subarray(-16),l=gl(e,t,n,c,r);if(!(0,kt.equalBytes)(u,l))throw new Error("invalid tag");return a.set(i.subarray(0,-16)),e(t,n,a,a,1),(0,kt.clean)(l),a}}),"_poly1305_aead");_e._poly1305_aead=zp;_e.chacha20poly1305=(0,kt.wrapCipher)({blockSize:64,nonceLength:12,tagLength:16},(0,_e._poly1305_aead)(_e.chacha20));_e.xchacha20poly1305=(0,kt.wrapCipher)({blockSize:64,nonceLength:24,tagLength:16},(0,_e._poly1305_aead)(_e.xchacha20))});var El=re(Vn=>{"use strict";g();b();Object.defineProperty(Vn,"__esModule",{value:!0});Vn.chacha20=Vn.xchacha20=void 0;var xl=wl(),Gp=s(function(e,t,n){return(0,xl.xchacha20poly1305)(e,t,n)},"xchacha20");Vn.xchacha20=Gp;var Wp=s(function(e,t,n){return(0,xl.chacha20poly1305)(e,t,n)},"chacha20");Vn.chacha20=Wp});var Al=re(rt=>{"use strict";g();b();Object.defineProperty(rt,"__esModule",{value:!0});rt.aesDecrypt=rt.aesEncrypt=rt.symDecrypt=rt.symEncrypt=void 0;var Js=Je(),$p=Jo(),vl=ul(),Zp=El(),_l=er(),Xs=Or(),Yp=s(function(e,t,n){return Sl(Xp,e,t,n)},"symEncrypt");rt.symEncrypt=Yp;var Qp=s(function(e,t,n){return Sl(Jp,e,t,n)},"symDecrypt");rt.symDecrypt=Qp;rt.aesEncrypt=rt.symEncrypt;rt.aesDecrypt=rt.symDecrypt;function Sl(e,t,n,r){var o=(0,_l.symmetricAlgorithm)();if(o==="aes-256-gcm")return e(vl.aes256gcm,t,n,(0,_l.symmetricNonceLength)(),Xs.AEAD_TAG_LENGTH,r);if(o==="xchacha20")return e(Zp.xchacha20,t,n,Xs.XCHACHA20_NONCE_LENGTH,Xs.AEAD_TAG_LENGTH,r);if(o==="aes-256-cbc")return e(vl.aes256cbc,t,n,16,0);throw new Error("Not implemented")}s(Sl,"_exec");function Xp(e,t,n,r,o,i){var a=(0,$p.randomBytes)(r),c=e(t,a,i),u=c.encrypt(n);if(o===0)return(0,Js.concatBytes)(a,u);var l=u.length-o,f=u.subarray(0,l),p=u.subarray(l);return(0,Js.concatBytes)(a,p,f)}s(Xp,"_encrypt");function Jp(e,t,n,r,o,i){var a=n.subarray(0,r),c=e(t,Uint8Array.from(a),i),u=n.subarray(r);if(o===0)return c.decrypt(u);var l=u.subarray(0,o),f=u.subarray(o);return c.decrypt((0,Js.concatBytes)(f,l))}s(Jp,"_decrypt")});var ho=re(Ct=>{"use strict";g();b();var ey=Ct&&Ct.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:s(function(){return t[n]},"get")}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),fo=Ct&&Ct.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&ey(t,e,n)};Object.defineProperty(Ct,"__esModule",{value:!0});fo(Hu(),Ct);fo(ju(),Ct);fo(qs(),Ct);fo(Al(),Ct)});var ei=re(yo=>{"use strict";g();b();Object.defineProperty(yo,"__esModule",{value:!0});yo.PublicKey=void 0;var Bl=Je(),po=ho(),ty=function(){function e(t,n){var r=(0,po.convertPublicKeyFormat)(t,!0,n),o=(0,po.convertPublicKeyFormat)(t,!1,n);this.data=r,this.dataUncompressed=r.length!==o.length?o:null}return s(e,"PublicKey"),e.fromHex=function(t,n){return new e((0,po.hexToPublicKey)(t,n),n)},Object.defineProperty(e.prototype,"_uncompressed",{get:s(function(){return this.dataUncompressed!==null?this.dataUncompressed:this.data},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uncompressed",{get:s(function(){return Buffer.from(this._uncompressed)},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"compressed",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toBytes=function(t){return t===void 0&&(t=!0),t?this.data:this._uncompressed},e.prototype.toHex=function(t){return t===void 0&&(t=!0),(0,Bl.bytesToHex)(this.toBytes(t))},e.prototype.decapsulate=function(t,n){n===void 0&&(n=!1);var r=this.toBytes(n),o=t.multiply(this,n);return(0,po.getSharedKey)(r,o)},e.prototype.equals=function(t){return(0,Bl.equalBytes)(this.data,t.data)},e}();yo.PublicKey=ty});var Il=re(mo=>{"use strict";g();b();Object.defineProperty(mo,"__esModule",{value:!0});mo.PrivateKey=void 0;var Cl=Je(),Fn=ho(),ny=ei(),ry=function(){function e(t,n){if(this.curve=n,t===void 0)this.data=(0,Fn.getValidSecret)(n);else if((0,Fn.isValidPrivateKey)(t,n))this.data=t;else throw new Error("Invalid private key");this.publicKey=new ny.PublicKey((0,Fn.getPublicKey)(this.data,n),n)}return s(e,"PrivateKey"),e.fromHex=function(t,n){return new e((0,Fn.decodeHex)(t),n)},Object.defineProperty(e.prototype,"secret",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toHex=function(){return(0,Cl.bytesToHex)(this.data)},e.prototype.encapsulate=function(t,n){n===void 0&&(n=!1);var r=this.publicKey.toBytes(n),o=this.multiply(t,n);return(0,Fn.getSharedKey)(r,o)},e.prototype.multiply=function(t,n){return n===void 0&&(n=!1),(0,Fn.getSharedPoint)(this.data,t.toBytes(!0),n,this.curve)},e.prototype.equals=function(t){return(0,Cl.equalBytes)(this.data,t.data)},e}();mo.PrivateKey=ry});var ti=re(jn=>{"use strict";g();b();Object.defineProperty(jn,"__esModule",{value:!0});jn.PublicKey=jn.PrivateKey=void 0;var oy=Il();Object.defineProperty(jn,"PrivateKey",{enumerable:!0,get:s(function(){return oy.PrivateKey},"get")});var sy=ei();Object.defineProperty(jn,"PublicKey",{enumerable:!0,get:s(function(){return sy.PublicKey},"get")})});var Ll=re(ot=>{"use strict";g();b();Object.defineProperty(ot,"__esModule",{value:!0});ot.utils=ot.PublicKey=ot.PrivateKey=ot.ECIES_CONFIG=void 0;ot.encrypt=ay;ot.decrypt=uy;var iy=Je(),zn=er(),Gn=ti(),Vt=ho();function ay(e,t){return Buffer.from(cy(e,t))}s(ay,"encrypt");function cy(e,t){var n=(0,zn.ellipticCurve)(),r=new Gn.PrivateKey(void 0,n),o=e instanceof Uint8Array?new Gn.PublicKey(e,n):Gn.PublicKey.fromHex(e,n),i=r.encapsulate(o,(0,zn.isHkdfKeyCompressed)()),a=r.publicKey.toBytes((0,zn.isEphemeralKeyCompressed)()),c=(0,Vt.symEncrypt)(i,t);return(0,iy.concatBytes)(a,c)}s(cy,"_encrypt");function uy(e,t){return Buffer.from(ly(e,t))}s(uy,"decrypt");function ly(e,t){var n=(0,zn.ellipticCurve)(),r=e instanceof Uint8Array?new Gn.PrivateKey(e,n):Gn.PrivateKey.fromHex(e,n),o=(0,zn.ephemeralKeySize)(),i=new Gn.PublicKey(t.subarray(0,o),n),a=t.subarray(o),c=i.decapsulate(r,(0,zn.isHkdfKeyCompressed)());return(0,Vt.symDecrypt)(c,a)}s(ly,"_decrypt");var fy=er();Object.defineProperty(ot,"ECIES_CONFIG",{enumerable:!0,get:s(function(){return fy.ECIES_CONFIG},"get")});var Tl=ti();Object.defineProperty(ot,"PrivateKey",{enumerable:!0,get:s(function(){return Tl.PrivateKey},"get")});Object.defineProperty(ot,"PublicKey",{enumerable:!0,get:s(function(){return Tl.PublicKey},"get")});ot.utils={aesEncrypt:Vt.aesEncrypt,aesDecrypt:Vt.aesDecrypt,symEncrypt:Vt.symEncrypt,symDecrypt:Vt.symDecrypt,decodeHex:Vt.decodeHex,getValidSecret:Vt.getValidSecret,remove0x:Vt.remove0x}});g();b();g();b();g();b();var $e={};var Di={...$e,defaultExplorer:"arbiscan",getExplorerUrl:s(function(e){let t;switch(e){case _o.Sepolia:t="sepolia.";break;case _o.Mainnet:default:t=""}return{arbiscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}arbiscan.io/${i}/${o}`},"arbiscan")}},"getExplorerUrl")};g();b();var Ni={...$e,defaultExplorer:"basescan",getExplorerUrl:s(function(e){let t;switch(e){case vo.Sepolia:t="sepolia.";break;case vo.Mainnet:default:t=""}return{basescan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}basescan.org/${i}/${o}`},"basescan")}},"getExplorerUrl")};g();b();var Mi={getExplorerUrl:s(function(){return{mempool:s((e,t)=>`https://mempool.space/${{transaction:"tx",address:"address"}[e]}/${t}`,"mempool")}},"getExplorerUrl"),defaultExplorer:"mempool"};g();b();var Hi={...$e,getExplorerUrl(e){let t;switch(e){case xo.Sepolia:t="sepolia.";break;case xo.Mainnet:default:t=""}return{etherscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}etherscan.io/${i}/${o}`},"etherscan")}},defaultExplorer:"etherscan"};g();b();var Ki={...$e,defaultExplorer:"hyperliquid",getExplorerUrl:s(function(e){let t;switch(e){case Bo.Testnet:t="app.hyperliquid-testnet.xyz";break;case Bo.Mainnet:default:t="app.hyperliquid.xyz"}return{hyperliquid:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address"}[n];return`https://${t}/explorer/${i}/${o}`},"hyperliquid")}},"getExplorerUrl")};g();b();var qi={...$e,defaultExplorer:"hyperevmscan",getExplorerUrl:s(function(e){return{hyperevmscan:s((t,n)=>{let r=Array.isArray(n)?n.join("/"):n;return`https://hyperevmscan.io/${{transaction:"tx",address:"address"}[t]}/${r}`},"hyperevmscan")}},"getExplorerUrl"),betaTagOverride:"Lite"};g();b();var ki={...$e,getExplorerUrl:s(function(e){let t;switch(e){case So.Testnet:t="testnet.monadvision.com";break;case So.Mainnet:t="monadvision.com";break}return{monadexplorer:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}/${i}/${o}`},"monadexplorer")}},"getExplorerUrl"),defaultExplorer:"monadexplorer",betaTagOverride:"Beta"};g();b();var Vi={...$e,getExplorerUrl:s(function(e){let t;switch(e){case Eo.Amoy:t="amoy.";break;case Eo.Mainnet:default:t=""}return{polygonscan:s((n,r)=>{let o=Array.isArray(r)?r.join("/"):r,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[n];return`https://${t}polygonscan.com/${i}/${o}`},"polygonscan")}},"getExplorerUrl"),defaultExplorer:"polygonscan"};g();b();var Fi={getExplorerUrl:s(function(e){let t;switch(e){case wn.Devnet:t="devnet";break;case wn.Testnet:t="testnet";break;case wn.Mainnet:t="mainnet-beta";break;case wn.Localnet:t="mainnet-beta";break}let n="";return["devnet","testnet"].includes(t)&&(n=`?cluster=${t}`),{"solana-beach":s((r,o)=>`https://solanabeach.io/${r}/${o}${n}`,"solana-beach"),solscan:s((r,o)=>`https://solscan.io/${{transaction:"tx",address:"account"}[r]}/${o}${n}`,"solscan"),"solana-explorer":s((r,o)=>`https://explorer.solana.com/${r}/${o}${n}`,"solana-explorer"),"solana-fm":s((r,o)=>{let i={"mainnet-beta":"mainnet-qn1",testnet:"testnet-solana",devnet:"devnet-solana",localhost:"localhost"}[t];return`https://solana.fm/${{transaction:"tx",address:"address"}[r]}/${o}?cluster=${i}`},"solana-fm"),xray:s((r,o)=>`https://xray.helius.xyz/${{transaction:"tx",address:"token"}[r]}/${o}${n}`,"xray"),orb:s((r,o)=>`https://orb.helius.dev/${{transaction:"tx",address:"address"}[r]}/${o}${n}`,"orb")}},"getExplorerUrl"),defaultExplorer:"solscan"};g();b();var ji={getExplorerUrl:s(function(e){return{suiscan:s((t,n)=>{let r;switch(e){case Yn.Testnet:r="testnet";break;case Yn.Mainnet:r="mainnet";break}let o={transaction:"tx",address:"account",token:"coin",nft:"object"}[t];return`https://suiscan.xyz/${r}/${o}/${n}`},"suiscan"),suivision:s((t,n)=>{let r;switch(e){case Yn.Testnet:r="testnet.";break;case Yn.Mainnet:r="";break}let o={transaction:"txblock",address:"account",token:"coin",nft:"object"}[t];return`https://${r}suivision.xyz/${o}/${n}`},"suivision")}},"getExplorerUrl"),defaultExplorer:"suivision"};var Gl=new yi({[at.Solana]:Fi,[at.Ethereum]:Hi,[at.Polygon]:Vi,[at.Monad]:ki,[at.Base]:Ni,[at.Arbitrum]:Di,[at.Bitcoin]:Mi,[at.Sui]:ji,[at.Hypercore]:Ki,[at.Hyperevm]:qi}),Ft=pi(Gl);g();b();g();b();g();b();g();b();var vn=[{value:"en",displayValue:"English",isLocale:!1},{value:"es",displayValue:"Espa\xF1ol",isLocale:!1},{value:"de",displayValue:"Deutsch",isLocale:!1},{value:"fr",displayValue:"Fran\xE7ais",isLocale:!1},{value:"it",displayValue:"Italiano",isLocale:!1},{value:"zh-CN",displayValue:"\u4E2D\u6587(\u7B80\u4F53)",isLocale:!0},{value:"zh-TW",displayValue:"\u4E2D\u6587(\u7E41\u9AD4)",isLocale:!0},{value:"bn",displayValue:"\u09AC\u09BE\u0982\u09B2\u09BE",isLocale:!1},{value:"ja",displayValue:"\u65E5\u672C",isLocale:!1},{value:"ko",displayValue:"\uD55C\uAD6D\uC5B4",isLocale:!1},{value:"ru",displayValue:"P\u0443\u0441\u0441\u043A\u0438\u0439",isLocale:!1},{value:"hi",displayValue:"\u0939\u093F\u0902\u0926\u0940",isLocale:!1},{value:"id",displayValue:"Indonesia",isLocale:!1},{value:"ms",displayValue:"Melayu",isLocale:!1},{value:"th",displayValue:"\u0E44\u0E17\u0E22",isLocale:!1},{value:"vi",displayValue:"Ti\u1EBFng Vi\u1EC7t",isLocale:!1},{value:"pt",displayValue:"Portugu\xEAs",isLocale:!1},{value:"tr",displayValue:"T\xFCrk\xE7e",isLocale:!1},{value:"fil",displayValue:"Filipino",isLocale:!1},{value:"my",displayValue:"\u1019\u103C\u1014\u103A\u1019\u102C\u1018\u102C\u101E\u102C",isLocale:!1},{value:"am",displayValue:"\u12A0\u121B\u122D\u129B",isLocale:!1},{value:"ar",displayValue:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",isLocale:!1},{value:"gu",displayValue:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",isLocale:!1},{value:"ha",displayValue:"Hausa",isLocale:!1},{value:"ig",displayValue:"\xC1s\u1EE5\u0300s\u1EE5\u0301 \xCCgb\xF2",isLocale:!1},{value:"pa",displayValue:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40",isLocale:!1},{value:"sw",displayValue:"Kiswahili",isLocale:!1},{value:"ta",displayValue:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",isLocale:!1},{value:"te",displayValue:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",isLocale:!1},{value:"yo",displayValue:"\xC8d\xE8 Yor\xF9b\xE1",isLocale:!1}];g();b();var zi=s(()=>{let e=[];return vn.forEach(t=>{e.push(t.value),t.isLocale&&e.push(t.value.substr(0,2))}),[...new Set(e)]},"generateSupportedLanguageValues"),vr=s((e,t)=>e.substr(0,3)==="fil"?t==="fil":e.substr(0,2)==="zh"?e==="zh-TW"?t==="zh-TW":t==="zh-CN":t===e.substr(0,2),"languageMatches"),Gi=s(e=>vn.find(t=>vr(e,t.value))?.displayValue,"languageDisplayValue"),Wi=s(e=>vn.find(t=>vr(e,t.value))?.value,"getSupportedLanguageValue");var dg=15,_r={version:1,addresses:[]},Sr={version:1,addresses:[]},$i=20,Wl=s(()=>{let e={};return He.getAllNetworkIDs().forEach(t=>{let n=Ft.get(t).defaultExplorer;n&&(e[t]=n)}),e},"getDefaultExplorers"),Lo={version:1,explorers:Wl()},Zi={orb:"Orb","solana-beach":"Solana Beach",solscan:"Solscan","solana-explorer":"Solana Explorer","solana-fm":"Solana FM",xray:"XRAY",etherscan:"Etherscan",basescan:"Basescan",arbiscan:"Arbiscan",polygonscan:"Polygonscan",mempool:"Mempool",suivision:"SuiVision",suiscan:"Suiscan",monadexplorer:"Monad Explorer",hyperliquid:"Hyperliquid Explorer",hyperevmscan:"HyperEVMScan"},Yi={version:1,apps:{}};var $l={default:"",light:"1f3fb",medium_light:"1f3fc",medium:"1f3fd",medium_dark:"1f3fe",dark:"1f3ff"},hg={"":"","1f3fb":"\u{1F3FB}","1f3fc":"\u{1F3FC}","1f3fd":"\u{1F3FD}","1f3fe":"\u{1F3FE}","1f3ff":"\u{1F3FF}"},pg={version:1,skinTone:$l.default},Qi=di,Xi=!0,Ji=xr({minutes:15}),_n=7200;g();b();var Se;(function(e){e.ApiEnvironment="apiEnvironment",e.EmojiSkinTone="emojiSkinTone",e.IsAnalyticsOptedOut="isAnalyticsOptedOut",e.SolanaActionsEnabled="solanaActionsEnabled",e.ShowWalletShortcuts="showWalletShortcuts",e.SelectedCurrency="selectedCurrency",e.SavedAddresses="savedAddresses",e.RecentAddressesBrowser="recentAddresses",e.RecentAddressesMobile="recentAddressesV2"})(Se||(Se={}));g();b();var Ar=s(({networkID:e,endpoint:t,param:n,explorerType:r})=>{let i=Ft.get(e).getExplorerUrl(e)[r??Ft.get(e).defaultExplorer];return i?i(t,n):""},"generateExplorerUrl"),ea=s(e=>{if(!e)return;let{explorers:t}=e,n={};return He.getAllNetworkIDs().forEach(o=>{let i=He.getNetworkName(o),a=t[o];n[i]=a}),{...e,explorers:n}},"formatExplorers");g();b();g();b();var Zl=s(e=>{switch(e){case xn.PrivateKey:return En.t("removeAccountWarningPrivateKey");case xn.Seed:return En.t("removeAccountWarningSeed");case xn.Ledger:return En.t("removeAccountWarningLedger");case xn.SeedVault:return En.t("removeAccountWarningSeedVault");case xn.ReadOnly:return En.t("removeAccountWarningReadOnly")}},"getAccountRemovalWarning");g();b();var Yl=s((e,t)=>e.filter(n=>typeof n.title=="string"&&ta(t,n.title)||ta(t,n.tags?.join(" "))),"filterSearchSettings"),ta=s((e,t)=>{if(t===void 0)return!1;let n=e.toLowerCase();return t.toLowerCase().split(" ").map(r=>r.startsWith(n)||n.startsWith(r)&&t.toLowerCase().includes(n)).includes(!0)},"filterByWordPrefix");g();b();async function Ql(e){for(let t of e){let n=await t.get(Oi.NetworkSetting);if(n)return n.setting}return Li().setting}s(Ql,"getNetworkSetting");g();b();g();b();g();b();var Xl="currency",Jl="currencyExchangeRates",Br={currencyExchangeRates:s(()=>[Xl,Jl,gr],"currencyExchangeRates")};var ef=s(e=>e.queryKey[1]===Br.currencyExchangeRates()[1]&&e.queryKey[2]===gr,"currencyShouldDehydrateQueryPredicate");g();b();g();b();var tf="/currency_exchange/v1/rates",na=s(async()=>{let e=await gn.api().get(`${tf}?from=USD&currencies=${Object.keys(Lt).join(",")}`);if(!bn(e))throw new Error("Failed to fetch exchange rates");return await e.data},"getCurrencyExchangeRates");var nf=xr({hours:2}),l1=s(e=>oe({queryKey:Br.currencyExchangeRates(),queryFn:na,enabled:!!e,staleTime:nf,select(t){return e?t?.rates[e]:1}}),"useCurrencyExchangeRates");g();b();var rf=s(()=>{try{let e=Ei.getMultivariateAssignment("auto-confirm-session-duration"),t=Number(e);if(!isNaN(t)&&t>0)return t}catch{}return _n},"getMaxSessionDuration");g();b();g();b();var Re="@phantom/settings",ee={appPermissions(e,...t){return[`${Re}:app-permissions`,e,...t]},emojiSkinTone(){return[`${Re}:emoji-skin-tone`]},isAnalyticsOptedOut(){return[`${Re}:is-analytics-opted-out`]},solanaActionsEnabled(){return[`${Re}:solana-actions-enabled`]},showWalletShortcuts(){return[`${Re}:show-wallet-shortcuts`]},preferredExplorers(){return[`${Re}:preferred-explorers`]},recentAddresses(){return[`${Re}:recent-addresses`]},savedAddresses(){return[`${Re}:saved-addresses`]},trustedApps(){return[`${Re}:trusted-apps`]},metaMaskOverride(){return[`${Re}:metamask-override`]},autoConfirm(e,t){return[Re,"auto-confirm",e,t]},allAutoConfirm(e){return[Re,"auto-confirm",e]},allAutoConfirmOnAllAccounts(){return[Re,"auto-confirm"]},autoConfirmLocalhost(){return[Re,"auto-confirm","auto-confirm-localhost:v1"]},webViewDebugging(){return[`${Re}:enable-webview-debugging:v1`]},selectedCurrency(){return[`${Re}:selected-currency`]}};var Oo=V.enum(["ALWAYS_ASK","USE_PHANTOM","USE_METAMASK"]),ra="metaMaskOverride";async function oa(e){let t=await e.get(ra),n=Oo.safeParse(t);return n.success?n.data:Oo.enum.ALWAYS_ASK}s(oa,"getMetaMaskOverrideSetting");function of(){let e=pe();return oe({queryKey:ee.metaMaskOverride(),refetchOnMount:"always",async queryFn(){return oa(e)}})}s(of,"useMultiChainMetaMaskOverrideSetting");function sf(){let e=pe(),t=le(),n=tt();return ae({async mutationFn(r){await sa(e,r),n.capture("metamaskOverrideSettingsChanged",{data:{setting:r}})},async onSuccess(){await t.invalidateQueries({queryKey:ee.metaMaskOverride()})}})}s(sf,"useSetMultiChainMetaMaskOverrideSetting");async function sa(e,t){await e.set(ra,t)}s(sa,"setMetaMaskOverrideSetting");g();b();var af=s(async e=>{if(!wo)return;let t=await e.get(Se.ApiEnvironment);t&&mr(t)},"loadAPIEnvironment"),cf=s(()=>{let e=pe();return oe({queryKey:["settings:apiEnvironment"],queryFn:s(async()=>{let t=await e.get(Se.ApiEnvironment);return t?(mr(t),t):null},"queryFn"),enabled:wo})},"useAPIEnvironment"),uf=s(()=>{let e=pe(),t=Ti(),n=le();return ae({mutationFn:s(async r=>{await e.set(Se.ApiEnvironment,r),mr(r),await lf(t,n),await ff(n)},"mutationFn")})},"useSetApiEnvironment");async function lf(e,t){await e.logOut(),await Promise.all([Ci(t),Ui(t)]),await Promise.all([Ii(t),Ri(t)])}s(lf,"invalidateAuth");async function ff(e){await e.invalidateQueries({queryKey:["settings:apiEnvironment"]})}s(ff,"invalidateAPIEnvironment");g();b();function df(e){return Sn(t=>{let n=t.explorers[e]??Ft.get(e).defaultExplorer;return Zi[n]})}s(df,"usePreferredExplorerNameForNetworkId");function hf(e,t){return Sn(n=>{let r=n.explorers[e];return Ar({networkID:e,endpoint:"address",explorerType:r,param:t})})}s(hf,"useAddressPreferredExplorerUrl");function pf(e){return Sn(t=>{if(!e)return"";let n=e.networkID,r=t.explorers[n];return Ar({networkID:n,endpoint:"transaction",explorerType:r,param:e.id})})}s(pf,"useTransactionPreferredExplorerUrl");function Sn(e){let t=Ke(),n=ee.preferredExplorers();return oe({queryKey:n,queryFn:s(async()=>{let o=await t.get(me.UserExplorerPreferenceV2);return o?{version:o.version,explorers:{...Lo.explorers,...o.explorers}}:Lo},"queryFn"),select:e})}s(Sn,"usePreferredExplorers");function yf(){let e=Ke(),t=le();return ae({mutationFn:s(async({preferredExplorers:o})=>{await e.set(me.UserExplorerPreferenceV2,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.preferredExplorers()})},"onSuccess")})}s(yf,"useSetPreferredExplorers");g();b();var ia=s(async(e,t)=>{let n=await e.get(Se.SolanaActionsEnabled);return n===null?t??!1:n},"checkSolanaActionsEnabled");function mf(e=!1){let t=pe(),n=ee.solanaActionsEnabled();return oe({queryKey:n,queryFn:s(async()=>ia(t,e),"queryFn")})}s(mf,"useSolanaActionsEnabled");function gf(){let e=pe(),t=le();return ae({mutationFn:s(async({enabled:o})=>{await e.set(Se.SolanaActionsEnabled,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.solanaActionsEnabled()})},"onSuccess")})}s(gf,"useSetSolanaActionsEnabled");g();b();var ha=st(mn());g();b();function aa(){let{isReady:e,value:t}=To(),n=Ke(),r=ee.recentAddresses();return oe({enabled:e,queryKey:r,queryFn:s(async()=>{let i=await n.get(me.UserRecentAddresses);if(!t)throw new Error(Io);let a=t.enabledChainIDs;return i?ua(i,a):_r},"queryFn")})}s(aa,"useRecentAddresses");function ca(){let{isReady:e,value:t}=To(),n=Ke(),r=ee.savedAddresses();return oe({enabled:e,queryKey:r,queryFn:s(async()=>{let i=await n.get(me.UserSavedAddresses);if(!t)throw new Error(Io);let a=t.enabledChainIDs;return i?ua(i,a):Sr},"queryFn")})}s(ca,"useSavedAddresses");var ua=s((e,t)=>({...e,addresses:e.addresses.filter(n=>t.includes(He.getChainID(n.chainID)))}),"filterAddressesByChain");function Ub(){return(e,t)=>{if(t==null)return e;if(e==null)return t;let n=e.addresses,r=t.addresses,o=new Map;n.forEach(a=>{o.set(a.address,a)}),r.forEach(a=>{o.set(a.address,a)});let i=Array.from(o.values());return{...e,addresses:i}}}s(Ub,"syncedAddressBookResolver");g();b();function la(){let e=Ke(),t=le();return ae({mutationFn:s(async({recentAddresses:o})=>{await e.set(me.UserRecentAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.recentAddresses()})},"onSuccess")})}s(la,"useSetRecentAddresses");function fa(){let e=Ke(),t=le();return ae({mutationFn:s(async({savedAddresses:o})=>{await e.set(me.UserSavedAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.savedAddresses()})},"onSuccess")})}s(fa,"useSetSavedAddresses");var bf=s(()=>{let{data:e=[]}=Pi(),{data:t=_r}=aa(),{data:n=Sr}=ca(),{mutate:r}=la(),{mutate:o}=fa();return(0,ha.useMemo)(()=>({recentAddresses:t,savedAddresses:n,addRecentAddress:s(({address:i,chainID:a,timestamp:c=Date.now()})=>Ef(e,t,n,r,{address:i,chainID:a,timestamp:c}),"addRecentAddress"),addSavedAddress:s(i=>vf(e,t,n,r,o,i),"addSavedAddress"),editSavedAddress:s((i,a)=>_f(n,o,i,a),"editSavedAddress"),getExistingAccount:s(i=>xf(e,i),"getExistingAccount"),getSavedAddressLabel:s((i,a)=>da(n.addresses,i,a),"getSavedAddressLabel"),getKnownAddressLabel:s((i,a)=>da([n.addresses,wf(e)].flat(),i,a),"getKnownAddressLabel"),isExistingAccountAddress:s(i=>Po(e,i),"isExistingAccountAddress"),isRecentAddress:s((i,a)=>pa(t,i,a),"isRecentAddress"),isSavedAddress:s((i,a)=>Uo(n,i,a),"isSavedAddress"),removeRecentAddress:s(i=>ya(t,r,i),"removeRecentAddress"),removeSavedAddress:s(i=>Sf(n,o,i),"removeSavedAddress")}),[e,t,n,r,o])},"useAddressBook"),wf=s(e=>{let t=[];for(let n of e)t.push(...n.addresses.map(({address:r,networkID:o})=>({address:r,chainID:o,label:n.name})));return t},"getWalletAddresses"),xf=s((e,t)=>e[ga(e,t)],"getExistingAccount"),Po=s((e,t)=>ga(e,t)>-1,"isExistingAccountAddress"),pa=s((e,t,n)=>An(e.addresses,{address:t,chainID:n})>-1,"isRecentAddress"),Uo=s((e,t,n)=>An(e.addresses,{address:t,chainID:n})>-1,"isSavedAddress"),Ef=s((e,t,n,r,{address:o,chainID:i,timestamp:a=Date.now()})=>{if(Po(e,o)||Uo(n,o,i)||pa(t,o,i))return;t.addresses.unshift({address:o,chainID:i,timestamp:a});let{addresses:c}=t;return t.addresses=c.slice(0,$i),r({recentAddresses:t}),t},"addRecentAddress"),vf=s((e,t,n,r,o,i)=>{let{address:a,chainID:c}=i;if(Po(e,a)||Uo(n,a,c))return;ya(t,r,{address:a,chainID:c,timestamp:0});let u={...n,addresses:[...n.addresses,i]};return o({savedAddresses:u}),u},"addSavedAddress"),_f=s((e,t,n,r)=>{let o=An(e.addresses,n);if(o<0)return;let i=[...e.addresses];i[o]=r;let a={...e,addresses:i};return t({savedAddresses:a}),a},"editSavedAddress"),ya=s((e,t,n)=>{let r=An(e.addresses,n);if(r<0)return;let o=[...e.addresses];o.splice(r,1);let i={...e,addresses:o};return t({recentAddresses:i}),i},"removeRecentAddress"),Sf=s((e,t,n)=>{let r=An(e.addresses,n);if(r<0)return;let o=[...e.addresses];o.splice(r,1);let i={...e,addresses:o};return t({savedAddresses:i}),i},"removeSavedAddress"),da=s((e,t,n)=>{let r=An(e,{address:t,chainID:n});if(!(r<0))return e[r].label},"getAddressLabel"),ma=s((e,t,n)=>He.isEVMNetworkID(n)?e.toLowerCase()===t.toLowerCase():e===t,"compareAddresses"),ga=s((e,t)=>e.findIndex(n=>n.addresses.find(r=>ma(r.address,t,r.networkID))),"getAccountIndex"),An=s((e,t)=>e.findIndex(n=>{let r=t.chainID===n.chainID,o=ma(t.address,n.address,t.chainID);return r&&o}),"getEntryIndex");g();b();g();b();var ba=Af;function Af(e){var t,n,r;if(e){if(Array.isArray(e)){for(t=[],n=e.length,r=0;r<n;r++){var o=e[r];o!=null&&t.push(o)}return t}if(typeof e=="object"){t={};var i=Object.keys(e);for(n=i.length,r=0;r<n;r++){var a=i[r],c=e[a];c!=null&&(t[a]=c)}return t}}}s(Af,"flush");var va=st(Ro());g();b();var Bf=V.object({chainType:V.union([V.literal("bip122_p2wpkh"),V.literal("bip122_p2tr")]),chainName:V.literal("bitcoin"),networkId:V.union([V.literal("128"),V.literal("239")])}),Cf=V.object({chainType:V.literal("eip155"),chainName:V.literal("ethereum"),networkId:V.union([V.literal("1"),V.literal("5"),V.literal("11155111")])}),If=V.object({chainType:V.literal("eip155"),chainName:V.literal("polygon"),networkId:V.union([V.literal("137"),V.literal("80002")])}),Tf=V.object({chainType:V.literal("eip155"),chainName:V.literal("base"),networkId:V.union([V.literal("8453"),V.literal("84532")])}),Lf=V.object({chainType:V.literal("eip155"),chainName:V.literal("arbitrum"),networkId:V.union([V.literal("42161"),V.literal("421614")])}),Of=V.object({chainType:V.literal("eip155"),chainName:V.literal("hyperevm"),networkId:V.union([V.literal("999"),V.literal("998")])}),Pf=V.object({chainType:V.literal("eip155"),chainName:V.literal("monad"),networkId:V.union([V.literal("143"),V.literal("10143"),V.literal("41454")])}),xa=V.object({chainType:V.literal("solana"),chainName:V.literal("solana"),networkId:V.union([V.literal("mainnet"),V.literal("testnet"),V.literal("devnet"),V.literal("localnet")])}),Uf=V.object({chainType:V.literal("sui"),chainName:V.literal("sui"),networkId:V.union([V.literal("mainnet"),V.literal("testnet")])}),Ea=V.union([Bf,Cf,Tf,Lf,Of,Pf,If,xa,Uf]);var Do=s(()=>["t","y","1","true","yes"].some(e=>T.DISABLE_ANALYTICS?.toLowerCase()===e)??!1,"isAnalyticsDisabled");function No(e){if(!e)return;let t=e.data??{},n=e.data?.asset??{};try{t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n))}catch(o){va.default.error("Failed to parse analytics payload",o);return}let r={...t,...e.action?{action:e.action}:{},...n&&typeof n=="object"?n:{},...e.type?{type:e.type}:{}};if("chainID"in r&&!("chainType"in r)&&!("chainName"in r)&&!("networkId"in r)){let o=br.safeParse(r.chainID);o.success&&Object.assign(r,_a(o.data))}return ba(r)}s(No,"parseAnalyticsPayload");function _a(e){let t=He.getChainDefinition(e);return Ea.parse({chainType:t.addressTypes[0],chainName:t.id,networkId:t.networks[e].value.toString()})}s(_a,"chainFromNetworkID");g();b();g();b();var Mo=T.RUDDERSTACK_DATAPLANE??T.VITE_RUDDERSTACK_DATAPLANE??"https://data.phantom.app",Rf=T.RUDDERSTACK_KEY_EXT,Df=T.RUDDERSTACK_KEY_WEB,Nf=T.RUDDERSTACK_KEY_PORTAL;g();b();function Xn(e,{action:t,data:n}){let r={action:t,data:n};return e.capture("actionApprovedByUser",r)}s(Xn,"actionApprovedByUser");function Jn(e,{action:t,data:n}){let r={action:t,data:{...n,chainId:n.chainId??n.networkId}};return e.capture("actionDeniedByUser",r)}s(Jn,"actionDeniedByUser");function Ho(e,{action:t,data:n}){let r={type:"transaction",data:{...n,chainId:n.chainId??n.networkId},action:t};return(!r.data.ids||r.data.ids.length===0)&&We.captureError(new Error("No ids found in transactionSubmitted payload"),Ge.Provider),e.capture("transactionSubmitted",r)}s(Ho,"transactionSubmitted");function Mf(e,{action:t,data:n}){let r={data:{...n,chainId:n.chainId??n.networkId},action:t};return e.capture("transactionStatus",r)}s(Mf,"transactionStatus");function Ko(e,t){let n={type:"message",data:{...t,chainId:t.chainId??t.networkId}};return e.capture("transactionSubmitted",n)}s(Ko,"messageSigned");var Ot=class{static{s(this,"SequenceAnalytics")}analytics;action;constructor(t,n){this.analytics=t,this.action=n}approved=s(t=>{Xn(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"approved");denied=s(async t=>{Jn(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"denied");submittedTransaction=s(async(t,n)=>{Ho(this.analytics,{action:this.action,data:{...n,ids:n.ids??[t],chainId:n.chainId??n.networkId}})},"submittedTransaction");signedMessage=s(async t=>{Ko(this.analytics,{...t,chainId:t.chainId??t.networkId})},"signedMessage");transactionStatus=s(async(t,n)=>{n.ids||(n.ids=[t]),Mf(this.analytics,{action:this.action,data:{...n,chainId:n.chainId??n.networkId}})},"transactionStatus")};async function Sa(e,t,n){let{origin:r}=t;switch(e.method){case"eth_sendTransaction":{let[o]=e.params,i=it(o.chainId);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o.chainId}) for method "${e.method}"`}:{success:!0,data:{...i,origin:r,method:e.method,gas:o.gas,maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas,ids:n}}}case"sol_signTransaction":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signTransaction",ids:n}}}case"sol_signAndSendTransaction":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAndSendTransaction",ids:n}}}case"sol_signAndSendAllTransactions":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAndSendAllTransactions",ids:n}}}case"sol_signAllTransactions":{let o=it(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:r,method:"signAllTransactions",ids:n}}}}}s(Sa,"transactionSignatureEventPayloadFromRpcRequest");async function Aa(e,t){let{origin:n}=t;switch(e.method){case"eth_sign":case"personal_sign":{let r=t.chainId,o=it(r);return o?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${r}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method,origin:n}}}case"eth_signTypedData":{let[r]=e.params,o=t.chainId;for(let a of r)if(a.name==="chainId"){o=a.value;break}let i=it(o);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o}) for method "${e.method}"`}:{success:!0,data:{...i,method:e.method,origin:n}}}case"eth_signTypedData_v3":{let[r,o]=e.params,i=o.domain.chainId??t.chainId,a=it(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:n}}}case"eth_signTypedData_v4":{let[r,o]=e.params,i=t.chainId;(typeof o.domain.chainId=="string"||typeof o.domain.chainId=="number")&&(i=o.domain.chainId);let a=it(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:n}}}case"sol_signIn":case"sol_signMessage":{let r=t.chainId,o=it(r);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${r}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method==="sol_signIn"?"signIn":"signMessage",origin:n}}}}}s(Aa,"messageSignatureEventPayloadFromRpcRequest");g();b();g();b();var Pt=st(Ro());var jt="[Analytics Log]",Ir=class{static{s(this,"MockAnalytics")}storage;constructor(t){this.storage=t}async capture(t,n){Pt.default.debug(jt,"Capture Event:",t,No(n))}async addUserProperties(t){Pt.default.debug(jt,"User Properties:",JSON.stringify(t))}async identify(t,n){Pt.default.debug(jt,"Identify, id:",t," traits:",n)}async getDeviceId(){return"mock-device-id"}setDeviceId(t){Pt.default.debug(jt,`SetDeviceId: ${t}`)}async getAnonymousId(){return"mock-anonymous-id"}async setAnalyticsOptedOut(t){Pt.default.debug(jt,`SetAnalyticsOptedOut: ${t}`)}async setDisplayLanguage(t){Pt.default.debug(jt,`SetDisplayLanguage: ${t}`)}screen(t,n){Pt.default.debug(jt,`Screen: ${t}`,n)}page(t,n,r,o){Pt.default.debug(jt,`Page: ${t}`,n,r,o)}rudderClient};var Ba=s(()=>Mo,"getRudderstackDataplane"),Hf=s(({storage:e,rudderStackKey:t,createAnalytics:n})=>{if(!t)throw new Error("RUDDERSTACK_KEY_[*] env variables required.");let r=Ba();if(!r)throw new Error("[*]_RUDDERSTACK_DATAPLANE env variables required.");return Do()?new Ir(e):n(t,r)},"initAnalytics");g();b();g();b();var Kf="burn",Ca=s(e=>new Ot(e,Kf),"createBurnAnalytics");g();b();var qf="send",Ia=s(e=>new Ot(e,qf),"createSendAnalytics");var qo={};Fl(qo,{action:()=>Tr,createDappAnalytics:()=>kf,userApprovedAction:()=>Vf,userDeniedAction:()=>Ff});g();b();var Tr="dapp",kf=s(e=>new Ot(e,Tr),"createDappAnalytics");async function Vf(e,t){return await Xn(e,{action:Tr,data:{...t,chainId:t.networkId}})}s(Vf,"userApprovedAction");async function Ff(e,t){return await Jn(e,{action:Tr,data:{...t,chainId:t.networkId}})}s(Ff,"userDeniedAction");var jf=s(e=>({send:Ia(e),burn:Ca(e)}),"createSequenceAnalytics");g();b();async function zt(){}s(zt,"noOp");var zf=s(()=>({capture:zt,addUserProperties:zt,identify:zt,getDeviceId:s(async()=>"","getDeviceId"),setDeviceId:zt,setAnalyticsOptedOut:zt,setDisplayLanguage:zt,screen:zt,page:zt,rudderClient:{}}),"createNoOpAnalytics");g();b();g();b();async function Gt(e){return await e.get(Vo)??Yi}s(Gt,"getTrustedApps");function ko(){let e=pe();return oe({queryKey:ee.trustedApps(),refetchOnMount:"always",async queryFn(){return await Gt(e)}})}s(ko,"useTrustedApps");async function Wt(e,t){await e.set(Vo,t)}s(Wt,"setTrustedApps");function Gf(){let e=pe(),t=le();return ae({async mutationFn({trustedApps:n}){await Wt(e,n)},async onSuccess(){await t.invalidateQueries({queryKey:ee.trustedApps()})}})}s(Gf,"useSetTrustedApps");var Vo=me.UserTrustedApps;g();b();function Wf(){let e=Ke(),t=ee.emojiSkinTone();return oe({queryKey:t,queryFn:s(async()=>await e.get(Se.EmojiSkinTone),"queryFn")})}s(Wf,"useEmojiSkinTone");function $f(){let e=Ke(),t=le();return ae({mutationFn:s(async({skinTone:o})=>{await e.set(Se.EmojiSkinTone,{version:1,skinTone:o})},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.emojiSkinTone()})},"onSuccess")})}s($f,"useSetEmojiSkinTone");g();b();var Ta=s(async e=>await e.get(Se.IsAnalyticsOptedOut)??Qi,"checkIsAnalyticsOptedOut");function Fo(){let e=Ke(),t=ee.isAnalyticsOptedOut();return oe({queryKey:t,queryFn:s(async()=>Ta(e),"queryFn")})}s(Fo,"useIsAnalyticsOptedOut");function Zf(){let e=Ke(),t=tt(),n=le();return ae({mutationFn:s(async({isAnalyticsOptedOut:i})=>{await e.set(Se.IsAnalyticsOptedOut,i),await t.setAnalyticsOptedOut(i)},"mutationFn"),onSuccess:s(()=>{n.invalidateQueries({queryKey:ee.isAnalyticsOptedOut()})},"onSuccess")})}s(Zf,"useSetIsAnalyticsOptedOut");g();b();var Yf=st(mn());var Qf=s(()=>{let e=pe(),t=s(async()=>!!await e.get(me.BalanceHiddenStatus),"queryFn"),{data:n}=oe({queryKey:[me.BalanceHiddenStatus],queryFn:t});return n??!1},"useIsBalanceHidden"),Xf=s(()=>{let e=pe(),t=le(),n=s(async o=>await e.set(me.BalanceHiddenStatus,o),"mutationFn"),{mutateAsync:r}=ae({mutationFn:n,onMutate:s(async o=>{await t.cancelQueries({queryKey:[me.BalanceHiddenStatus]});let i=t.getQueryData([me.BalanceHiddenStatus]);return t.setQueryData([me.BalanceHiddenStatus],o),{previousIsBalanceHidden:i}},"onMutate"),onError:s((o,i,a)=>{t.setQueryData([me.BalanceHiddenStatus],a?.previousIsBalanceHidden)},"onError"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.BalanceHiddenStatus]})},"onSuccess")});return r},"useSetIsBalanceHidden");g();b();var Jf=s(()=>{let e=pe(),t=s(async()=>await e.get(me.LockTimerMs)??Ji,"queryFn");return oe({queryKey:[me.LockTimerMs],queryFn:t})},"useLockTimer"),ed=s(()=>{let e=pe(),t=le();return ae({mutationFn:s(async({lockTimeInMs:r})=>(We.addBreadcrumb(Ge.Account,`Lock timer updated to ${r}ms`,dt.Debug),await e.set(me.LockTimerMs,r)),"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.LockTimerMs]})},"onSuccess")})},"useSetLockTimer");g();b();function td(){let e=pe(),t=ee.showWalletShortcuts();return oe({queryKey:t,queryFn:s(async()=>{let r=await e.get(Se.ShowWalletShortcuts);return r!=null?r==="true":Xi},"queryFn")})}s(td,"useShowWalletShortcutsSettings");function nd(){let e=pe(),t=le();return ae({mutationFn:s(async({showWalletShortcuts:o})=>{await e.set(Se.ShowWalletShortcuts,o?"true":"false")},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.showWalletShortcuts()})},"onSuccess")})}s(nd,"useSetShowWalletShortcutsSettings");g();b();g();b();g();b();var jo=s(()=>{let e=xi("auto-confirm-session-duration");return typeof e=="number"&&e>0?e:_n},"useMaxSessionDuration");var La=s((e=7200)=>({networks:{},maxSessionDuration:e}),"createDefaultSettings"),rd=V.object({networks:V.record(br,V.boolean()),sessionStartTime:V.number().optional(),maxSessionDuration:V.number().positive()}),od=V.record(V.string(),rd);function Oa(e){let{sessionStartTime:t=0,maxSessionDuration:n=_n,networks:r={}}=e??{};return Object.values(r).some(i=>i===!0)&&t>Date.now()-n*1e3}s(Oa,"isAutoConfirmSessionActive");async function sd(e,t){let r={...await Gt(e)};for(let o of Object.keys(r.apps[t]))r.apps[t][o].autoConfirm&&delete r.apps[t][o].autoConfirm;await Wt(e,r)}s(sd,"endAllAutoConfirmForAccountIdentifier");async function zo(e){let n={...await Gt(e)};for(let r of Object.keys(n.apps))for(let o of Object.keys(n.apps[r]))Bi(o)&&n.apps[r][o].autoConfirm&&delete n.apps[r][o].autoConfirm;await Wt(e,n)}s(zo,"endAllAutoConfirmForLocalhostDomains");async function Go(e,t,n,r=7200){let o=n.replace(/\/$/,""),i=await Gt(e),a=i?.apps?.[t]?.[o]??{},c=a?.autoConfirm??La(r);if(a?.autoConfirm){let u=Object.values(c.networks).some(f=>f===!0);Oa(a?.autoConfirm)===!1&&u&&(c=await cd(a.autoConfirm),c=c??La(r))}return a.autoConfirm=c,await Wt(e,i),a.autoConfirm}s(Go,"getAutoConfirmSettingsForDomain");async function Pa(e,t,n,r,o=7200){let i=n.replace(/\/$/,"");await Go(e,t,i,o);let a=await Gt(e);a.apps[t]&&a.apps[t][i]&&(a.apps[t][i].autoConfirm=r),await Wt(e,a)}s(Pa,"setAutoConfirmSettingsForDomain");function id(e,t){let n=pe(),r=le(),o=t.replace(/\/$/,""),i=jo();return{set:ae({async mutationFn(a){await Pa(n,e,o,a,i)},async onSuccess(){await r.invalidateQueries({queryKey:ee.trustedApps()}),await r.invalidateQueries({queryKey:ee.allAutoConfirm(e)})}}),remove:ae({async mutationFn(){let a=await Gt(n);a.apps[e][t]?.autoConfirm&&delete a.apps[e][t].autoConfirm,await Wt(n,a)},async onSuccess(){await r.invalidateQueries({queryKey:ee.autoConfirm(e,t)})}}),get:oe({queryKey:ee.autoConfirm(e,t),refetchOnMount:"always",async queryFn(){return await Go(n,e,t,i)}})}}s(id,"useAutoConfirmSettings");function ad(e){let t=pe(),n=le();return{removeAll:ae({async mutationFn(){return await sd(t,e)},async onSuccess(){await n.invalidateQueries({queryKey:ee.trustedApps()}),await n.resetQueries({queryKey:ee.allAutoConfirm(e)})}})}}s(ad,"useAllAutoConfirmSettings");function cd(e){if(!e?.networks)return e;for(let t of Object.keys(e?.networks))e.networks[t]=!1;return e}s(cd,"markSessionExpired");var ud=V.boolean(),Ua="autoConfirmLocalhost";async function Ra(e){let t=await e.get(Ua),n=ud.safeParse(t);return n.success?n.data:!1}s(Ra,"getAutoConfirmLocalhost");function ld(){let e=pe();return oe({queryKey:ee.autoConfirmLocalhost(),refetchOnMount:"always",async queryFn(){return Ra(e)}})}s(ld,"useAutoConfirmLocalhost");function fd(){let e=pe(),t=le();return ae({async mutationFn(n){await dd(e,n),n===!1&&(await zo(e),await t.invalidateQueries({queryKey:ee.allAutoConfirmOnAllAccounts()}))},async onSuccess(){await t.invalidateQueries({queryKey:ee.autoConfirmLocalhost()}),await t.invalidateQueries({queryKey:["auto-confirm"]})}})}s(fd,"useSetAutoConfirmLocalhost");async function dd(e,t){await e.set(Ua,t)}s(dd,"setAutoConfirmLocalhost");g();b();var Da=st(mn());var hd=s(()=>{let{data:e,isFetching:t}=ko(),{data:n,isFetching:r}=Fo(),{data:o,isFetching:i}=Sn(),a=t||r||i;return(0,Da.useMemo)(()=>({data:{"Analytics Opt Out":n,"Preferred Explorers":ea(o),"Trusted Apps":e},isFetching:a}),[n,a,o,e])},"useSettingsExport");g();b();g();b();g();b();g();b();var Ha=st(jl());g();b();var Na=st(zl());async function Bn({kms:e,organization:t,newPolicy:n,appId:r,analytics:o}){let i=t.users.filter(u=>u.traits?.appId===r&&(!("policy"in u)||!(0,Na.default)(u.policy,n))),a=t.organizationId,c="usdLimit"in n?n.usdLimit?.usdCentsLimitPerDay:null;await e.batchRpcCall(i.map(u=>_i("updateUserInOrganization",{organizationId:a,username:u.username,newPolicy:n})));for(let{username:u}of i)o?.capture("userUpdatedInOrganization",{data:{appId:r,organizationId:a,username:u,usdCentsLimitPerDay:c}})}s(Bn,"alignPolicies");g();b();g();b();var Lr=new It.PublicKey("L2TExMFKdjpN9kozasaurPirfHy9P8sbXoAN1qA3S95"),pd="https://node-proxy.phantom.app";async function Ma(e,t="mainnet"){let n=md(t),r=new It.Connection(n,{commitment:"confirmed",confirmTransactionInitialTimeout:5e3});for(let o=0;o<=255;o++){let[i,a]=yd(e,o);try{if(await r.getAccountInfo(i))continue;return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}catch{return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}}throw new Error("All 256 memory PDAs are already initialized for this wallet")}s(Ma,"findAvailableMemoryPda");function yd(e,t){if(t<0||t>255)throw new Error("memoryId must be between 0 and 255");return It.PublicKey.findProgramAddressSync([Buffer.from("memory"),e.toBuffer(),Buffer.from([t])],Lr)}s(yd,"findMemoryPda");function md(e="mainnet"){return`${pd}/v1/chain/solana/network/${e}`}s(md,"getPhantomSolanaRpcUrl");var gd={ethereumMessage:!0,ethereumTx:!0,ethereumTypedData:!0,rawPayload:!0,solanaTx:!0,utf8Message:!0},bd="457ad40e-ecca-4b47-a845-8e1efc6b61b3";var wd="2b4308d3-e072-4f31-b890-4bd14ed6e546",xd={[bd]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",Lr.toBase58()],[wd]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",Lr.toBase58()]};async function Cn(e){let t=null;e.usdCentsLimitPerDay&&(t=await Ed({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId,usdCentsLimitPerDay:e.usdCentsLimitPerDay,appId:e.appId}));let n=xd[e.appId];return{type:"CEL",preset:"DAPP_CONNECTION_USER",walletId:e.walletId,usdLimit:t,allowedMethods:gd,solanaProgramAllowlist:n??null}}s(Cn,"getPolicy");async function Ed(e){try{We.addBreadcrumb(Ge.PhantomConnect,"Deriving memory account for spending limits",dt.Info,{walletId:e.walletId});let t=await vd(e);return We.addBreadcrumb(Ge.PhantomConnect,"Derived memory account for spending limits",dt.Info,t),{usdCentsLimitPerDay:e.usdCentsLimitPerDay,memoryAccount:t.memoryAccount,memoryId:t.memoryId,memoryBump:t.memoryBump}}catch(t){let n=t instanceof Error?t.message:String(t);return We.captureError(t instanceof Error?t:new Error(n),Ge.PhantomConnect),We.addBreadcrumb(Ge.PhantomConnect,"Failed to derive memory account, continuing without spending limits",dt.Error),null}}s(Ed,"_getSpendingLimit");async function vd(e){try{let n=(await e.kms.getOrganization({organizationId:e.userOrganizationId})).result.users.map(r=>{if(r.traits?.appId!==e.appId||!("policy"in r))return null;let o=Er.safeParse(r.policy);return o.success?o.data:null}).find(r=>r!==null);if(!n?.usdLimit)throw new Error("No existing spending limit policy found");return{memoryAccount:n.usdLimit.memoryAccount,memoryId:n.usdLimit.memoryId,memoryBump:n.usdLimit.memoryBump}}catch{let t=await _d({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId});return await Ma(t)}}s(vd,"_getOrFindAvailableMemoryAccountPda");async function _d(e){let t=null;try{let o=(await ht()).filter(i=>i.addressFormat==="Solana");t=await e.kms.getAccounts({organizationId:e.userOrganizationId,walletId:e.walletId,accounts:o})}catch(r){let o=r instanceof Error?r.message:String(r);throw new Error(`Failed to get accounts: ${o}`)}let n=t?.result.find(r=>r.addressFormat==="Solana");if(!n)throw new Error("No Solana address found");return new It.PublicKey(n.address)}s(_d,"_getSolanaAccount");async function Ka({kms:e,userOrganizationId:t,publicKey:n,expiresInMs:r,appId:o,walletId:i,usdCentsLimitPerDay:a}){if(!o||o==="unknown")throw new Error("App ID is required and cannot be 'unknown'");let c=n.slice(0,8),u=n.slice(-8);try{let l=await Cn({kms:e,userOrganizationId:t,appId:o,usdCentsLimitPerDay:a,walletId:i}),f="preset"in l?l.preset:"CUSTOM";We.addBreadcrumb(Ge.PhantomConnect,"Starting addUserToOrganization",dt.Info,{organizationId:t,publicKeyPreview:c,appId:o,expiresInMs:r,policyType:f,usdCentsLimitPerDay:a});let p=`user_${c}${Date.now()}${u}`,d=wr(Ha.default.decode(n)),y={username:p,traits:{appId:o},authenticators:[{authenticatorKind:"keypair",publicKey:d,algorithm:"Ed25519",authenticatorName:`auth_${c}`}],expiresInMs:r,policy:l},h=await e.addUserToOrganization({organizationId:t,user:y,replaceExpirable:!0});wi("spending_limits_cumulative")&&await Bn({kms:e,organization:h.result,newPolicy:l,appId:o}),We.addBreadcrumb(Ge.PhantomConnect,"Successfully added user to organization",dt.Info,{organizationId:t,publicKeyPreview:c,appId:o,policyType:f,usdCentsLimitPerDay:a});let m=h.getByPublicKey(n);if(!m)throw new Error("User was added to organization but could not be found in the response");return{userOrganization:h.result,user:m}}catch(l){let f=l instanceof Error?l.message:String(l);throw We.captureError(l instanceof Error?l:new Error(f),Ge.PhantomConnect),We.addBreadcrumb(Ge.PhantomConnect,"Failed to add user to organization",dt.Error,{organizationId:t,publicKeyPreview:c,appId:o,error:f}),new Error(`Failed to add user to current user's organization: ${f}`)}}s(Ka,"addUserToCurrentUserOrganization");g();b();g();b();var Ze="vault";g();b();var Wn=st(Ll());function dy(e,t){return Wn.ECIES_CONFIG.ellipticCurve="x25519",Wn.ECIES_CONFIG.symmetricAlgorithm="aes-256-gcm",Wn.ECIES_CONFIG.symmetricNonceLength=16,(0,Wn.encrypt)(e,t)}s(dy,"encryptWithPublicKey");async function ni(e,t,n,r=Ze){try{let i=(await e.initWalletImport({organizationId:n})).result,a=await t.fetchAllSeedMetas();if(a.length<1)throw new Error("No seed available in vault for migration");let u=a[0].identifier,l=await t.exportEntropy(u),y=(await l.foldAsync(Si)).mnemonic.toString().split(" ").length;if(y!==12&&y!==24)throw new Error(`Invalid mnemonic length: expected 12 or 24 words, got ${y} words`);let h=await ht();if(h.length===0)throw new Error("No valid accounts found for migration");let w=await l.foldAsync(async x=>{let E=hi(i.publicKey),S=await dy(E,new Uint8Array(x));return wr(Buffer.from(S))}),m=await e.completeImportWallet({organizationId:n,importEnvelope:i,encryptedSecret:w,walletName:"Migrated Juicebox Wallet",accounts:h,mnemonicLength:y,tags:[r]});return{organizationId:n,walletId:m.result.walletId,walletName:m.result.walletName,accounts:m.result.accounts}}catch(o){throw o instanceof Error?new Error(`Failed to migrate Juicebox wallet: ${o.message}`):new Error(`Failed to migrate Juicebox wallet: ${String(o)}`)}}s(ni,"migrateJuiceboxWallet");async function ri(e,t,n=Ze){let r=await ht(),{result:{organizationId:o}}=await e.getOrCreatePhantomOrganization(),{result:i}=await e.getWalletWithTag({organizationId:o,tag:n,accounts:r});return i?{organizationId:o,isNewlyCreated:!1,isSeedless:!0,...i}:{...await ni(e,t,o,n),isNewlyCreated:!0,isSeedless:!0}}s(ri,"getOrMigrateJuiceboxWallet");g();b();async function Ol(e,t,n=Ze){let r=await ht(),i=(await t.fetchAllSeedlessMetas()).length>0,{result:{organizationId:a}}=await e.getOrCreatePhantomOrganization(),{result:c}=await e.getWalletWithTag({organizationId:a,tag:n,accounts:r});return c?{organizationId:a,needsCreation:!1,isSeedless:i,wallet:c}:{organizationId:a,needsCreation:!0,isSeedless:i,wallet:void 0}}s(Ol,"getKMSWalletStatus");g();b();g();b();async function Pl(e,t=Ze){let n=await ht(),{result:{organizationId:r}}=await e.getOrCreatePhantomOrganization(),{result:o}=await e.getWalletWithTag({organizationId:r,tag:t,accounts:n});if(o)return{organizationId:r,...o,isNewlyCreated:!1,isSeedless:!1};let{result:{walletId:i,walletName:a,accounts:c}}=await e.getOrCreateWalletWithTag({organizationId:r,walletName:"Phantom Wallet",tag:t,mnemonicLength:24,accounts:n});return{organizationId:r,walletId:i,walletName:a,accounts:c,isNewlyCreated:!0,isSeedless:!1}}s(Pl,"getOrCreateDerivedWalletFromSeedphrase");async function Ul(e,t){return(await t.fetchAllSeedlessMetas()).length>0?ri(e,t,Ze):Pl(e,Ze)}s(Ul,"retrieveKMSWallet");g();b();function Rl(e){try{let t=new URL(e),n=t.protocol,r=t.hostname.toLowerCase(),o=t.port;return{origin:n==="https:"&&(o===""||o==="443")?`https://${r}`:n==="http:"&&(o===""||o==="80")?`http://${r}`:`${n}//${r}${o?`:${o}`:""}`,host:r,protocol:n}}catch{return{host:e.toLowerCase()}}}s(Rl,"normalizeOrigin");function Dl(e,t){let n;try{n=new URL(e)}catch{return!1}let r=Rl(e);return t.some(o=>{let i=Rl(o);return i.origin?i.origin===r.origin:i.host?i.host===n.hostname.toLowerCase():!1})}s(Dl,"isOriginWhitelisted");async function Nl(e){try{let t=await gn.api().get(`/v1/wallets/whitelist/${e}`);return bn(t)?await t.data:null}catch{return null}}s(Nl,"fetchWhitelist");async function hy(e,t){let n=await Nl(e);return n?n.status==="DISABLED"?{allowed:!1,reason:"whitelist_disabled"}:Dl(t,n.domains??[])?{allowed:!0}:{allowed:!1,reason:"origin_not_whitelisted"}:{allowed:!1,reason:"missing_or_inaccessible_whitelist"}}s(hy,"validateAppOrigin");var ii=st(mn());var si="unknown",oi={appId:si,title:"Unknown",imageUrl:"",origin:"",expiresAtMs:-1,createdAtMs:-1},Ml={staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,retryOnMount:!1},py="@phantom/kms",yy={getPhantomOrganization:s(e=>[`${py}:getPhantomOrganization`,fi(),e],"getPhantomOrganization")};function go(e){return{queryKey:yy.getPhantomOrganization(e.accountIdentifier),queryFn:s(async()=>await e.kms.getPhantomOrganization({}),"queryFn"),...Ml}}s(go,"getPhantomOrganizationQueryOptions");function my(e){let n=Qn().getKMSInstance(),r=go({accountIdentifier:e,kms:n}),{data:o,error:i,isPending:a}=oe(r),c=o?.result??null,u=(0,ii.useMemo)(()=>c?wy(c):[],[c]),l=ee.appPermissions(e,...u);return oe({queryKey:l,queryFn:s(async()=>{if(i)throw i;if(!c)throw new Error("Phantom organization not found");return await gy(c,u)},"queryFn"),...Ml,enabled:!a})}s(my,"useGetAppPermissions");async function gy(e,t){if(t.length===0)return[];let n=t.filter(a=>a!==si);if(n.length===0)return t.map(()=>oi);let r=`/portal/v1/apps/metadata?ids=${n.join(",")}`,o=await gn.api().get(r);if(!bn(o))throw new Error("Failed to fetch metadata for apps");let i=o.data.map(a=>{let c=e.users.filter(f=>f.traits?.appId===a.id),u=Math.min(...c.map(f=>f.createdAtMs??0)),l=Math.max(...c.map(f=>f.expiresAtMs??0));return{appId:a.id,title:a.name,imageUrl:a.iconUrl??"",origin:a.url??a.name,expiresAtMs:l,createdAtMs:u}});return t.map(a=>a===si?oi:i.find(c=>c.appId===a)??oi)}s(gy,"_getAppPermissions");function by(e){let t=tt(),n=le(),o=Qn().getKMSInstance(),i=go({accountIdentifier:e,kms:o}),{data:a}=oe(i);return ae({mutationFn:s(async c=>{let u=a?.result??null;if(!u)throw new Error("Phantom organization not found");let l=u.users.filter(p=>p.traits?.appId===c);if(l.length===0)return;let f=u.organizationId;for(let p of l){let d=p.username;await o.deleteUserFromOrganization({organizationId:f,username:d}),t.capture("userDeletedFromOrganization",{data:{appId:c,organizationId:f,username:d}})}},"mutationFn"),onSettled:s(()=>n.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(by,"useRevokeAppPermissions");function wy(e){return e.users.map(t=>t.traits?.appId).filter(t=>t!==void 0).filter((t,n,r)=>r.indexOf(t)===n).sort()}s(wy,"_getUniqueAppIds");function xy(e,t){let r=Qn().getKMSInstance(),o=go({accountIdentifier:e,kms:r}),{data:i,...a}=oe(o);return{data:(0,ii.useMemo)(()=>{let u=i?.result?.users?.filter(l=>l.traits?.appId===t)??[];return Hl(u)},[i?.result,t]),...a}}s(xy,"useGetSpendingLimit");function Ey(e){let t=tt(),n=le(),o=Qn().getKMSInstance(),i=go({accountIdentifier:e,kms:o}),a=bi("spending_limits_cumulative"),{data:c}=oe({...i,enabled:a});return ae({mutationFn:s(async({appId:u,newUsdCentsLimitPerDay:l})=>{let f=c?.result??null;if(!f)throw new Error("Phantom organization not found");let p=await o.getWalletWithTag({organizationId:f.organizationId,tag:Ze});if(!p.result)throw new Error("KMS wallet not found");let d=await Cn({kms:o,userOrganizationId:f.organizationId,appId:u,usdCentsLimitPerDay:l,walletId:p.result.walletId});await Bn({kms:o,organization:f,newPolicy:d,appId:u,analytics:t})},"mutationFn"),onSettled:s(()=>n.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(Ey,"useUpdateSpendingLimit");function Hl(e){let t=e.map(r=>"policy"in r?r.policy:void 0).filter(Boolean);if(t.length===0)return null;let n=t.map(r=>{let o=Er.safeParse(r);return o.success?o.data.usdLimit?.usdCentsLimitPerDay??null:null}).filter(r=>r!==null);return n.length===0?null:Math.min(...n)}s(Hl,"getLowestSpendingLimit");g();b();var pn=st(mn());var vy=s(({isTestnetMode:e,enabledAddressTypes:t,enableAddressTypes:n,disableAddressTypes:r})=>{let{t:o}=vi(),i=(0,pn.useMemo)(()=>He.getAddressTypes(e?Ao.Testnet:Ao.Mainnet).sort(ql),[e]),a=(0,pn.useMemo)(()=>i.filter(p=>t.includes(p)).sort(ql),[i,t]),c=(0,pn.useCallback)(p=>{let d=He.getChainIDs(p);for(let y of d)if(He[y].addressTypes.filter(m=>t.includes(m)).length<=1)return!1;return!0},[t]),u=tt(),l=(0,pn.useCallback)((p,d)=>{d?c(p)&&(r({addressTypes:[p]}),u.capture("settingsPreferredBitcoinAddressToggledOffByUser",{data:{toggle:{addressType:p}}})):(n({addressTypes:[p]}),u.capture("settingsPreferredBitcoinAddressToggledOnByUser",{data:{toggle:{addressType:p}}}))},[u,c,r,n]),f=(0,pn.useMemo)(()=>({[Tt.BitcoinNativeSegwit]:{title:Co.getDisplayName(Tt.BitcoinNativeSegwit),subtitle:o("settingsPreferredBitcoinAddressNativeSegwitExplainer")},[Tt.BitcoinTaproot]:{title:Co.getDisplayName(Tt.BitcoinTaproot),subtitle:o("settingsPreferredBitcoinAddressTaprootExplainer")}}),[o]);return{availableBitcoinAddressTypes:i,enabledBitcoinAddressTypes:a,canDisableAddressType:c,handleAddressTypeEnablementChange:l,PREFERRED_BTC_ADDRESS_CONTENT:f}},"usePreferredAddressTypes"),Kl=[Tt.BitcoinNativeSegwit,Tt.BitcoinTaproot,Tt.BitcoinNestedSegwit,Tt.BitcoinLegacy],ql=s((e,t)=>Kl.indexOf(e)-Kl.indexOf(t),"addressTypeSorter");g();b();var _y=Lt.USD.value,ai=s(()=>{let{value:e}=mi(Se.SelectedCurrency);return{data:e??_y}},"useSelectedCurrency"),ci=s(()=>gi(Se.SelectedCurrency),"useSetSelectedCurrency");g();b();var bo=st(mn());var kl=[Lt.USD,Lt.EUR],Sy=s(({beforeSelectCurrency:e=s(()=>Promise.resolve(),"beforeSelectCurrency"),goBack:t})=>{let n=tt(),{data:r}=ai(),{run:o}=ci(),[i,a]=(0,bo.useState)(""),c=Ai(i,200);return{currencyRows:(0,bo.useMemo)(()=>Object.values(Lt).sort((l,f)=>{let p=kl.indexOf(l),d=kl.indexOf(f),y=p!==-1,h=d!==-1;return y&&h?p-d:y&&!h?-1:!y&&h?1:l.name.localeCompare(f.name)}).filter(l=>[l.name,l.symbol,l.abbreviation].some(p=>p.toLowerCase().includes(c.toLowerCase()))).map(l=>{let f=r===l.value,p=s(()=>{l.value!==r&&e(l).then(()=>{n.capture("settingsCurrencyUpdatedByUser",{data:{newCurrency:l.value,oldCurrency:r}}),o(l.value),t()})},"onPress");return{key:`currency-${l.value}`,topLeft:`${l.abbreviation} - ${l.name} (${l.symbol})`,type:"radio",active:f,onPress:p}}),[n,c,t,r,o,e]),searchQuery:i,setSearchQuery:a}},"useCurrencyList");g();b();var Vl="enableSolanaCopyTransaction";function Ay(){let e=le(),t=pe(),n=["settings","solana","enableCopyTransaction"],r=s(async()=>!!await t.get(Vl),"queryFn"),i=ae({mutationFn:s(async c=>{await t.set(Vl,c)},"mutationFn"),onSuccess:s(()=>{e.invalidateQueries({queryKey:n})},"onSuccess")}),a=oe({queryKey:n,queryFn:r});return{data:a.data,isLoading:a.isPending,mutate:i.mutate}}s(Ay,"useEnableSolanaCopyTransaction");var By=Ay;export{vn as a,zi as b,vr as c,Gi as d,Wi as e,Ft as f,dg as g,Zi as h,$l as i,hg as j,pg as k,Xi as l,Ji as m,Se as n,Ar as o,Zl as p,Yl as q,Ql as r,ef as s,l1 as t,rf as u,jo as v,ee as w,Gt as x,ko as y,Wt as z,Gf as A,Vo as B,Oa as C,Go as D,Pa as E,id as F,ad as G,Ub as H,Oo as I,oa as J,of as K,sf as L,sa as M,af as N,cf as O,uf as P,Wf as Q,$f as R,Ta as S,Fo as T,Zf as U,Qf as V,Xf as W,Jf as X,ed as Y,df as Z,hf as _,pf as $,Sn as aa,yf as ba,td as ca,nd as da,ia as ea,mf as fa,gf as ga,Ra as ha,ld as ia,fd as ja,bf as ka,hd as la,Rf as ma,Ho as na,Ko as oa,Ot as pa,Sa as qa,Aa as ra,No as sa,_a as ta,Hf as ua,qo as va,jf as wa,zf as xa,Ka as ya,Ol as za,Ul as Aa,hy as Ba,my as Ca,by as Da,xy as Ea,Ey as Fa,vy as Ga,ai as Ha,Sy as Ia,By as Ja};
/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-UA65TROS.js.map
